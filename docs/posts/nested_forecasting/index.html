<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Stephen J Parton">

<title>Notes to Myself - Flight Forecast with ML Nested models</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

<script src="../../site_libs/core-js-2.5.3/shim.min.js"></script>
<script src="../../site_libs/react-17.0.0/react.min.js"></script>
<script src="../../site_libs/react-17.0.0/react-dom.min.js"></script>
<script src="../../site_libs/reactwidget-1.0.0/react-tools.js"></script>
<script src="../../site_libs/htmlwidgets-1.6.0/htmlwidgets.js"></script>
<link href="../../site_libs/reactable-0.4.1/reactable.css" rel="stylesheet">
<script src="../../site_libs/reactable-binding-0.4.1/reactable.js"></script>
<script src="../../site_libs/plotly-binding-4.10.1/plotly.js"></script>
<script src="../../site_libs/typedarray-0.1/typedarray.min.js"></script>
<script src="../../site_libs/jquery-3.5.1/jquery.min.js"></script>
<link href="../../site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="../../site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="../../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="../../site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


<meta property="og:title" content="Notes to Myself - Flight Forecast with ML Nested models">
<meta property="og:description" content="This file runs a nested forecasting approach on top Australian domestic routes (70 or so) prior to covid. This is just an exploratory exercise and remains a work in progress.">
<meta property="og:image" content="thumbnail.png">
<meta property="og:site-name" content="Notes to Myself">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Notes to Myself</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="dropdown-header">
 <span class="menu-text">by Stephen Parton</span></li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/spinbris"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/spinb"><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/stephen-parton-2737594/"><i class="bi bi-linkedin" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div class="quarto-toggle-container">
                  <a href="" class="quarto-color-scheme-toggle nav-link" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
              </div>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title">Flight Forecast with ML Nested models</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
                                <div class="quarto-categories">
                <div class="quarto-category">code</div>
                <div class="quarto-category">analytics</div>
                <div class="quarto-category">flights</div>
                <div class="quarto-category">forecasting</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Stephen J Parton </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">12-12-2022</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="toc-section-number">1</span>  Introduction</a></li>
  <li><a href="#load-packages" id="toc-load-packages" class="nav-link" data-scroll-target="#load-packages"><span class="toc-section-number">2</span>  Load Packages</a></li>
  <li><a href="#load-data" id="toc-load-data" class="nav-link" data-scroll-target="#load-data"><span class="toc-section-number">3</span>  Load Data</a></li>
  <li><a href="#wrangling" id="toc-wrangling" class="nav-link" data-scroll-target="#wrangling"><span class="toc-section-number">4</span>  Wrangling</a></li>
  <li><a href="#recipes" id="toc-recipes" class="nav-link" data-scroll-target="#recipes"><span class="toc-section-number">5</span>  Recipes</a>
  <ul class="collapse">
  <li><a href="#recipe---base" id="toc-recipe---base" class="nav-link" data-scroll-target="#recipe---base"><span class="toc-section-number">5.1</span>  Recipe - Base</a></li>
  <li><a href="#auto-arima" id="toc-auto-arima" class="nav-link" data-scroll-target="#auto-arima"><span class="toc-section-number">5.2</span>  Auto ARIMA</a></li>
  </ul></li>
  <li><a href="#models-and-workflows" id="toc-models-and-workflows" class="nav-link" data-scroll-target="#models-and-workflows"><span class="toc-section-number">6</span>  Models and Workflows</a>
  <ul class="collapse">
  <li><a href="#auto-arima-1" id="toc-auto-arima-1" class="nav-link" data-scroll-target="#auto-arima-1"><span class="toc-section-number">6.1</span>  Auto ARIMA</a></li>
  <li><a href="#xgboost" id="toc-xgboost" class="nav-link" data-scroll-target="#xgboost"><span class="toc-section-number">6.2</span>  XGBoost</a></li>
  <li><a href="#prophet-boost" id="toc-prophet-boost" class="nav-link" data-scroll-target="#prophet-boost"><span class="toc-section-number">6.3</span>  Prophet Boost</a></li>
  <li><a href="#svm" id="toc-svm" class="nav-link" data-scroll-target="#svm"><span class="toc-section-number">6.4</span>  SVM</a></li>
  <li><a href="#random-forest" id="toc-random-forest" class="nav-link" data-scroll-target="#random-forest"><span class="toc-section-number">6.5</span>  Random Forest</a></li>
  <li><a href="#neural-net" id="toc-neural-net" class="nav-link" data-scroll-target="#neural-net"><span class="toc-section-number">6.6</span>  Neural Net</a></li>
  <li><a href="#thief---temporal-hierarchical-forecasting" id="toc-thief---temporal-hierarchical-forecasting" class="nav-link" data-scroll-target="#thief---temporal-hierarchical-forecasting"><span class="toc-section-number">6.7</span>  THIEF - Temporal Hierarchical Forecasting</a></li>
  </ul></li>
  <li><a href="#nested-analysis" id="toc-nested-analysis" class="nav-link" data-scroll-target="#nested-analysis"><span class="toc-section-number">7</span>  Nested Analysis</a>
  <ul class="collapse">
  <li><a href="#combine-workflows-in-modeltime-table" id="toc-combine-workflows-in-modeltime-table" class="nav-link" data-scroll-target="#combine-workflows-in-modeltime-table"><span class="toc-section-number">7.1</span>  Combine Workflows in Modeltime Table</a></li>
  <li><a href="#check-errors" id="toc-check-errors" class="nav-link" data-scroll-target="#check-errors"><span class="toc-section-number">7.2</span>  Check Errors</a></li>
  <li><a href="#review-model-accuracy" id="toc-review-model-accuracy" class="nav-link" data-scroll-target="#review-model-accuracy"><span class="toc-section-number">7.3</span>  Review Model Accuracy</a></li>
  <li><a href="#graph---models-test-data" id="toc-graph---models-test-data" class="nav-link" data-scroll-target="#graph---models-test-data"><span class="toc-section-number">7.4</span>  Graph - Models Test Data</a></li>
  <li><a href="#select-best-models-by-route" id="toc-select-best-models-by-route" class="nav-link" data-scroll-target="#select-best-models-by-route"><span class="toc-section-number">7.5</span>  Select Best Models by Route</a></li>
  <li><a href="#graph---forecast-v-training-data-aggregated" id="toc-graph---forecast-v-training-data-aggregated" class="nav-link" data-scroll-target="#graph---forecast-v-training-data-aggregated"><span class="toc-section-number">7.6</span>  Graph - Forecast v Training Data Aggregated</a></li>
  <li><a href="#training-forecast-accuracy-by-best-model---top-10-routes" id="toc-training-forecast-accuracy-by-best-model---top-10-routes" class="nav-link" data-scroll-target="#training-forecast-accuracy-by-best-model---top-10-routes"><span class="toc-section-number">7.7</span>  Training Forecast Accuracy by Best Model - top 10 routes</a></li>
  <li><a href="#refit-nested-model" id="toc-refit-nested-model" class="nav-link" data-scroll-target="#refit-nested-model"><span class="toc-section-number">7.8</span>  Refit Nested Model</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<p><img src="thumbnail.png" class="img-fluid"></p>
<section id="introduction" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">1</span> Introduction</h2>
<p>This file runs a nested forecasting approach on top Australian domestic routes (70 or so) prior to covid. This is just an exploratory exercise and remains a work in progress.</p>
<p>This analysis uses ML Models as follows</p>
<ul>
<li><p>Auto ARIMA</p></li>
<li><p>XGBoost</p></li>
<li><p>Prophet Boost</p></li>
<li><p>Random Forest</p></li>
<li><p>SVM</p></li>
<li><p>Neural Net</p></li>
<li><p>MARS</p></li>
<li><p>THIEF</p></li>
</ul>
<p>Only XGBoost/ Prophet Boost have been tuned (based on Syd-Melb route only and using the same hyper-parameters as appropriate).</p>
<p>The forecast period is 12 months from end of testing, which is July 2019, so missing the Covid dive, which is still shown.</p>
<p>This will all look better in a Shiny app, coming soon…</p>
</section>
<section id="load-packages" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="load-packages"><span class="header-section-number">2</span> Load Packages</h2>
<p>Tidyverse, Tidymodels, Modeltime, parallel processing etc.</p>
<div class="cell" data-warninng="false" data-hash="index_cache/html/packages_fbd80d6a6230bd5b2feffa23485a34ad">

</div>
</section>
<section id="load-data" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="load-data"><span class="header-section-number">3</span> Load Data</h2>
<p>Data has largely been pre-processed, and is loaded from rds files.</p>
<div class="cell" data-hash="index_cache/html/data_4a05d995dfd23794af6be3a3dff3ce40">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#here()</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>top_routes_prep_df <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="fu">here</span>(<span class="st">"./posts/aust_domestic_flights/artifacts/top_routes_prep_df.rds"</span>))</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>start          <span class="ot">&lt;-</span> <span class="st">"2001-01-01"</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>end            <span class="ot">&lt;-</span> <span class="st">"2019-07-01"</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>horizon_nested <span class="ot">&lt;-</span> <span class="dv">12</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>end_precovid <span class="ot">&lt;-</span> <span class="fu">dmy</span>(<span class="st">"01-02-2020"</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co">#d2 &lt;- dmy("01-07-2022")</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>max_act   <span class="ot">&lt;-</span> <span class="fu">max</span>(top_routes_prep_df<span class="sc">$</span>date)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>max_test  <span class="ot">&lt;-</span> <span class="fu">ymd</span>(end)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>max_pred  <span class="ot">&lt;-</span> max_test <span class="sc">%m+%</span> <span class="fu">months</span>(horizon_nested)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>filter_r       <span class="ot">&lt;-</span> <span class="st">"N"</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>city           <span class="ot">&lt;-</span> <span class="st">"BRISBANE"</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>top_x          <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co"># * Parallel Processing ----</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="fu">registerDoFuture</span>()</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>n_cores <span class="ot">&lt;-</span> parallel<span class="sc">::</span><span class="fu">detectCores</span>()</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="fu">plan</span>(</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">strategy =</span> cluster,</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">workers  =</span> parallel<span class="sc">::</span><span class="fu">makeCluster</span>(n_cores)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="wrangling" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="wrangling"><span class="header-section-number">4</span> Wrangling</h2>
<p>Some initial wrangling</p>
<div class="cell" data-hash="index_cache/html/wrangling_aba6d2e44a5b154d305288ec80ee5690">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>route_prep <span class="ot">&lt;-</span> top_routes_prep_df <span class="sc">%&gt;%</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(route,date,passenger_trips) <span class="sc">%&gt;%</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(route) <span class="sc">%&gt;%</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_by_time</span>(date, <span class="at">.by =</span> <span class="st">"month"</span>, <span class="at">passenger_trips =</span> <span class="fu">sum</span>(passenger_trips)) <span class="sc">%&gt;%</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pad_by_time</span>(date, <span class="at">.by       =</span> <span class="st">"month"</span>,<span class="at">.pad_value =</span> <span class="dv">0</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>topx <span class="ot">&lt;-</span> top_routes_prep_df <span class="sc">%&gt;%</span> </span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(route) <span class="sc">%&gt;%</span> </span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">passenger_trips =</span> <span class="fu">sum</span>(passenger_trips)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(passenger_trips, <span class="at">n=</span>top_x) <span class="sc">%&gt;%</span> </span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(passenger_trips)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(route) <span class="sc">%&gt;%</span> </span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.character</span>()</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>route_prep_raw <span class="ot">&lt;-</span> route_prep <span class="sc">%&gt;%</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(route <span class="sc">%in%</span> topx ) <span class="sc">%&gt;%</span> </span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter_by_time</span>(<span class="at">.date_var    =</span> date,<span class="at">.start_date =</span> start, <span class="at">.end_date =</span> end ) <span class="sc">%&gt;%</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">passenger_trips      =</span> <span class="fu">log1p</span>(passenger_trips)) <span class="sc">%&gt;%</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(route)</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>route_prep_validation <span class="ot">&lt;-</span> route_prep <span class="sc">%&gt;%</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(route <span class="sc">%in%</span> topx ) <span class="sc">%&gt;%</span> </span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(date <span class="sc">&gt;</span> max_test ) <span class="sc">%&gt;%</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">passenger_trips      =</span> <span class="fu">log1p</span>(passenger_trips)) <span class="sc">%&gt;%</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(route)</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a><span class="co"># * Nested Time Series ----</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>route_prep_nested <span class="ot">&lt;-</span> route_prep_raw <span class="sc">%&gt;%</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extend_timeseries</span>(</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">.id_var        =</span> route,</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">.date_var      =</span> date,</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">.length_future =</span> horizon_nested</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tk_augment_fourier</span>(date,<span class="at">.periods =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">6</span>,<span class="dv">12</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tk_augment_lags</span>(passenger_trips, <span class="at">.lags =</span> <span class="dv">12</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tk_augment_slidify</span>(</span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>    passenger_trips_lag12,</span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>     <span class="at">.f       =</span> <span class="sc">~</span><span class="fu">mean</span>(.x,<span class="at">na.rm =</span> T),</span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>     <span class="at">.period  =</span> <span class="fu">c</span>(.<span class="dv">25</span> <span class="sc">*</span> <span class="dv">12</span>,.<span class="dv">5</span> <span class="sc">*</span> <span class="dv">12</span>, <span class="dv">12</span>),</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>     <span class="at">.partial =</span> T,</span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>     <span class="at">.align   =</span> <span class="st">"center"</span></span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest_timeseries</span>(</span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">.id_var        =</span> route,</span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">.length_future =</span> horizon_nested</span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split_nested_timeseries</span>(</span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">.length_test   =</span> horizon_nested</span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>  <span class="co">#rowid_to_column(var = "rowid")</span></span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a>route_prep_nested_train <span class="ot">&lt;-</span> <span class="fu">extract_nested_train_split</span>(route_prep_nested)</span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a>route_prep_nested_test  <span class="ot">&lt;-</span> <span class="fu">extract_nested_test_split</span>(route_prep_nested)</span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a>max_train <span class="ot">&lt;-</span> <span class="fu">max</span>(route_prep_nested_train<span class="sc">$</span>date)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Top Routes, ordered in descending order (of passengers numbers over total review period) :</p>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-1_a33368ddfab88cd3f1d12e487db4ff4b">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>topx <span class="sc">%&gt;%</span> <span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table>
 <thead>
  <tr>
   <th style="text-align:left;"> x </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> MELBOURNE-SYDNEY </td>
  </tr>
  <tr>
   <td style="text-align:left;"> BRISBANE-SYDNEY </td>
  </tr>
  <tr>
   <td style="text-align:left;"> BRISBANE-MELBOURNE </td>
  </tr>
  <tr>
   <td style="text-align:left;"> GOLD COAST-SYDNEY </td>
  </tr>
  <tr>
   <td style="text-align:left;"> ADELAIDE-MELBOURNE </td>
  </tr>
  <tr>
   <td style="text-align:left;"> ADELAIDE-SYDNEY </td>
  </tr>
  <tr>
   <td style="text-align:left;"> MELBOURNE-PERTH </td>
  </tr>
  <tr>
   <td style="text-align:left;"> PERTH-SYDNEY </td>
  </tr>
  <tr>
   <td style="text-align:left;"> MELBOURNE-GOLD COAST </td>
  </tr>
  <tr>
   <td style="text-align:left;"> BRISBANE-CAIRNS </td>
  </tr>
</tbody>
</table>

</div>
</div>
</section>
<section id="recipes" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="recipes"><span class="header-section-number">5</span> Recipes</h2>
<p>3 Recipes have been established:</p>
<ul>
<li><p>Base Recipe</p></li>
<li><p>Auto Arima Recipe</p></li>
<li><p>Tunable XG Boost Recipe - which is not run here as hyperparameter tuning results were hard-coded into recipe to save processing time here.</p></li>
</ul>
<section id="recipe---base" class="level3" data-number="5.1">
<h3 data-number="5.1" class="anchored" data-anchor-id="recipe---base"><span class="header-section-number">5.1</span> Recipe - Base</h3>
<p>Used in all</p>
<div class="cell" data-hash="index_cache/html/recipe_base_5a4c36dbac56853913d29b55fe23012e">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># * Base Recipe ----</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>recipe_spec <span class="ot">&lt;-</span> <span class="fu">recipe</span>(</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  passenger_trips <span class="sc">~</span> .,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  route_prep_nested_train) <span class="sc">%&gt;%</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_timeseries_signature</span>(date) <span class="sc">%&gt;%</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_rm</span>(<span class="fu">matches</span>(<span class="st">"(.xts$)|(.iso$)|(hour)|(minute)|(second)|(am.pm)|(day)|(week)"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#step_rm(date) %&gt;%</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_normalize</span>(date_index.num,date_year) <span class="sc">%&gt;%</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">#step_log(passenger_trips,offset = 1) %&gt;%</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#step_rm(date) %&gt;%</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_zv</span>(<span class="fu">all_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_impute_knn</span>(<span class="fu">all_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="co">#step_other(route) %&gt;%</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_dummy</span>(<span class="fu">all_nominal_predictors</span>(), <span class="at">one_hot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="co">#recipe_spec %&gt;% prep() %&gt;% summary() %&gt;% kable()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="auto-arima" class="level3" data-number="5.2">
<h3 data-number="5.2" class="anchored" data-anchor-id="auto-arima"><span class="header-section-number">5.2</span> Auto ARIMA</h3>
<div class="cell" data-hash="index_cache/html/recipe_auto_arima_9f01a1cf05f4ddbf45d14d2d995318fe">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># * Auto Arima Recipe ----</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>recipe_spec_auto_arima <span class="ot">&lt;-</span> <span class="fu">recipe</span>(</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  passenger_trips <span class="sc">~</span> date, <span class="at">data =</span> route_prep_nested_train)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>recipe_spec_auto_arima <span class="sc">%&gt;%</span> <span class="fu">prep</span>() <span class="sc">%&gt;%</span> <span class="fu">summary</span>() <span class="sc">%&gt;%</span> <span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table>
 <thead>
  <tr>
   <th style="text-align:left;"> variable </th>
   <th style="text-align:left;"> type </th>
   <th style="text-align:left;"> role </th>
   <th style="text-align:left;"> source </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> date </td>
   <td style="text-align:left;"> date </td>
   <td style="text-align:left;"> predictor </td>
   <td style="text-align:left;"> original </td>
  </tr>
  <tr>
   <td style="text-align:left;"> passenger_trips </td>
   <td style="text-align:left;"> double , numeric </td>
   <td style="text-align:left;"> outcome </td>
   <td style="text-align:left;"> original </td>
  </tr>
</tbody>
</table>

</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># + fourier_vec(date,period = 3)</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># + fourier_vec(date,period = 6)</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># + fourier_vec(date,period = 12)</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># + month(date,label = T) ,</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># data = route_prep_nested_train)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="models-and-workflows" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="models-and-workflows"><span class="header-section-number">6</span> Models and Workflows</h2>
<section id="auto-arima-1" class="level3" data-number="6.1">
<h3 data-number="6.1" class="anchored" data-anchor-id="auto-arima-1"><span class="header-section-number">6.1</span> Auto ARIMA</h3>
<section id="model" class="level4">
<h4 class="anchored" data-anchor-id="model">Model</h4>
<div class="cell" data-hash="index_cache/html/model_auto_arima_55d19b5da0c612226645c4f8b4eb2173">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ** Model----</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>model_spec_auto_arima <span class="ot">&lt;-</span> <span class="fu">arima_reg</span>() <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"auto_arima"</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>model_spec_auto_arima</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>ARIMA Regression Model Specification (regression)

Computational engine: auto_arima </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>recipe_spec_auto_arima <span class="sc">%&gt;%</span> <span class="fu">prep</span>() <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  variable        type      role      source  
  &lt;chr&gt;           &lt;list&gt;    &lt;chr&gt;     &lt;chr&gt;   
1 date            &lt;chr [1]&gt; predictor original
2 passenger_trips &lt;chr [2]&gt; outcome   original</code></pre>
</div>
</div>
</section>
<section id="workflow" class="level4">
<h4 class="anchored" data-anchor-id="workflow">Workflow</h4>
<div class="cell" data-hash="index_cache/html/wflw_auto_arima_bd3663028db7963a28f5570c6c05ea4e">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ** Workflow ----</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>wflw_fit_auto_arima <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(model_spec_auto_arima) <span class="sc">%&gt;%</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(recipe_spec_auto_arima)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>wflw_fit_auto_arima</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>══ Workflow ════════════════════════════════════════════════════════════════════
Preprocessor: Recipe
Model: arima_reg()

── Preprocessor ────────────────────────────────────────────────────────────────
0 Recipe Steps

── Model ───────────────────────────────────────────────────────────────────────
ARIMA Regression Model Specification (regression)

Computational engine: auto_arima </code></pre>
</div>
</div>
</section>
</section>
<section id="xgboost" class="level3" data-number="6.2">
<h3 data-number="6.2" class="anchored" data-anchor-id="xgboost"><span class="header-section-number">6.2</span> XGBoost</h3>
<p>Parameters for this model were selected from a hyper-parameter tuning grid search, not shown here for brevity reasons. This, and related Prophet Boost models (using same parameters) are only models yet tuned.</p>
<section id="model-1" class="level4">
<h4 class="anchored" data-anchor-id="model-1">Model</h4>
<div class="cell" data-hash="index_cache/html/model_xgboost_66b7a7e0f449ec49c14609faf4b48a9f">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ** Model/Recipe ----</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>model_spec_xgboost <span class="ot">&lt;-</span> <span class="fu">boost_tree</span>(</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">mode           =</span> <span class="st">"regression"</span>,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#copied from tuned xgboost:</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">mtry               =</span> <span class="dv">20</span>, </span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">min_n              =</span> <span class="dv">3</span>,</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">tree_depth         =</span> <span class="dv">4</span>,</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">learn_rate         =</span> <span class="fl">0.075</span>,</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">loss_reduction     =</span> <span class="fl">0.000001</span>,</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">trees              =</span> <span class="dv">300</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"xgboost"</span>)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>model_spec_xgboost </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Boosted Tree Model Specification (regression)

Main Arguments:
  mtry = 20
  trees = 300
  min_n = 3
  tree_depth = 4
  learn_rate = 0.075
  loss_reduction = 1e-06

Computational engine: xgboost </code></pre>
</div>
</div>
</section>
<section id="workflow-1" class="level4">
<h4 class="anchored" data-anchor-id="workflow-1">Workflow</h4>
<div class="cell" data-hash="index_cache/html/wflw_xgboost_110a1c3ba65def45c2b9870b2c273854">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ** workflow  ----</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>wflw_fit_xgboost <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(model_spec_xgboost) <span class="sc">%&gt;%</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(recipe_spec <span class="sc">%&gt;%</span> <span class="fu">update_role</span>(date,<span class="at">new_role=</span><span class="st">"indicator"</span>))</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>wflw_fit_xgboost</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>══ Workflow ════════════════════════════════════════════════════════════════════
Preprocessor: Recipe
Model: boost_tree()

── Preprocessor ────────────────────────────────────────────────────────────────
6 Recipe Steps

• step_timeseries_signature()
• step_rm()
• step_normalize()
• step_zv()
• step_impute_knn()
• step_dummy()

── Model ───────────────────────────────────────────────────────────────────────
Boosted Tree Model Specification (regression)

Main Arguments:
  mtry = 20
  trees = 300
  min_n = 3
  tree_depth = 4
  learn_rate = 0.075
  loss_reduction = 1e-06

Computational engine: xgboost </code></pre>
</div>
</div>
</section>
</section>
<section id="prophet-boost" class="level3" data-number="6.3">
<h3 data-number="6.3" class="anchored" data-anchor-id="prophet-boost"><span class="header-section-number">6.3</span> Prophet Boost</h3>
<section id="model-2" class="level4">
<h4 class="anchored" data-anchor-id="model-2">Model</h4>
<p>As mentioned, hyper parameters have been hard coded from the results a grid-search, which is not repeated in this doc, just to save time. The code is included, although all commented out:</p>
<div class="cell" data-hash="index_cache/html/tuning_not used_e5284343188fbade576615a80b940d97">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># * XGBoost-tuned (maybe) ----</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ** Model/Recipe</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co">#     model_spec_xgboost_tune &lt;- boost_tree(</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co">#       mode           = "regression",</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co">#       mtry           = tune(),</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co">#       trees          = 300,</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="co">#       min_n          = tune(),</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="co">#       tree_depth     = tune(),</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="co">#       learn_rate     = tune(),</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="co">#       loss_reduction = tune()</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="co">#       ) %&gt;%</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="co">#       set_engine("xgboost")</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="co"># # ** ML Recipe - date as indicator ----</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="co"># recipe_spec %&gt;% prep() %&gt;% summary()</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a><span class="co"># recipe_spec_ml &lt;- recipe_spec %&gt;%</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a><span class="co">#   update_role(date,new_role = "indicator")</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a><span class="co"># recipe_spec_ml %&gt;% prep() %&gt;% summary()</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a><span class="co"># # ** workflow for tuning ----</span></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a><span class="co"># wflw_xgboost_tune &lt;- workflow() %&gt;%</span></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a><span class="co">#   add_model(model_spec_xgboost_tune) %&gt;%</span></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a><span class="co">#   add_recipe(recipe_spec_ml)</span></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>  <span class="co">#fit(route_prep_nested_train)</span></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a><span class="co"># ** resamples - K-Fold -----</span></span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a><span class="co"># set.seed(123)</span></span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a><span class="co"># resamples_kfold &lt;- route_prep_nested_train %&gt;%</span></span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a><span class="co">#   vfold_cv()</span></span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a><span class="co"># # unnests and graphs</span></span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a><span class="co"># resamples_data &lt;- resamples_kfold %&gt;%</span></span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a><span class="co">#   tk_time_series_cv_plan()</span></span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a><span class="co"># resamples_data%&gt;%</span></span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(.id) %&gt;%</span></span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a><span class="co">#   plot_time_series_cv_plan(</span></span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a><span class="co">#     date,</span></span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a><span class="co">#     passenger_trips,</span></span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a><span class="co">#     .facet_ncol  = 2,</span></span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a><span class="co">#     .facet_nrow  = 2)</span></span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a><span class="co"># wflw_spec_xgboost_tune &lt;- workflow() %&gt;%</span></span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a><span class="co">#   add_model(model_spec_xgboost_tune) %&gt;%</span></span>
<span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a><span class="co">#   add_recipe(recipe_spec_ml)</span></span>
<span id="cb17-52"><a href="#cb17-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-53"><a href="#cb17-53" aria-hidden="true" tabindex="-1"></a><span class="co"># route_prep_nested_train %&gt;%</span></span>
<span id="cb17-54"><a href="#cb17-54" aria-hidden="true" tabindex="-1"></a><span class="co">#   plot_time_series(.date_var = date,.value = passenger_trips)</span></span>
<span id="cb17-55"><a href="#cb17-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-56"><a href="#cb17-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-57"><a href="#cb17-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-58"><a href="#cb17-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-59"><a href="#cb17-59" aria-hidden="true" tabindex="-1"></a><span class="co"># ** tune XGBoost----</span></span>
<span id="cb17-60"><a href="#cb17-60" aria-hidden="true" tabindex="-1"></a><span class="co"># tic()</span></span>
<span id="cb17-61"><a href="#cb17-61" aria-hidden="true" tabindex="-1"></a><span class="co"># set.seed(123)</span></span>
<span id="cb17-62"><a href="#cb17-62" aria-hidden="true" tabindex="-1"></a><span class="co"># tune_results_xgboost &lt;- wflw_xgboost_tune %&gt;%</span></span>
<span id="cb17-63"><a href="#cb17-63" aria-hidden="true" tabindex="-1"></a><span class="co">#   tune_grid(</span></span>
<span id="cb17-64"><a href="#cb17-64" aria-hidden="true" tabindex="-1"></a><span class="co">#     resamples  = resamples_kfold,</span></span>
<span id="cb17-65"><a href="#cb17-65" aria-hidden="true" tabindex="-1"></a><span class="co">#     param_info = hardhat::extract_parameter_set_dials(wflw_xgboost_tune) %&gt;%</span></span>
<span id="cb17-66"><a href="#cb17-66" aria-hidden="true" tabindex="-1"></a><span class="co">#       update(</span></span>
<span id="cb17-67"><a href="#cb17-67" aria-hidden="true" tabindex="-1"></a><span class="co">#         learn_rate = learn_rate(range = c(0.001,0.400), trans = NULL)</span></span>
<span id="cb17-68"><a href="#cb17-68" aria-hidden="true" tabindex="-1"></a><span class="co">#       ),</span></span>
<span id="cb17-69"><a href="#cb17-69" aria-hidden="true" tabindex="-1"></a><span class="co">#     grid = 10,</span></span>
<span id="cb17-70"><a href="#cb17-70" aria-hidden="true" tabindex="-1"></a><span class="co">#     control = control_grid(verbose = T, allow_par = T)</span></span>
<span id="cb17-71"><a href="#cb17-71" aria-hidden="true" tabindex="-1"></a><span class="co">#   )</span></span>
<span id="cb17-72"><a href="#cb17-72" aria-hidden="true" tabindex="-1"></a><span class="co"># toc()</span></span>
<span id="cb17-73"><a href="#cb17-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-74"><a href="#cb17-74" aria-hidden="true" tabindex="-1"></a><span class="co"># ** Results</span></span>
<span id="cb17-75"><a href="#cb17-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-76"><a href="#cb17-76" aria-hidden="true" tabindex="-1"></a><span class="co"># xgb_best_params &lt;- tune_results_xgboost %&gt;% show_best("rmse", n = Inf)</span></span>
<span id="cb17-77"><a href="#cb17-77" aria-hidden="true" tabindex="-1"></a><span class="co"># xgb_best_params</span></span>
<span id="cb17-78"><a href="#cb17-78" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb17-79"><a href="#cb17-79" aria-hidden="true" tabindex="-1"></a><span class="co"># wflw_fit_xgboost_tune &lt;-wflw_xgboost_tune %&gt;%</span></span>
<span id="cb17-80"><a href="#cb17-80" aria-hidden="true" tabindex="-1"></a><span class="co">#   finalize_workflow(parameters = xgb_best_params %&gt;% slice(1))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Model with hard coded hyper-parameters:</p>
<div class="cell" data-hash="index_cache/html/model_prophet_boost_69a007a63bcd0098e020a324f23c9cd8">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>model_spec_prophet_boost <span class="ot">&lt;-</span> <span class="fu">prophet_boost</span>(</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">seasonality_daily  =</span>  F,</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">seasonality_weekly =</span> F,</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">seasonality_yearly =</span> F,</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#copied from tuned xgboost:</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">mtry               =</span> <span class="dv">20</span>, </span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">min_n              =</span> <span class="dv">3</span>,</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">tree_depth         =</span> <span class="dv">4</span>,</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">learn_rate         =</span> <span class="fl">0.075</span>,</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">loss_reduction     =</span> <span class="fl">0.000001</span>,</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">trees              =</span> <span class="dv">300</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"prophet_xgboost"</span>)</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>model_spec_prophet_boost</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>PROPHET Regression Model Specification (regression)

Main Arguments:
  seasonality_yearly = F
  seasonality_weekly = F
  seasonality_daily = F
  mtry = 20
  trees = 300
  min_n = 3
  tree_depth = 4
  learn_rate = 0.075
  loss_reduction = 1e-06

Computational engine: prophet_xgboost </code></pre>
</div>
</div>
</section>
<section id="workflow-2" class="level4">
<h4 class="anchored" data-anchor-id="workflow-2">Workflow</h4>
<div class="cell" data-hash="index_cache/html/wflw_prophet_boost_c64461608884edc3dc35991544a6913b">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>wflw_fit_prophet_boost <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(model_spec_prophet_boost) <span class="sc">%&gt;%</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(recipe_spec)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>wflw_fit_prophet_boost</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>══ Workflow ════════════════════════════════════════════════════════════════════
Preprocessor: Recipe
Model: prophet_boost()

── Preprocessor ────────────────────────────────────────────────────────────────
6 Recipe Steps

• step_timeseries_signature()
• step_rm()
• step_normalize()
• step_zv()
• step_impute_knn()
• step_dummy()

── Model ───────────────────────────────────────────────────────────────────────
PROPHET Regression Model Specification (regression)

Main Arguments:
  seasonality_yearly = F
  seasonality_weekly = F
  seasonality_daily = F
  mtry = 20
  trees = 300
  min_n = 3
  tree_depth = 4
  learn_rate = 0.075
  loss_reduction = 1e-06

Computational engine: prophet_xgboost </code></pre>
</div>
</div>
</section>
</section>
<section id="svm" class="level3" data-number="6.4">
<h3 data-number="6.4" class="anchored" data-anchor-id="svm"><span class="header-section-number">6.4</span> SVM</h3>
<section id="workflow-3" class="level4">
<h4 class="anchored" data-anchor-id="workflow-3">Workflow</h4>
<div class="cell" data-hash="index_cache/html/wflw_svm_d42d1ade530c513244b07f64c366045a">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># * SVM ----</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>wflw_fit_svm <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">spec =</span> <span class="fu">svm_rbf</span>(<span class="at">mode=</span><span class="st">"regression"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">set_engine</span>(<span class="st">"kernlab"</span>)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(recipe_spec<span class="sc">%&gt;%</span> <span class="fu">update_role</span>(date,<span class="at">new_role=</span><span class="st">"indicator"</span>))</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># fit(route_prep_nested_train)</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>wflw_fit_svm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>══ Workflow ════════════════════════════════════════════════════════════════════
Preprocessor: Recipe
Model: svm_rbf()

── Preprocessor ────────────────────────────────────────────────────────────────
6 Recipe Steps

• step_timeseries_signature()
• step_rm()
• step_normalize()
• step_zv()
• step_impute_knn()
• step_dummy()

── Model ───────────────────────────────────────────────────────────────────────
Radial Basis Function Support Vector Machine Model Specification (regression)

Computational engine: kernlab </code></pre>
</div>
</div>
</section>
</section>
<section id="random-forest" class="level3" data-number="6.5">
<h3 data-number="6.5" class="anchored" data-anchor-id="random-forest"><span class="header-section-number">6.5</span> Random Forest</h3>
<section id="workflowmodel" class="level4">
<h4 class="anchored" data-anchor-id="workflowmodel">Workflow/Model</h4>
<div class="cell" data-hash="index_cache/html/wflw_rf_31f0edefecec239026b17cb2c8368160">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># * RANDOM FOREST ----</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>wflw_fit_rf <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">spec =</span> <span class="fu">rand_forest</span>(<span class="at">mode=</span><span class="st">"regression"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">set_engine</span>(<span class="st">"ranger"</span>)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(recipe_spec<span class="sc">%&gt;%</span> <span class="fu">update_role</span>(date, <span class="at">new_role=</span><span class="st">"indicator"</span>))</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># fit(route_prep_nested_train)</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>wflw_fit_rf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>══ Workflow ════════════════════════════════════════════════════════════════════
Preprocessor: Recipe
Model: rand_forest()

── Preprocessor ────────────────────────────────────────────────────────────────
6 Recipe Steps

• step_timeseries_signature()
• step_rm()
• step_normalize()
• step_zv()
• step_impute_knn()
• step_dummy()

── Model ───────────────────────────────────────────────────────────────────────
Random Forest Model Specification (regression)

Computational engine: ranger </code></pre>
</div>
</div>
</section>
</section>
<section id="neural-net" class="level3" data-number="6.6">
<h3 data-number="6.6" class="anchored" data-anchor-id="neural-net"><span class="header-section-number">6.6</span> Neural Net</h3>
<section id="workflowmodel-1" class="level4">
<h4 class="anchored" data-anchor-id="workflowmodel-1">Workflow/Model</h4>
<div class="cell" data-hash="index_cache/html/wflw_nnet_3a0f513a96084b8246b2e272dc643b64">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># * NNET ----</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>wflw_fit_nnet <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">spec =</span> <span class="fu">mlp</span>(<span class="at">mode=</span><span class="st">"regression"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">set_engine</span>(<span class="st">"nnet"</span>)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(recipe_spec<span class="sc">%&gt;%</span> <span class="fu">update_role</span>(date, <span class="at">new_role=</span><span class="st">"indicator"</span>))</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># fit(route_prep_nested_train)</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>wflw_fit_nnet</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>══ Workflow ════════════════════════════════════════════════════════════════════
Preprocessor: Recipe
Model: mlp()

── Preprocessor ────────────────────────────────────────────────────────────────
6 Recipe Steps

• step_timeseries_signature()
• step_rm()
• step_normalize()
• step_zv()
• step_impute_knn()
• step_dummy()

── Model ───────────────────────────────────────────────────────────────────────
Single Layer Neural Network Model Specification (regression)

Computational engine: nnet </code></pre>
</div>
</div>
</section>
</section>
<section id="thief---temporal-hierarchical-forecasting" class="level3" data-number="6.7">
<h3 data-number="6.7" class="anchored" data-anchor-id="thief---temporal-hierarchical-forecasting"><span class="header-section-number">6.7</span> THIEF - Temporal Hierarchical Forecasting</h3>
<section id="workflowmodel-2" class="level4">
<h4 class="anchored" data-anchor-id="workflowmodel-2">Workflow/Model</h4>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-2_ddf7f006968cc225a63c674017e1468b">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># * THIEF - Temporal Hierachical Forecasting ----</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a> wflw_thief <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">add_model</span>(<span class="fu">temporal_hierarchy</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>               <span class="fu">set_engine</span>(<span class="st">"thief"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>   <span class="fu">add_recipe</span>(<span class="fu">recipe</span>(passenger_trips <span class="sc">~</span> .,route_prep_nested_train <span class="sc">%&gt;%</span> </span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">select</span>(passenger_trips,date)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>                     )</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>              )</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a> wflw_thief</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>══ Workflow ════════════════════════════════════════════════════════════════════
Preprocessor: Recipe
Model: temporal_hierarchy()

── Preprocessor ────────────────────────────────────────────────────────────────
0 Recipe Steps

── Model ───────────────────────────────────────────────────────────────────────
Temporal Hierarchical Forecasting Model Specification (regression)

Computational engine: thief </code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="nested-analysis" class="level2" data-number="7">
<h2 data-number="7" class="anchored" data-anchor-id="nested-analysis"><span class="header-section-number">7</span> Nested Analysis</h2>
<section id="combine-workflows-in-modeltime-table" class="level3" data-number="7.1">
<h3 data-number="7.1" class="anchored" data-anchor-id="combine-workflows-in-modeltime-table"><span class="header-section-number">7.1</span> Combine Workflows in Modeltime Table</h3>
<div class="cell" data-hash="index_cache/html/nested_wflws_6f563ee2841e2513253f4a1d3ba98773">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>nested_modeltime_tbl <span class="ot">&lt;-</span> route_prep_nested <span class="sc">%&gt;%</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">modeltime_nested_fit</span>(</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">model_list =</span> <span class="fu">list</span>(</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>      wflw_fit_auto_arima,</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>      wflw_fit_xgboost,</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>      wflw_fit_prophet_boost,</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>      wflw_fit_svm,</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>      wflw_fit_rf,</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>      wflw_fit_nnet,</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>      wflw_thief</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>      <span class="co"># #wflw_fit_gluonts_deepar - not working because of id cols</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">control_nested_fit</span>(</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">verbose   =</span> <span class="cn">TRUE</span>,</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">allow_par =</span> <span class="cn">TRUE</span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a><span class="co">#nested_modeltime_tbl %&gt;% glimpse() %&gt;% kable()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="check-errors" class="level3" data-number="7.2">
<h3 data-number="7.2" class="anchored" data-anchor-id="check-errors"><span class="header-section-number">7.2</span> Check Errors</h3>
<div class="cell" data-hash="index_cache/html/nested_errors_5ed47fe062cb6843944af2d3e60d3cdd">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># * Review Any Errors ----</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>nested_modeltime_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_nested_error_report</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 0 × 4
# … with 4 variables: route &lt;fct&gt;, .model_id &lt;int&gt;, .model_desc &lt;chr&gt;,
#   .error_desc &lt;chr&gt;</code></pre>
</div>
</div>
</section>
<section id="review-model-accuracy" class="level3" data-number="7.3">
<h3 data-number="7.3" class="anchored" data-anchor-id="review-model-accuracy"><span class="header-section-number">7.3</span> Review Model Accuracy</h3>
<div class="cell" data-hash="index_cache/html/accuracy_03f36d847907263e8f5c2401c2b2cd59">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># * Review Test Accuracy ----</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>nested_modeltime_best <span class="ot">&lt;-</span> nested_modeltime_tbl <span class="sc">%&gt;%</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_nested_test_accuracy</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.model_desc =</span> <span class="fu">str_replace_all</span>(.model_desc,<span class="st">"TEMPORAL HIERARCHICAL FORECASTING MODEL"</span>,<span class="st">"THIEF"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.model_desc =</span> <span class="fu">str_replace_all</span>(.model_desc,<span class="st">"PROPHET W XGBOOST ERRORS"</span>,<span class="st">"PROPHET W XGBOOST"</span>)) </span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>nested_modeltime_best<span class="sc">%&gt;%</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">table_modeltime_accuracy</span>(<span class="at">.round_digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div class="reactable html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-a825b63482ca4bb88500" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-a825b63482ca4bb88500">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"route":["ADELAIDE-MELBOURNE","ADELAIDE-MELBOURNE","ADELAIDE-MELBOURNE","ADELAIDE-MELBOURNE","ADELAIDE-MELBOURNE","ADELAIDE-MELBOURNE","ADELAIDE-MELBOURNE","ADELAIDE-SYDNEY","ADELAIDE-SYDNEY","ADELAIDE-SYDNEY","ADELAIDE-SYDNEY","ADELAIDE-SYDNEY","ADELAIDE-SYDNEY","ADELAIDE-SYDNEY","BRISBANE-CAIRNS","BRISBANE-CAIRNS","BRISBANE-CAIRNS","BRISBANE-CAIRNS","BRISBANE-CAIRNS","BRISBANE-CAIRNS","BRISBANE-CAIRNS","BRISBANE-MELBOURNE","BRISBANE-MELBOURNE","BRISBANE-MELBOURNE","BRISBANE-MELBOURNE","BRISBANE-MELBOURNE","BRISBANE-MELBOURNE","BRISBANE-MELBOURNE","BRISBANE-SYDNEY","BRISBANE-SYDNEY","BRISBANE-SYDNEY","BRISBANE-SYDNEY","BRISBANE-SYDNEY","BRISBANE-SYDNEY","BRISBANE-SYDNEY","GOLD COAST-SYDNEY","GOLD COAST-SYDNEY","GOLD COAST-SYDNEY","GOLD COAST-SYDNEY","GOLD COAST-SYDNEY","GOLD COAST-SYDNEY","GOLD COAST-SYDNEY","MELBOURNE-GOLD COAST","MELBOURNE-GOLD COAST","MELBOURNE-GOLD COAST","MELBOURNE-GOLD COAST","MELBOURNE-GOLD COAST","MELBOURNE-GOLD COAST","MELBOURNE-GOLD COAST","MELBOURNE-PERTH","MELBOURNE-PERTH","MELBOURNE-PERTH","MELBOURNE-PERTH","MELBOURNE-PERTH","MELBOURNE-PERTH","MELBOURNE-PERTH","MELBOURNE-SYDNEY","MELBOURNE-SYDNEY","MELBOURNE-SYDNEY","MELBOURNE-SYDNEY","MELBOURNE-SYDNEY","MELBOURNE-SYDNEY","MELBOURNE-SYDNEY","PERTH-SYDNEY","PERTH-SYDNEY","PERTH-SYDNEY","PERTH-SYDNEY","PERTH-SYDNEY","PERTH-SYDNEY","PERTH-SYDNEY"],".model_id":[1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7],".model_desc":["ARIMA","XGBOOST","PROPHET W XGBOOST","KERNLAB","RANGER","NNET","THIEF","ARIMA","XGBOOST","PROPHET W XGBOOST","KERNLAB","RANGER","NNET","THIEF","ARIMA","XGBOOST","PROPHET W XGBOOST","KERNLAB","RANGER","NNET","THIEF","ARIMA","XGBOOST","PROPHET W XGBOOST","KERNLAB","RANGER","NNET","THIEF","ARIMA","XGBOOST","PROPHET W XGBOOST","KERNLAB","RANGER","NNET","THIEF","ARIMA","XGBOOST","PROPHET W XGBOOST","KERNLAB","RANGER","NNET","THIEF","ARIMA","XGBOOST","PROPHET W XGBOOST","KERNLAB","RANGER","NNET","THIEF","ARIMA","XGBOOST","PROPHET W XGBOOST","KERNLAB","RANGER","NNET","THIEF","ARIMA","XGBOOST","PROPHET W XGBOOST","KERNLAB","RANGER","NNET","THIEF","ARIMA","XGBOOST","PROPHET W XGBOOST","KERNLAB","RANGER","NNET","THIEF"],".type":["Test","Test","Test","Test","Test","Test","Test","Test","Test","Test","Test","Test","Test","Test","Test","Test","Test","Test","Test","Test","Test","Test","Test","Test","Test","Test","Test","Test","Test","Test","Test","Test","Test","Test","Test","Test","Test","Test","Test","Test","Test","Test","Test","Test","Test","Test","Test","Test","Test","Test","Test","Test","Test","Test","Test","Test","Test","Test","Test","Test","Test","Test","Test","Test","Test","Test","Test","Test","Test","Test"],"mae":[0.031,0.029,0.027,0.034,0.032,0.239,0.026,0.064,0.026,0.043,0.028,0.028,0.051,0.028,0.07,0.052,0.071,0.071,0.051,0.121,0.035,0.04,0.025,0.026,0.022,0.03,0.034,0.028,0.019,0.018,0.028,0.02,0.024,0.028,0.02,0.026,0.038,0.032,0.03,0.029,0.047,0.016,0.044,0.033,0.043,0.046,0.041,0.056,0.037,0.022,0.039,0.059,0.025,0.04,0.06,0.025,0.036,0.025,0.034,0.019,0.026,0.241,0.019,0.029,0.026,0.022,0.03,0.029,0.167,0.032],"mape":[0.251,0.234,0.217,0.275,0.257,1.947,0.215,0.533,0.215,0.357,0.237,0.231,0.428,0.233,0.608,0.45,0.618,0.613,0.441,1.038,0.301,0.319,0.202,0.209,0.171,0.235,0.274,0.222,0.146,0.137,0.214,0.151,0.183,0.214,0.159,0.214,0.312,0.261,0.243,0.234,0.382,0.127,0.361,0.277,0.354,0.383,0.335,0.466,0.311,0.183,0.319,0.491,0.205,0.329,0.498,0.209,0.264,0.182,0.249,0.141,0.194,1.774,0.143,0.243,0.224,0.186,0.258,0.244,1.408,0.268],"mase":[0.484,0.452,0.419,0.533,0.497,3.765,0.415,0.852,0.343,0.57,0.378,0.369,0.682,0.373,1.076,0.795,1.092,1.083,0.779,1.844,0.532,0.532,0.337,0.348,0.285,0.392,0.456,0.37,0.32,0.301,0.469,0.333,0.402,0.469,0.347,0.277,0.405,0.337,0.315,0.304,0.495,0.165,0.329,0.252,0.322,0.35,0.307,0.425,0.283,0.247,0.43,0.662,0.276,0.444,0.671,0.281,0.59,0.406,0.556,0.315,0.432,3.968,0.319,0.391,0.36,0.3,0.414,0.392,2.274,0.432],"smape":[0.251,0.234,0.217,0.276,0.257,1.967,0.215,0.532,0.214,0.356,0.236,0.231,0.427,0.233,0.606,0.449,0.616,0.611,0.44,1.045,0.3,0.318,0.202,0.208,0.171,0.235,0.273,0.221,0.146,0.137,0.214,0.152,0.183,0.214,0.158,0.214,0.312,0.26,0.243,0.234,0.382,0.127,0.361,0.277,0.354,0.384,0.336,0.467,0.311,0.183,0.32,0.493,0.205,0.329,0.499,0.209,0.264,0.182,0.248,0.141,0.193,1.791,0.143,0.243,0.223,0.186,0.257,0.244,1.42,0.268],"rmse":[0.039,0.037,0.03,0.039,0.038,0.245,0.031,0.067,0.029,0.045,0.034,0.034,0.065,0.029,0.077,0.057,0.079,0.078,0.059,0.138,0.04,0.044,0.031,0.031,0.025,0.033,0.045,0.035,0.024,0.024,0.034,0.025,0.029,0.033,0.025,0.033,0.046,0.043,0.036,0.039,0.058,0.018,0.048,0.041,0.047,0.054,0.05,0.066,0.05,0.032,0.056,0.068,0.042,0.051,0.077,0.033,0.042,0.031,0.04,0.024,0.03,0.245,0.024,0.033,0.031,0.027,0.036,0.036,0.181,0.036],"rsq":[0.71,0.715,0.697,0.765,0.672,"NA",0.739,0.897,0.954,0.951,0.905,0.854,0.676,0.933,0.745,0.639,0.851,0.745,0.773,"NA",0.907,0.901,0.819,0.907,0.892,0.795,0.779,0.844,0.9,0.866,0.902,0.861,0.88,0.67,0.88,0.864,0.696,0.8,0.827,0.761,0.493,0.946,0.922,0.902,0.911,0.914,0.926,0.775,0.817,0.839,0.728,0.824,0.794,0.678,0.677,0.839,0.61,0.721,0.704,0.724,0.68,"NA",0.806,0.929,0.841,0.893,0.942,0.91,"NA",0.907]},"columns":[{"id":"route","name":"route","type":"factor"},{"id":".model_id","name":".model_id","type":"numeric"},{"id":".model_desc","name":".model_desc","type":"character"},{"id":".type","name":".type","type":"character"},{"id":"mae","name":"mae","type":"numeric"},{"id":"mape","name":"mape","type":"numeric"},{"id":"mase","name":"mase","type":"numeric"},{"id":"smape","name":"smape","type":"numeric"},{"id":"rmse","name":"rmse","type":"numeric"},{"id":"rsq","name":"rsq","type":"numeric"}],"searchable":true,"defaultExpanded":true,"showSortable":true,"dataKey":"1b3e3cafe50a3790fcda716bccc534fe"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="graph---models-test-data" class="level3" data-number="7.4">
<h3 data-number="7.4" class="anchored" data-anchor-id="graph---models-test-data"><span class="header-section-number">7.4</span> Graph - Models Test Data</h3>
<div class="cell" data-hash="index_cache/html/graph_cc282c4c9e9e633433130c491b3953bc">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># |fig: 500</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co"># graph data</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>nested_modeltime_tbl_grph_data <span class="ot">&lt;-</span> nested_modeltime_tbl <span class="sc">%&gt;%</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_nested_test_forecast</span>() <span class="sc">%&gt;%</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#slice_head(n=10) %&gt;%</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(route, <span class="st">"-"</span>, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"origin"</span>, <span class="st">"dest"</span>), <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.value =</span> <span class="fu">expm1</span>(.value)) <span class="sc">%&gt;%</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.model_desc =</span> <span class="fu">str_replace_all</span>(.model_desc,<span class="st">"TEMPORAL HIERARCHICAL FORECASTING MODEL"</span>,<span class="st">"THIEF"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.model_desc =</span> <span class="fu">str_replace_all</span>(.model_desc,<span class="st">"PROPHET W XGBOOST ERRORS"</span>,<span class="st">"PROPHET W XGBOOST"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">#filter(origin == city) %&gt;%</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">#filter(dest %in% c("MELBOURNE","SYDNEY","CAIRNS","HOBART")) %&gt;% </span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(route,.model_desc)</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a><span class="co"># graph</span></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> nested_modeltime_tbl_grph_data <span class="sc">%&gt;%</span></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(route, <span class="at">model =</span> .model_desc, <span class="at">date =</span> .index,<span class="at">pax=</span>.value) <span class="sc">%&gt;%</span></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">year</span>(date)<span class="sc">&gt;</span><span class="dv">2014</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>date,<span class="at">y =</span> pax<span class="sc">/</span><span class="dv">1000</span>, <span class="at">color =</span> model)) <span class="sc">+</span></span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> comma) <span class="sc">+</span></span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"pax pm(000)"</span>) <span class="sc">+</span></span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> route,  <span class="at">ncol=</span><span class="dv">2</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">5</span>))</span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(g)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-d1ae01c19397b0333bd2" style="width:100%;height:975px;"></div>
<script type="application/json" data-for="htmlwidget-d1ae01c19397b0333bd2">{"x":{"data":[{"x":[16436,16467,16495,16526,16556,16587,16617,16648,16679,16709,16740,16770,16801,16832,16861,16892,16922,16953,16983,17014,17045,17075,17106,17136,17167,17198,17226,17257,17287,17318,17348,17379,17410,17440,17471,17501,17532,17563,17591,17622,17652,17683,17713,17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[177.599,174.781,200.299,205.005,186.943,175.225,202.394,194.278,188.739,207.82,199.688,198.179,187.175,186.48,208.15,206.603,200.302,182.931,215.652,189.511,195.837,211.873,206.318,203.051,197.64,182.535,214.815,202.681,198.673,194.83,216.528,195.35,201.692,221.993,213.206,216.483,200.967,191.022,221.754,215.39,200.029,192.792,217.777,206.123,201.779,221.346,219.313,209.912,199.04,200.463,227.419,215.027,199.098,189.519,222.844],"text":["date: 2015-01-01<br />pax/1000: 177.59900<br />model: ACTUAL","date: 2015-02-01<br />pax/1000: 174.78100<br />model: ACTUAL","date: 2015-03-01<br />pax/1000: 200.29900<br />model: ACTUAL","date: 2015-04-01<br />pax/1000: 205.00500<br />model: ACTUAL","date: 2015-05-01<br />pax/1000: 186.94300<br />model: ACTUAL","date: 2015-06-01<br />pax/1000: 175.22500<br />model: ACTUAL","date: 2015-07-01<br />pax/1000: 202.39400<br />model: ACTUAL","date: 2015-08-01<br />pax/1000: 194.27800<br />model: ACTUAL","date: 2015-09-01<br />pax/1000: 188.73900<br />model: ACTUAL","date: 2015-10-01<br />pax/1000: 207.82000<br />model: ACTUAL","date: 2015-11-01<br />pax/1000: 199.68800<br />model: ACTUAL","date: 2015-12-01<br />pax/1000: 198.17900<br />model: ACTUAL","date: 2016-01-01<br />pax/1000: 187.17500<br />model: ACTUAL","date: 2016-02-01<br />pax/1000: 186.48000<br />model: ACTUAL","date: 2016-03-01<br />pax/1000: 208.15000<br />model: ACTUAL","date: 2016-04-01<br />pax/1000: 206.60300<br />model: ACTUAL","date: 2016-05-01<br />pax/1000: 200.30200<br />model: ACTUAL","date: 2016-06-01<br />pax/1000: 182.93100<br />model: ACTUAL","date: 2016-07-01<br />pax/1000: 215.65200<br />model: ACTUAL","date: 2016-08-01<br />pax/1000: 189.51100<br />model: ACTUAL","date: 2016-09-01<br />pax/1000: 195.83700<br />model: ACTUAL","date: 2016-10-01<br />pax/1000: 211.87300<br />model: ACTUAL","date: 2016-11-01<br />pax/1000: 206.31800<br />model: ACTUAL","date: 2016-12-01<br />pax/1000: 203.05100<br />model: ACTUAL","date: 2017-01-01<br />pax/1000: 197.64000<br />model: ACTUAL","date: 2017-02-01<br />pax/1000: 182.53500<br />model: ACTUAL","date: 2017-03-01<br />pax/1000: 214.81500<br />model: ACTUAL","date: 2017-04-01<br />pax/1000: 202.68100<br />model: ACTUAL","date: 2017-05-01<br />pax/1000: 198.67300<br />model: ACTUAL","date: 2017-06-01<br />pax/1000: 194.83000<br />model: ACTUAL","date: 2017-07-01<br />pax/1000: 216.52800<br />model: ACTUAL","date: 2017-08-01<br />pax/1000: 195.35000<br />model: ACTUAL","date: 2017-09-01<br />pax/1000: 201.69200<br />model: ACTUAL","date: 2017-10-01<br />pax/1000: 221.99300<br />model: ACTUAL","date: 2017-11-01<br />pax/1000: 213.20600<br />model: ACTUAL","date: 2017-12-01<br />pax/1000: 216.48300<br />model: ACTUAL","date: 2018-01-01<br />pax/1000: 200.96700<br />model: ACTUAL","date: 2018-02-01<br />pax/1000: 191.02200<br />model: ACTUAL","date: 2018-03-01<br />pax/1000: 221.75400<br />model: ACTUAL","date: 2018-04-01<br />pax/1000: 215.39000<br />model: ACTUAL","date: 2018-05-01<br />pax/1000: 200.02900<br />model: ACTUAL","date: 2018-06-01<br />pax/1000: 192.79200<br />model: ACTUAL","date: 2018-07-01<br />pax/1000: 217.77700<br />model: ACTUAL","date: 2018-08-01<br />pax/1000: 206.12300<br />model: ACTUAL","date: 2018-09-01<br />pax/1000: 201.77900<br />model: ACTUAL","date: 2018-10-01<br />pax/1000: 221.34600<br />model: ACTUAL","date: 2018-11-01<br />pax/1000: 219.31300<br />model: ACTUAL","date: 2018-12-01<br />pax/1000: 209.91200<br />model: ACTUAL","date: 2019-01-01<br />pax/1000: 199.04000<br />model: ACTUAL","date: 2019-02-01<br />pax/1000: 200.46300<br />model: ACTUAL","date: 2019-03-01<br />pax/1000: 227.41900<br />model: ACTUAL","date: 2019-04-01<br />pax/1000: 215.02700<br />model: ACTUAL","date: 2019-05-01<br />pax/1000: 199.09800<br />model: ACTUAL","date: 2019-06-01<br />pax/1000: 189.51900<br />model: ACTUAL","date: 2019-07-01<br />pax/1000: 222.84400<br />model: ACTUAL"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"ACTUAL","legendgroup":"ACTUAL","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[16436,16467,16495,16526,16556,16587,16617,16648,16679,16709,16740,16770,16801,16832,16861,16892,16922,16953,16983,17014,17045,17075,17106,17136,17167,17198,17226,17257,17287,17318,17348,17379,17410,17440,17471,17501,17532,17563,17591,17622,17652,17683,17713,17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[153.524,138.602,160.058,157.043,143.241,128.63,156.313,144.409,151.164,171.236,159.721,167.517,162.446,145.72,168.447,160.265,147.809,134.753,153.728,146.973,154.997,165.542,165.458,165.852,164.884,144.427,171.647,159.593,152.101,141.263,158.417,146.898,151.193,170.557,166.975,170.313,161.998,146.223,172.79,170.319,151.396,141.618,161.773,148.639,151.273,171.464,166.182,162.98,158.122,142.286,166.592,163.623,146.791,137.571,158.892],"text":["date: 2015-01-01<br />pax/1000: 153.52400<br />model: ACTUAL","date: 2015-02-01<br />pax/1000: 138.60200<br />model: ACTUAL","date: 2015-03-01<br />pax/1000: 160.05800<br />model: ACTUAL","date: 2015-04-01<br />pax/1000: 157.04300<br />model: ACTUAL","date: 2015-05-01<br />pax/1000: 143.24100<br />model: ACTUAL","date: 2015-06-01<br />pax/1000: 128.63000<br />model: ACTUAL","date: 2015-07-01<br />pax/1000: 156.31300<br />model: ACTUAL","date: 2015-08-01<br />pax/1000: 144.40900<br />model: ACTUAL","date: 2015-09-01<br />pax/1000: 151.16400<br />model: ACTUAL","date: 2015-10-01<br />pax/1000: 171.23600<br />model: ACTUAL","date: 2015-11-01<br />pax/1000: 159.72100<br />model: ACTUAL","date: 2015-12-01<br />pax/1000: 167.51700<br />model: ACTUAL","date: 2016-01-01<br />pax/1000: 162.44600<br />model: ACTUAL","date: 2016-02-01<br />pax/1000: 145.72000<br />model: ACTUAL","date: 2016-03-01<br />pax/1000: 168.44700<br />model: ACTUAL","date: 2016-04-01<br />pax/1000: 160.26500<br />model: ACTUAL","date: 2016-05-01<br />pax/1000: 147.80900<br />model: ACTUAL","date: 2016-06-01<br />pax/1000: 134.75300<br />model: ACTUAL","date: 2016-07-01<br />pax/1000: 153.72800<br />model: ACTUAL","date: 2016-08-01<br />pax/1000: 146.97300<br />model: ACTUAL","date: 2016-09-01<br />pax/1000: 154.99700<br />model: ACTUAL","date: 2016-10-01<br />pax/1000: 165.54200<br />model: ACTUAL","date: 2016-11-01<br />pax/1000: 165.45800<br />model: ACTUAL","date: 2016-12-01<br />pax/1000: 165.85200<br />model: ACTUAL","date: 2017-01-01<br />pax/1000: 164.88400<br />model: ACTUAL","date: 2017-02-01<br />pax/1000: 144.42700<br />model: ACTUAL","date: 2017-03-01<br />pax/1000: 171.64700<br />model: ACTUAL","date: 2017-04-01<br />pax/1000: 159.59300<br />model: ACTUAL","date: 2017-05-01<br />pax/1000: 152.10100<br />model: ACTUAL","date: 2017-06-01<br />pax/1000: 141.26300<br />model: ACTUAL","date: 2017-07-01<br />pax/1000: 158.41700<br />model: ACTUAL","date: 2017-08-01<br />pax/1000: 146.89800<br />model: ACTUAL","date: 2017-09-01<br />pax/1000: 151.19300<br />model: ACTUAL","date: 2017-10-01<br />pax/1000: 170.55700<br />model: ACTUAL","date: 2017-11-01<br />pax/1000: 166.97500<br />model: ACTUAL","date: 2017-12-01<br />pax/1000: 170.31300<br />model: ACTUAL","date: 2018-01-01<br />pax/1000: 161.99800<br />model: ACTUAL","date: 2018-02-01<br />pax/1000: 146.22300<br />model: ACTUAL","date: 2018-03-01<br />pax/1000: 172.79000<br />model: ACTUAL","date: 2018-04-01<br />pax/1000: 170.31900<br />model: ACTUAL","date: 2018-05-01<br />pax/1000: 151.39600<br />model: ACTUAL","date: 2018-06-01<br />pax/1000: 141.61800<br />model: ACTUAL","date: 2018-07-01<br />pax/1000: 161.77300<br />model: ACTUAL","date: 2018-08-01<br />pax/1000: 148.63900<br />model: ACTUAL","date: 2018-09-01<br />pax/1000: 151.27300<br />model: ACTUAL","date: 2018-10-01<br />pax/1000: 171.46400<br />model: ACTUAL","date: 2018-11-01<br />pax/1000: 166.18200<br />model: ACTUAL","date: 2018-12-01<br />pax/1000: 162.98000<br />model: ACTUAL","date: 2019-01-01<br />pax/1000: 158.12200<br />model: ACTUAL","date: 2019-02-01<br />pax/1000: 142.28600<br />model: ACTUAL","date: 2019-03-01<br />pax/1000: 166.59200<br />model: ACTUAL","date: 2019-04-01<br />pax/1000: 163.62300<br />model: ACTUAL","date: 2019-05-01<br />pax/1000: 146.79100<br />model: ACTUAL","date: 2019-06-01<br />pax/1000: 137.57100<br />model: ACTUAL","date: 2019-07-01<br />pax/1000: 158.89200<br />model: ACTUAL"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"ACTUAL","legendgroup":"ACTUAL","showlegend":false,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[16436,16467,16495,16526,16556,16587,16617,16648,16679,16709,16740,16770,16801,16832,16861,16892,16922,16953,16983,17014,17045,17075,17106,17136,17167,17198,17226,17257,17287,17318,17348,17379,17410,17440,17471,17501,17532,17563,17591,17622,17652,17683,17713,17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[101.864,100.349,98.368,104.976,100.654,104.963,120.967,115.172,110.667,115.09,113.628,119.727,107.59,104.094,109.008,104.613,104.098,109.139,125.486,117.72,114.248,118.114,112.845,119.967,112.125,93.632,109.676,118.045,105.548,112.189,129.914,119.658,117.629,123.971,117.89,117.623,110.692,102.253,106.677,106.624,106.162,103.421,124.693,120.957,106.975,115.879,107.184,108.615,101.163,93.158,99.6150000000001,105.053,104.658,103.936,119.665],"text":["date: 2015-01-01<br />pax/1000: 101.86400<br />model: ACTUAL","date: 2015-02-01<br />pax/1000: 100.34900<br />model: ACTUAL","date: 2015-03-01<br />pax/1000:  98.36800<br />model: ACTUAL","date: 2015-04-01<br />pax/1000: 104.97600<br />model: ACTUAL","date: 2015-05-01<br />pax/1000: 100.65400<br />model: ACTUAL","date: 2015-06-01<br />pax/1000: 104.96300<br />model: ACTUAL","date: 2015-07-01<br />pax/1000: 120.96700<br />model: ACTUAL","date: 2015-08-01<br />pax/1000: 115.17200<br />model: ACTUAL","date: 2015-09-01<br />pax/1000: 110.66700<br />model: ACTUAL","date: 2015-10-01<br />pax/1000: 115.09000<br />model: ACTUAL","date: 2015-11-01<br />pax/1000: 113.62800<br />model: ACTUAL","date: 2015-12-01<br />pax/1000: 119.72700<br />model: ACTUAL","date: 2016-01-01<br />pax/1000: 107.59000<br />model: ACTUAL","date: 2016-02-01<br />pax/1000: 104.09400<br />model: ACTUAL","date: 2016-03-01<br />pax/1000: 109.00800<br />model: ACTUAL","date: 2016-04-01<br />pax/1000: 104.61300<br />model: ACTUAL","date: 2016-05-01<br />pax/1000: 104.09800<br />model: ACTUAL","date: 2016-06-01<br />pax/1000: 109.13900<br />model: ACTUAL","date: 2016-07-01<br />pax/1000: 125.48600<br />model: ACTUAL","date: 2016-08-01<br />pax/1000: 117.72000<br />model: ACTUAL","date: 2016-09-01<br />pax/1000: 114.24800<br />model: ACTUAL","date: 2016-10-01<br />pax/1000: 118.11400<br />model: ACTUAL","date: 2016-11-01<br />pax/1000: 112.84500<br />model: ACTUAL","date: 2016-12-01<br />pax/1000: 119.96700<br />model: ACTUAL","date: 2017-01-01<br />pax/1000: 112.12500<br />model: ACTUAL","date: 2017-02-01<br />pax/1000:  93.63200<br />model: ACTUAL","date: 2017-03-01<br />pax/1000: 109.67600<br />model: ACTUAL","date: 2017-04-01<br />pax/1000: 118.04500<br />model: ACTUAL","date: 2017-05-01<br />pax/1000: 105.54800<br />model: ACTUAL","date: 2017-06-01<br />pax/1000: 112.18900<br />model: ACTUAL","date: 2017-07-01<br />pax/1000: 129.91400<br />model: ACTUAL","date: 2017-08-01<br />pax/1000: 119.65800<br />model: ACTUAL","date: 2017-09-01<br />pax/1000: 117.62900<br />model: ACTUAL","date: 2017-10-01<br />pax/1000: 123.97100<br />model: ACTUAL","date: 2017-11-01<br />pax/1000: 117.89000<br />model: ACTUAL","date: 2017-12-01<br />pax/1000: 117.62300<br />model: ACTUAL","date: 2018-01-01<br />pax/1000: 110.69200<br />model: ACTUAL","date: 2018-02-01<br />pax/1000: 102.25300<br />model: ACTUAL","date: 2018-03-01<br />pax/1000: 106.67700<br />model: ACTUAL","date: 2018-04-01<br />pax/1000: 106.62400<br />model: ACTUAL","date: 2018-05-01<br />pax/1000: 106.16200<br />model: ACTUAL","date: 2018-06-01<br />pax/1000: 103.42100<br />model: ACTUAL","date: 2018-07-01<br />pax/1000: 124.69300<br />model: ACTUAL","date: 2018-08-01<br />pax/1000: 120.95700<br />model: ACTUAL","date: 2018-09-01<br />pax/1000: 106.97500<br />model: ACTUAL","date: 2018-10-01<br />pax/1000: 115.87900<br />model: ACTUAL","date: 2018-11-01<br />pax/1000: 107.18400<br />model: ACTUAL","date: 2018-12-01<br />pax/1000: 108.61500<br />model: ACTUAL","date: 2019-01-01<br />pax/1000: 101.16300<br />model: ACTUAL","date: 2019-02-01<br />pax/1000:  93.15800<br />model: ACTUAL","date: 2019-03-01<br />pax/1000:  99.61500<br />model: ACTUAL","date: 2019-04-01<br />pax/1000: 105.05300<br />model: ACTUAL","date: 2019-05-01<br />pax/1000: 104.65800<br />model: ACTUAL","date: 2019-06-01<br />pax/1000: 103.93600<br />model: ACTUAL","date: 2019-07-01<br />pax/1000: 119.66500<br />model: ACTUAL"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"ACTUAL","legendgroup":"ACTUAL","showlegend":false,"xaxis":"x3","yaxis":"y3","hoverinfo":"text","frame":null},{"x":[16436,16467,16495,16526,16556,16587,16617,16648,16679,16709,16740,16770,16801,16832,16861,16892,16922,16953,16983,17014,17045,17075,17106,17136,17167,17198,17226,17257,17287,17318,17348,17379,17410,17440,17471,17501,17532,17563,17591,17622,17652,17683,17713,17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[270.623,235.175,281.811,273.919,252.533,258.853,307.903,270.706,294.709,310.153,293.339,304.032,285.37,253.989,294.255,275.908,271.424,276.902,313.683,287.653,311.849,309.189,301.438,311.579,293.092,240.455,288.883,291.176,271.962,279.45,324.721,298.157,307.122,328.434,308.588,309.031,291.254,249.485,296.549,284.525,277.345,281.817,336.225,299.829,303.208,331.03,315.431,302.663,296.59,255.981,295.315,307.006,276.35,275.212,330.83],"text":["date: 2015-01-01<br />pax/1000: 270.62300<br />model: ACTUAL","date: 2015-02-01<br />pax/1000: 235.17500<br />model: ACTUAL","date: 2015-03-01<br />pax/1000: 281.81100<br />model: ACTUAL","date: 2015-04-01<br />pax/1000: 273.91900<br />model: ACTUAL","date: 2015-05-01<br />pax/1000: 252.53300<br />model: ACTUAL","date: 2015-06-01<br />pax/1000: 258.85300<br />model: ACTUAL","date: 2015-07-01<br />pax/1000: 307.90300<br />model: ACTUAL","date: 2015-08-01<br />pax/1000: 270.70600<br />model: ACTUAL","date: 2015-09-01<br />pax/1000: 294.70900<br />model: ACTUAL","date: 2015-10-01<br />pax/1000: 310.15300<br />model: ACTUAL","date: 2015-11-01<br />pax/1000: 293.33900<br />model: ACTUAL","date: 2015-12-01<br />pax/1000: 304.03200<br />model: ACTUAL","date: 2016-01-01<br />pax/1000: 285.37000<br />model: ACTUAL","date: 2016-02-01<br />pax/1000: 253.98900<br />model: ACTUAL","date: 2016-03-01<br />pax/1000: 294.25500<br />model: ACTUAL","date: 2016-04-01<br />pax/1000: 275.90800<br />model: ACTUAL","date: 2016-05-01<br />pax/1000: 271.42400<br />model: ACTUAL","date: 2016-06-01<br />pax/1000: 276.90200<br />model: ACTUAL","date: 2016-07-01<br />pax/1000: 313.68300<br />model: ACTUAL","date: 2016-08-01<br />pax/1000: 287.65300<br />model: ACTUAL","date: 2016-09-01<br />pax/1000: 311.84900<br />model: ACTUAL","date: 2016-10-01<br />pax/1000: 309.18900<br />model: ACTUAL","date: 2016-11-01<br />pax/1000: 301.43800<br />model: ACTUAL","date: 2016-12-01<br />pax/1000: 311.57900<br />model: ACTUAL","date: 2017-01-01<br />pax/1000: 293.09200<br />model: ACTUAL","date: 2017-02-01<br />pax/1000: 240.45500<br />model: ACTUAL","date: 2017-03-01<br />pax/1000: 288.88300<br />model: ACTUAL","date: 2017-04-01<br />pax/1000: 291.17600<br />model: ACTUAL","date: 2017-05-01<br />pax/1000: 271.96200<br />model: ACTUAL","date: 2017-06-01<br />pax/1000: 279.45000<br />model: ACTUAL","date: 2017-07-01<br />pax/1000: 324.72100<br />model: ACTUAL","date: 2017-08-01<br />pax/1000: 298.15700<br />model: ACTUAL","date: 2017-09-01<br />pax/1000: 307.12200<br />model: ACTUAL","date: 2017-10-01<br />pax/1000: 328.43400<br />model: ACTUAL","date: 2017-11-01<br />pax/1000: 308.58800<br />model: ACTUAL","date: 2017-12-01<br />pax/1000: 309.03100<br />model: ACTUAL","date: 2018-01-01<br />pax/1000: 291.25400<br />model: ACTUAL","date: 2018-02-01<br />pax/1000: 249.48500<br />model: ACTUAL","date: 2018-03-01<br />pax/1000: 296.54900<br />model: ACTUAL","date: 2018-04-01<br />pax/1000: 284.52500<br />model: ACTUAL","date: 2018-05-01<br />pax/1000: 277.34500<br />model: ACTUAL","date: 2018-06-01<br />pax/1000: 281.81700<br />model: ACTUAL","date: 2018-07-01<br />pax/1000: 336.22500<br />model: ACTUAL","date: 2018-08-01<br />pax/1000: 299.82900<br />model: ACTUAL","date: 2018-09-01<br />pax/1000: 303.20800<br />model: ACTUAL","date: 2018-10-01<br />pax/1000: 331.03000<br />model: ACTUAL","date: 2018-11-01<br />pax/1000: 315.43100<br />model: ACTUAL","date: 2018-12-01<br />pax/1000: 302.66300<br />model: ACTUAL","date: 2019-01-01<br />pax/1000: 296.59000<br />model: ACTUAL","date: 2019-02-01<br />pax/1000: 255.98100<br />model: ACTUAL","date: 2019-03-01<br />pax/1000: 295.31500<br />model: ACTUAL","date: 2019-04-01<br />pax/1000: 307.00600<br />model: ACTUAL","date: 2019-05-01<br />pax/1000: 276.35000<br />model: ACTUAL","date: 2019-06-01<br />pax/1000: 275.21200<br />model: ACTUAL","date: 2019-07-01<br />pax/1000: 330.83000<br />model: ACTUAL"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"ACTUAL","legendgroup":"ACTUAL","showlegend":false,"xaxis":"x4","yaxis":"y4","hoverinfo":"text","frame":null},{"x":[16436,16467,16495,16526,16556,16587,16617,16648,16679,16709,16740,16770,16801,16832,16861,16892,16922,16953,16983,17014,17045,17075,17106,17136,17167,17198,17226,17257,17287,17318,17348,17379,17410,17440,17471,17501,17532,17563,17591,17622,17652,17683,17713,17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[337.34,326.371,372.575,362.935,356.316,348.947,406.136,380.346,390.503,401.872,391.143,401.446,361.99,351.922,390.934,385.867,374.209,371.664,420.104,391.157,403.375,403.993,396.198,406.716,372.217,349.746,399.571,384.014,386.26,382.389,424.563,398.64,403.898,419.015,413.987,411.956,364.59,365.243,415.257,389.543,397.312,383.912,435.197,416.496,397.239,430.052,423.397,407.24,373.527,353.301,404.452,397.001,396.519,380.079,431.064],"text":["date: 2015-01-01<br />pax/1000: 337.34000<br />model: ACTUAL","date: 2015-02-01<br />pax/1000: 326.37100<br />model: ACTUAL","date: 2015-03-01<br />pax/1000: 372.57500<br />model: ACTUAL","date: 2015-04-01<br />pax/1000: 362.93500<br />model: ACTUAL","date: 2015-05-01<br />pax/1000: 356.31600<br />model: ACTUAL","date: 2015-06-01<br />pax/1000: 348.94700<br />model: ACTUAL","date: 2015-07-01<br />pax/1000: 406.13600<br />model: ACTUAL","date: 2015-08-01<br />pax/1000: 380.34600<br />model: ACTUAL","date: 2015-09-01<br />pax/1000: 390.50300<br />model: ACTUAL","date: 2015-10-01<br />pax/1000: 401.87200<br />model: ACTUAL","date: 2015-11-01<br />pax/1000: 391.14300<br />model: ACTUAL","date: 2015-12-01<br />pax/1000: 401.44600<br />model: ACTUAL","date: 2016-01-01<br />pax/1000: 361.99000<br />model: ACTUAL","date: 2016-02-01<br />pax/1000: 351.92200<br />model: ACTUAL","date: 2016-03-01<br />pax/1000: 390.93400<br />model: ACTUAL","date: 2016-04-01<br />pax/1000: 385.86700<br />model: ACTUAL","date: 2016-05-01<br />pax/1000: 374.20900<br />model: ACTUAL","date: 2016-06-01<br />pax/1000: 371.66400<br />model: ACTUAL","date: 2016-07-01<br />pax/1000: 420.10400<br />model: ACTUAL","date: 2016-08-01<br />pax/1000: 391.15700<br />model: ACTUAL","date: 2016-09-01<br />pax/1000: 403.37500<br />model: ACTUAL","date: 2016-10-01<br />pax/1000: 403.99300<br />model: ACTUAL","date: 2016-11-01<br />pax/1000: 396.19800<br />model: ACTUAL","date: 2016-12-01<br />pax/1000: 406.71600<br />model: ACTUAL","date: 2017-01-01<br />pax/1000: 372.21700<br />model: ACTUAL","date: 2017-02-01<br />pax/1000: 349.74600<br />model: ACTUAL","date: 2017-03-01<br />pax/1000: 399.57100<br />model: ACTUAL","date: 2017-04-01<br />pax/1000: 384.01400<br />model: ACTUAL","date: 2017-05-01<br />pax/1000: 386.26000<br />model: ACTUAL","date: 2017-06-01<br />pax/1000: 382.38900<br />model: ACTUAL","date: 2017-07-01<br />pax/1000: 424.56300<br />model: ACTUAL","date: 2017-08-01<br />pax/1000: 398.64000<br />model: ACTUAL","date: 2017-09-01<br />pax/1000: 403.89800<br />model: ACTUAL","date: 2017-10-01<br />pax/1000: 419.01500<br />model: ACTUAL","date: 2017-11-01<br />pax/1000: 413.98700<br />model: ACTUAL","date: 2017-12-01<br />pax/1000: 411.95600<br />model: ACTUAL","date: 2018-01-01<br />pax/1000: 364.59000<br />model: ACTUAL","date: 2018-02-01<br />pax/1000: 365.24300<br />model: ACTUAL","date: 2018-03-01<br />pax/1000: 415.25700<br />model: ACTUAL","date: 2018-04-01<br />pax/1000: 389.54300<br />model: ACTUAL","date: 2018-05-01<br />pax/1000: 397.31200<br />model: ACTUAL","date: 2018-06-01<br />pax/1000: 383.91200<br />model: ACTUAL","date: 2018-07-01<br />pax/1000: 435.19700<br />model: ACTUAL","date: 2018-08-01<br />pax/1000: 416.49600<br />model: ACTUAL","date: 2018-09-01<br />pax/1000: 397.23900<br />model: ACTUAL","date: 2018-10-01<br />pax/1000: 430.05200<br />model: ACTUAL","date: 2018-11-01<br />pax/1000: 423.39700<br />model: ACTUAL","date: 2018-12-01<br />pax/1000: 407.24000<br />model: ACTUAL","date: 2019-01-01<br />pax/1000: 373.52700<br />model: ACTUAL","date: 2019-02-01<br />pax/1000: 353.30100<br />model: ACTUAL","date: 2019-03-01<br />pax/1000: 404.45200<br />model: ACTUAL","date: 2019-04-01<br />pax/1000: 397.00100<br />model: ACTUAL","date: 2019-05-01<br />pax/1000: 396.51900<br />model: ACTUAL","date: 2019-06-01<br />pax/1000: 380.07900<br />model: ACTUAL","date: 2019-07-01<br />pax/1000: 431.06400<br />model: ACTUAL"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"ACTUAL","legendgroup":"ACTUAL","showlegend":false,"xaxis":"x5","yaxis":"y5","hoverinfo":"text","frame":null},{"x":[16436,16467,16495,16526,16556,16587,16617,16648,16679,16709,16740,16770,16801,16832,16861,16892,16922,16953,16983,17014,17045,17075,17106,17136,17167,17198,17226,17257,17287,17318,17348,17379,17410,17440,17471,17501,17532,17563,17591,17622,17652,17683,17713,17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[246.54,189.785,209.366,217.46,194.573,187.068,224.056,203.278,229.549,246.047,227.34,243.42,269.046,212.763,225.946,226.328,201.651,192.917,233.409,210.48,224.204,240.452,222.848,244.314,262.496,207.359,223.411,234.763,207.868,201.055,237.3,207.373,225.108,243.67,237.198,253.144,268.842,210.782,231.49,242.48,200.578,193.628,228.633,220.913,222.866,240.827,222.005,239.752,264.968,202.044,217.522,227.621,206.393,198.319,235.419],"text":["date: 2015-01-01<br />pax/1000: 246.54000<br />model: ACTUAL","date: 2015-02-01<br />pax/1000: 189.78500<br />model: ACTUAL","date: 2015-03-01<br />pax/1000: 209.36600<br />model: ACTUAL","date: 2015-04-01<br />pax/1000: 217.46000<br />model: ACTUAL","date: 2015-05-01<br />pax/1000: 194.57300<br />model: ACTUAL","date: 2015-06-01<br />pax/1000: 187.06800<br />model: ACTUAL","date: 2015-07-01<br />pax/1000: 224.05600<br />model: ACTUAL","date: 2015-08-01<br />pax/1000: 203.27800<br />model: ACTUAL","date: 2015-09-01<br />pax/1000: 229.54900<br />model: ACTUAL","date: 2015-10-01<br />pax/1000: 246.04700<br />model: ACTUAL","date: 2015-11-01<br />pax/1000: 227.34000<br />model: ACTUAL","date: 2015-12-01<br />pax/1000: 243.42000<br />model: ACTUAL","date: 2016-01-01<br />pax/1000: 269.04600<br />model: ACTUAL","date: 2016-02-01<br />pax/1000: 212.76300<br />model: ACTUAL","date: 2016-03-01<br />pax/1000: 225.94600<br />model: ACTUAL","date: 2016-04-01<br />pax/1000: 226.32800<br />model: ACTUAL","date: 2016-05-01<br />pax/1000: 201.65100<br />model: ACTUAL","date: 2016-06-01<br />pax/1000: 192.91700<br />model: ACTUAL","date: 2016-07-01<br />pax/1000: 233.40900<br />model: ACTUAL","date: 2016-08-01<br />pax/1000: 210.48000<br />model: ACTUAL","date: 2016-09-01<br />pax/1000: 224.20400<br />model: ACTUAL","date: 2016-10-01<br />pax/1000: 240.45200<br />model: ACTUAL","date: 2016-11-01<br />pax/1000: 222.84800<br />model: ACTUAL","date: 2016-12-01<br />pax/1000: 244.31400<br />model: ACTUAL","date: 2017-01-01<br />pax/1000: 262.49600<br />model: ACTUAL","date: 2017-02-01<br />pax/1000: 207.35900<br />model: ACTUAL","date: 2017-03-01<br />pax/1000: 223.41100<br />model: ACTUAL","date: 2017-04-01<br />pax/1000: 234.76300<br />model: ACTUAL","date: 2017-05-01<br />pax/1000: 207.86800<br />model: ACTUAL","date: 2017-06-01<br />pax/1000: 201.05500<br />model: ACTUAL","date: 2017-07-01<br />pax/1000: 237.30000<br />model: ACTUAL","date: 2017-08-01<br />pax/1000: 207.37300<br />model: ACTUAL","date: 2017-09-01<br />pax/1000: 225.10800<br />model: ACTUAL","date: 2017-10-01<br />pax/1000: 243.67000<br />model: ACTUAL","date: 2017-11-01<br />pax/1000: 237.19800<br />model: ACTUAL","date: 2017-12-01<br />pax/1000: 253.14400<br />model: ACTUAL","date: 2018-01-01<br />pax/1000: 268.84200<br />model: ACTUAL","date: 2018-02-01<br />pax/1000: 210.78200<br />model: ACTUAL","date: 2018-03-01<br />pax/1000: 231.49000<br />model: ACTUAL","date: 2018-04-01<br />pax/1000: 242.48000<br />model: ACTUAL","date: 2018-05-01<br />pax/1000: 200.57800<br />model: ACTUAL","date: 2018-06-01<br />pax/1000: 193.62800<br />model: ACTUAL","date: 2018-07-01<br />pax/1000: 228.63300<br />model: ACTUAL","date: 2018-08-01<br />pax/1000: 220.91300<br />model: ACTUAL","date: 2018-09-01<br />pax/1000: 222.86600<br />model: ACTUAL","date: 2018-10-01<br />pax/1000: 240.82700<br />model: ACTUAL","date: 2018-11-01<br />pax/1000: 222.00500<br />model: ACTUAL","date: 2018-12-01<br />pax/1000: 239.75200<br />model: ACTUAL","date: 2019-01-01<br />pax/1000: 264.96800<br />model: ACTUAL","date: 2019-02-01<br />pax/1000: 202.04400<br />model: ACTUAL","date: 2019-03-01<br />pax/1000: 217.52200<br />model: ACTUAL","date: 2019-04-01<br />pax/1000: 227.62100<br />model: ACTUAL","date: 2019-05-01<br />pax/1000: 206.39300<br />model: ACTUAL","date: 2019-06-01<br />pax/1000: 198.31900<br />model: ACTUAL","date: 2019-07-01<br />pax/1000: 235.41900<br />model: ACTUAL"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"ACTUAL","legendgroup":"ACTUAL","showlegend":false,"xaxis":"x6","yaxis":"y6","hoverinfo":"text","frame":null},{"x":[16436,16467,16495,16526,16556,16587,16617,16648,16679,16709,16740,16770,16801,16832,16861,16892,16922,16953,16983,17014,17045,17075,17106,17136,17167,17198,17226,17257,17287,17318,17348,17379,17410,17440,17471,17501,17532,17563,17591,17622,17652,17683,17713,17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[173.754,120.377,139.346,140.865,124.628,132.279,163.92,151.747,168.087,173.635,153.036,170.604,187.162,138.607,157.059,151.934,137.386,145.401,173.416,162.398,180.613,186.846,166.368,178.957,195.291,134.822,152.971,169.924,142.575,148.03,182.71,163.34,178.563,193.076,169.135,182.153,204.227,138.448,162.317,170.689,145.334,152.22,189.036,174.78,179.224,187.145,173.113,184.227,206.458,141.685,158.45,185.845,148.536,154.908,193.023],"text":["date: 2015-01-01<br />pax/1000: 173.75400<br />model: ACTUAL","date: 2015-02-01<br />pax/1000: 120.37700<br />model: ACTUAL","date: 2015-03-01<br />pax/1000: 139.34600<br />model: ACTUAL","date: 2015-04-01<br />pax/1000: 140.86500<br />model: ACTUAL","date: 2015-05-01<br />pax/1000: 124.62800<br />model: ACTUAL","date: 2015-06-01<br />pax/1000: 132.27900<br />model: ACTUAL","date: 2015-07-01<br />pax/1000: 163.92000<br />model: ACTUAL","date: 2015-08-01<br />pax/1000: 151.74700<br />model: ACTUAL","date: 2015-09-01<br />pax/1000: 168.08700<br />model: ACTUAL","date: 2015-10-01<br />pax/1000: 173.63500<br />model: ACTUAL","date: 2015-11-01<br />pax/1000: 153.03600<br />model: ACTUAL","date: 2015-12-01<br />pax/1000: 170.60400<br />model: ACTUAL","date: 2016-01-01<br />pax/1000: 187.16200<br />model: ACTUAL","date: 2016-02-01<br />pax/1000: 138.60700<br />model: ACTUAL","date: 2016-03-01<br />pax/1000: 157.05900<br />model: ACTUAL","date: 2016-04-01<br />pax/1000: 151.93400<br />model: ACTUAL","date: 2016-05-01<br />pax/1000: 137.38600<br />model: ACTUAL","date: 2016-06-01<br />pax/1000: 145.40100<br />model: ACTUAL","date: 2016-07-01<br />pax/1000: 173.41600<br />model: ACTUAL","date: 2016-08-01<br />pax/1000: 162.39800<br />model: ACTUAL","date: 2016-09-01<br />pax/1000: 180.61300<br />model: ACTUAL","date: 2016-10-01<br />pax/1000: 186.84600<br />model: ACTUAL","date: 2016-11-01<br />pax/1000: 166.36800<br />model: ACTUAL","date: 2016-12-01<br />pax/1000: 178.95700<br />model: ACTUAL","date: 2017-01-01<br />pax/1000: 195.29100<br />model: ACTUAL","date: 2017-02-01<br />pax/1000: 134.82200<br />model: ACTUAL","date: 2017-03-01<br />pax/1000: 152.97100<br />model: ACTUAL","date: 2017-04-01<br />pax/1000: 169.92400<br />model: ACTUAL","date: 2017-05-01<br />pax/1000: 142.57500<br />model: ACTUAL","date: 2017-06-01<br />pax/1000: 148.03000<br />model: ACTUAL","date: 2017-07-01<br />pax/1000: 182.71000<br />model: ACTUAL","date: 2017-08-01<br />pax/1000: 163.34000<br />model: ACTUAL","date: 2017-09-01<br />pax/1000: 178.56300<br />model: ACTUAL","date: 2017-10-01<br />pax/1000: 193.07600<br />model: ACTUAL","date: 2017-11-01<br />pax/1000: 169.13500<br />model: ACTUAL","date: 2017-12-01<br />pax/1000: 182.15300<br />model: ACTUAL","date: 2018-01-01<br />pax/1000: 204.22700<br />model: ACTUAL","date: 2018-02-01<br />pax/1000: 138.44800<br />model: ACTUAL","date: 2018-03-01<br />pax/1000: 162.31700<br />model: ACTUAL","date: 2018-04-01<br />pax/1000: 170.68900<br />model: ACTUAL","date: 2018-05-01<br />pax/1000: 145.33400<br />model: ACTUAL","date: 2018-06-01<br />pax/1000: 152.22000<br />model: ACTUAL","date: 2018-07-01<br />pax/1000: 189.03600<br />model: ACTUAL","date: 2018-08-01<br />pax/1000: 174.78000<br />model: ACTUAL","date: 2018-09-01<br />pax/1000: 179.22400<br />model: ACTUAL","date: 2018-10-01<br />pax/1000: 187.14500<br />model: ACTUAL","date: 2018-11-01<br />pax/1000: 173.11300<br />model: ACTUAL","date: 2018-12-01<br />pax/1000: 184.22700<br />model: ACTUAL","date: 2019-01-01<br />pax/1000: 206.45800<br />model: ACTUAL","date: 2019-02-01<br />pax/1000: 141.68500<br />model: ACTUAL","date: 2019-03-01<br />pax/1000: 158.45000<br />model: ACTUAL","date: 2019-04-01<br />pax/1000: 185.84500<br />model: ACTUAL","date: 2019-05-01<br />pax/1000: 148.53600<br />model: ACTUAL","date: 2019-06-01<br />pax/1000: 154.90800<br />model: ACTUAL","date: 2019-07-01<br />pax/1000: 193.02300<br />model: ACTUAL"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"ACTUAL","legendgroup":"ACTUAL","showlegend":false,"xaxis":"x7","yaxis":"y7","hoverinfo":"text","frame":null},{"x":[16436,16467,16495,16526,16556,16587,16617,16648,16679,16709,16740,16770,16801,16832,16861,16892,16922,16953,16983,17014,17045,17075,17106,17136,17167,17198,17226,17257,17287,17318,17348,17379,17410,17440,17471,17501,17532,17563,17591,17622,17652,17683,17713,17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[190.959,155.901,182.408,184.53,163.491,154.762,197.992,166.218,168.691,200.241,177.829,195.839,189.061,158.809,183.702,173.225,154.799,155.588,176.408,158.468,169.341,182.839,172.279,198.392,192.229,145.066,171.856,175.969,155.88,149.339,177.484,155.78,161,180.013,175.94,192.686,190.757,148.619,179.204,178.163,164.284,153.915,183.462,164.205,186.178,188.916,180.695,194.835,191.992,154.799,175.437,180.883,160.239,154.069,184.545],"text":["date: 2015-01-01<br />pax/1000: 190.95900<br />model: ACTUAL","date: 2015-02-01<br />pax/1000: 155.90100<br />model: ACTUAL","date: 2015-03-01<br />pax/1000: 182.40800<br />model: ACTUAL","date: 2015-04-01<br />pax/1000: 184.53000<br />model: ACTUAL","date: 2015-05-01<br />pax/1000: 163.49100<br />model: ACTUAL","date: 2015-06-01<br />pax/1000: 154.76200<br />model: ACTUAL","date: 2015-07-01<br />pax/1000: 197.99200<br />model: ACTUAL","date: 2015-08-01<br />pax/1000: 166.21800<br />model: ACTUAL","date: 2015-09-01<br />pax/1000: 168.69100<br />model: ACTUAL","date: 2015-10-01<br />pax/1000: 200.24100<br />model: ACTUAL","date: 2015-11-01<br />pax/1000: 177.82900<br />model: ACTUAL","date: 2015-12-01<br />pax/1000: 195.83900<br />model: ACTUAL","date: 2016-01-01<br />pax/1000: 189.06100<br />model: ACTUAL","date: 2016-02-01<br />pax/1000: 158.80900<br />model: ACTUAL","date: 2016-03-01<br />pax/1000: 183.70200<br />model: ACTUAL","date: 2016-04-01<br />pax/1000: 173.22500<br />model: ACTUAL","date: 2016-05-01<br />pax/1000: 154.79900<br />model: ACTUAL","date: 2016-06-01<br />pax/1000: 155.58800<br />model: ACTUAL","date: 2016-07-01<br />pax/1000: 176.40800<br />model: ACTUAL","date: 2016-08-01<br />pax/1000: 158.46800<br />model: ACTUAL","date: 2016-09-01<br />pax/1000: 169.34100<br />model: ACTUAL","date: 2016-10-01<br />pax/1000: 182.83900<br />model: ACTUAL","date: 2016-11-01<br />pax/1000: 172.27900<br />model: ACTUAL","date: 2016-12-01<br />pax/1000: 198.39200<br />model: ACTUAL","date: 2017-01-01<br />pax/1000: 192.22900<br />model: ACTUAL","date: 2017-02-01<br />pax/1000: 145.06600<br />model: ACTUAL","date: 2017-03-01<br />pax/1000: 171.85600<br />model: ACTUAL","date: 2017-04-01<br />pax/1000: 175.96900<br />model: ACTUAL","date: 2017-05-01<br />pax/1000: 155.88000<br />model: ACTUAL","date: 2017-06-01<br />pax/1000: 149.33900<br />model: ACTUAL","date: 2017-07-01<br />pax/1000: 177.48400<br />model: ACTUAL","date: 2017-08-01<br />pax/1000: 155.78000<br />model: ACTUAL","date: 2017-09-01<br />pax/1000: 161.00000<br />model: ACTUAL","date: 2017-10-01<br />pax/1000: 180.01300<br />model: ACTUAL","date: 2017-11-01<br />pax/1000: 175.94000<br />model: ACTUAL","date: 2017-12-01<br />pax/1000: 192.68600<br />model: ACTUAL","date: 2018-01-01<br />pax/1000: 190.75700<br />model: ACTUAL","date: 2018-02-01<br />pax/1000: 148.61900<br />model: ACTUAL","date: 2018-03-01<br />pax/1000: 179.20400<br />model: ACTUAL","date: 2018-04-01<br />pax/1000: 178.16300<br />model: ACTUAL","date: 2018-05-01<br />pax/1000: 164.28400<br />model: ACTUAL","date: 2018-06-01<br />pax/1000: 153.91500<br />model: ACTUAL","date: 2018-07-01<br />pax/1000: 183.46200<br />model: ACTUAL","date: 2018-08-01<br />pax/1000: 164.20500<br />model: ACTUAL","date: 2018-09-01<br />pax/1000: 186.17800<br />model: ACTUAL","date: 2018-10-01<br />pax/1000: 188.91600<br />model: ACTUAL","date: 2018-11-01<br />pax/1000: 180.69500<br />model: ACTUAL","date: 2018-12-01<br />pax/1000: 194.83500<br />model: ACTUAL","date: 2019-01-01<br />pax/1000: 191.99200<br />model: ACTUAL","date: 2019-02-01<br />pax/1000: 154.79900<br />model: ACTUAL","date: 2019-03-01<br />pax/1000: 175.43700<br />model: ACTUAL","date: 2019-04-01<br />pax/1000: 180.88300<br />model: ACTUAL","date: 2019-05-01<br />pax/1000: 160.23900<br />model: ACTUAL","date: 2019-06-01<br />pax/1000: 154.06900<br />model: ACTUAL","date: 2019-07-01<br />pax/1000: 184.54500<br />model: ACTUAL"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"ACTUAL","legendgroup":"ACTUAL","showlegend":false,"xaxis":"x8","yaxis":"y8","hoverinfo":"text","frame":null},{"x":[16436,16467,16495,16526,16556,16587,16617,16648,16679,16709,16740,16770,16801,16832,16861,16892,16922,16953,16983,17014,17045,17075,17106,17136,17167,17198,17226,17257,17287,17318,17348,17379,17410,17440,17471,17501,17532,17563,17591,17622,17652,17683,17713,17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[663.488,695.373000000001,768.124,688.146,696.844,662.01,752.993,714.015,706.021999999999,767.17,765.87,733.117,698.603,743.202000000001,775.147999999999,724.216,725.447,690.168,754.217999999999,739.254,749.395999999999,775.717,797.669,731.634000000001,709.466999999999,713.450000000001,804.598,727.051,750.576,721.462000000001,771.829000000001,753.958,742.212,810.784000000001,834.347,757.605,742.788,747.641,827.636,765.782,759.895,725.666999999999,774.864,782.223999999999,739.653,821.285,805.760000000001,746.815,753.124,744.375000000001,816.417,741.922,768.109,701.647999999999,758.311],"text":["date: 2015-01-01<br />pax/1000: 663.48800<br />model: ACTUAL","date: 2015-02-01<br />pax/1000: 695.37300<br />model: ACTUAL","date: 2015-03-01<br />pax/1000: 768.12400<br />model: ACTUAL","date: 2015-04-01<br />pax/1000: 688.14600<br />model: ACTUAL","date: 2015-05-01<br />pax/1000: 696.84400<br />model: ACTUAL","date: 2015-06-01<br />pax/1000: 662.01000<br />model: ACTUAL","date: 2015-07-01<br />pax/1000: 752.99300<br />model: ACTUAL","date: 2015-08-01<br />pax/1000: 714.01500<br />model: ACTUAL","date: 2015-09-01<br />pax/1000: 706.02200<br />model: ACTUAL","date: 2015-10-01<br />pax/1000: 767.17000<br />model: ACTUAL","date: 2015-11-01<br />pax/1000: 765.87000<br />model: ACTUAL","date: 2015-12-01<br />pax/1000: 733.11700<br />model: ACTUAL","date: 2016-01-01<br />pax/1000: 698.60300<br />model: ACTUAL","date: 2016-02-01<br />pax/1000: 743.20200<br />model: ACTUAL","date: 2016-03-01<br />pax/1000: 775.14800<br />model: ACTUAL","date: 2016-04-01<br />pax/1000: 724.21600<br />model: ACTUAL","date: 2016-05-01<br />pax/1000: 725.44700<br />model: ACTUAL","date: 2016-06-01<br />pax/1000: 690.16800<br />model: ACTUAL","date: 2016-07-01<br />pax/1000: 754.21800<br />model: ACTUAL","date: 2016-08-01<br />pax/1000: 739.25400<br />model: ACTUAL","date: 2016-09-01<br />pax/1000: 749.39600<br />model: ACTUAL","date: 2016-10-01<br />pax/1000: 775.71700<br />model: ACTUAL","date: 2016-11-01<br />pax/1000: 797.66900<br />model: ACTUAL","date: 2016-12-01<br />pax/1000: 731.63400<br />model: ACTUAL","date: 2017-01-01<br />pax/1000: 709.46700<br />model: ACTUAL","date: 2017-02-01<br />pax/1000: 713.45000<br />model: ACTUAL","date: 2017-03-01<br />pax/1000: 804.59800<br />model: ACTUAL","date: 2017-04-01<br />pax/1000: 727.05100<br />model: ACTUAL","date: 2017-05-01<br />pax/1000: 750.57600<br />model: ACTUAL","date: 2017-06-01<br />pax/1000: 721.46200<br />model: ACTUAL","date: 2017-07-01<br />pax/1000: 771.82900<br />model: ACTUAL","date: 2017-08-01<br />pax/1000: 753.95800<br />model: ACTUAL","date: 2017-09-01<br />pax/1000: 742.21200<br />model: ACTUAL","date: 2017-10-01<br />pax/1000: 810.78400<br />model: ACTUAL","date: 2017-11-01<br />pax/1000: 834.34700<br />model: ACTUAL","date: 2017-12-01<br />pax/1000: 757.60500<br />model: ACTUAL","date: 2018-01-01<br />pax/1000: 742.78800<br />model: ACTUAL","date: 2018-02-01<br />pax/1000: 747.64100<br />model: ACTUAL","date: 2018-03-01<br />pax/1000: 827.63600<br />model: ACTUAL","date: 2018-04-01<br />pax/1000: 765.78200<br />model: ACTUAL","date: 2018-05-01<br />pax/1000: 759.89500<br />model: ACTUAL","date: 2018-06-01<br />pax/1000: 725.66700<br />model: ACTUAL","date: 2018-07-01<br />pax/1000: 774.86400<br />model: ACTUAL","date: 2018-08-01<br />pax/1000: 782.22400<br />model: ACTUAL","date: 2018-09-01<br />pax/1000: 739.65300<br />model: ACTUAL","date: 2018-10-01<br />pax/1000: 821.28500<br />model: ACTUAL","date: 2018-11-01<br />pax/1000: 805.76000<br />model: ACTUAL","date: 2018-12-01<br />pax/1000: 746.81500<br />model: ACTUAL","date: 2019-01-01<br />pax/1000: 753.12400<br />model: ACTUAL","date: 2019-02-01<br />pax/1000: 744.37500<br />model: ACTUAL","date: 2019-03-01<br />pax/1000: 816.41700<br />model: ACTUAL","date: 2019-04-01<br />pax/1000: 741.92200<br />model: ACTUAL","date: 2019-05-01<br />pax/1000: 768.10900<br />model: ACTUAL","date: 2019-06-01<br />pax/1000: 701.64800<br />model: ACTUAL","date: 2019-07-01<br />pax/1000: 758.31100<br />model: ACTUAL"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"ACTUAL","legendgroup":"ACTUAL","showlegend":false,"xaxis":"x9","yaxis":"y9","hoverinfo":"text","frame":null},{"x":[16436,16467,16495,16526,16556,16587,16617,16648,16679,16709,16740,16770,16801,16832,16861,16892,16922,16953,16983,17014,17045,17075,17106,17136,17167,17198,17226,17257,17287,17318,17348,17379,17410,17440,17471,17501,17532,17563,17591,17622,17652,17683,17713,17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[159.103,130.374,151.948,151.306,134.755,129.313,152.88,140.321,143.623,153.809,150.015,163.577,157.382,134.203,152.013,148.441,135.056,128.71,149.628,137.093,149.424,151.974,146.942,162.829,157.653,128.175,144.744,147.281,135.251,126.758,146.716,134.287,139.425,150.133,146.107,159.947,153.25,128.167,149.388,148.212,136.706,127.609,147.397,133.054,141.228,151.269,148.387,152.244,151.523,124.387,140.867,142.36,133.04,124.608,147.114],"text":["date: 2015-01-01<br />pax/1000: 159.10300<br />model: ACTUAL","date: 2015-02-01<br />pax/1000: 130.37400<br />model: ACTUAL","date: 2015-03-01<br />pax/1000: 151.94800<br />model: ACTUAL","date: 2015-04-01<br />pax/1000: 151.30600<br />model: ACTUAL","date: 2015-05-01<br />pax/1000: 134.75500<br />model: ACTUAL","date: 2015-06-01<br />pax/1000: 129.31300<br />model: ACTUAL","date: 2015-07-01<br />pax/1000: 152.88000<br />model: ACTUAL","date: 2015-08-01<br />pax/1000: 140.32100<br />model: ACTUAL","date: 2015-09-01<br />pax/1000: 143.62300<br />model: ACTUAL","date: 2015-10-01<br />pax/1000: 153.80900<br />model: ACTUAL","date: 2015-11-01<br />pax/1000: 150.01500<br />model: ACTUAL","date: 2015-12-01<br />pax/1000: 163.57700<br />model: ACTUAL","date: 2016-01-01<br />pax/1000: 157.38200<br />model: ACTUAL","date: 2016-02-01<br />pax/1000: 134.20300<br />model: ACTUAL","date: 2016-03-01<br />pax/1000: 152.01300<br />model: ACTUAL","date: 2016-04-01<br />pax/1000: 148.44100<br />model: ACTUAL","date: 2016-05-01<br />pax/1000: 135.05600<br />model: ACTUAL","date: 2016-06-01<br />pax/1000: 128.71000<br />model: ACTUAL","date: 2016-07-01<br />pax/1000: 149.62800<br />model: ACTUAL","date: 2016-08-01<br />pax/1000: 137.09300<br />model: ACTUAL","date: 2016-09-01<br />pax/1000: 149.42400<br />model: ACTUAL","date: 2016-10-01<br />pax/1000: 151.97400<br />model: ACTUAL","date: 2016-11-01<br />pax/1000: 146.94200<br />model: ACTUAL","date: 2016-12-01<br />pax/1000: 162.82900<br />model: ACTUAL","date: 2017-01-01<br />pax/1000: 157.65300<br />model: ACTUAL","date: 2017-02-01<br />pax/1000: 128.17500<br />model: ACTUAL","date: 2017-03-01<br />pax/1000: 144.74400<br />model: ACTUAL","date: 2017-04-01<br />pax/1000: 147.28100<br />model: ACTUAL","date: 2017-05-01<br />pax/1000: 135.25100<br />model: ACTUAL","date: 2017-06-01<br />pax/1000: 126.75800<br />model: ACTUAL","date: 2017-07-01<br />pax/1000: 146.71600<br />model: ACTUAL","date: 2017-08-01<br />pax/1000: 134.28700<br />model: ACTUAL","date: 2017-09-01<br />pax/1000: 139.42500<br />model: ACTUAL","date: 2017-10-01<br />pax/1000: 150.13300<br />model: ACTUAL","date: 2017-11-01<br />pax/1000: 146.10700<br />model: ACTUAL","date: 2017-12-01<br />pax/1000: 159.94700<br />model: ACTUAL","date: 2018-01-01<br />pax/1000: 153.25000<br />model: ACTUAL","date: 2018-02-01<br />pax/1000: 128.16700<br />model: ACTUAL","date: 2018-03-01<br />pax/1000: 149.38800<br />model: ACTUAL","date: 2018-04-01<br />pax/1000: 148.21200<br />model: ACTUAL","date: 2018-05-01<br />pax/1000: 136.70600<br />model: ACTUAL","date: 2018-06-01<br />pax/1000: 127.60900<br />model: ACTUAL","date: 2018-07-01<br />pax/1000: 147.39700<br />model: ACTUAL","date: 2018-08-01<br />pax/1000: 133.05400<br />model: ACTUAL","date: 2018-09-01<br />pax/1000: 141.22800<br />model: ACTUAL","date: 2018-10-01<br />pax/1000: 151.26900<br />model: ACTUAL","date: 2018-11-01<br />pax/1000: 148.38700<br />model: ACTUAL","date: 2018-12-01<br />pax/1000: 152.24400<br />model: ACTUAL","date: 2019-01-01<br />pax/1000: 151.52300<br />model: ACTUAL","date: 2019-02-01<br />pax/1000: 124.38700<br />model: ACTUAL","date: 2019-03-01<br />pax/1000: 140.86700<br />model: ACTUAL","date: 2019-04-01<br />pax/1000: 142.36000<br />model: ACTUAL","date: 2019-05-01<br />pax/1000: 133.04000<br />model: ACTUAL","date: 2019-06-01<br />pax/1000: 124.60800<br />model: ACTUAL","date: 2019-07-01<br />pax/1000: 147.11400<br />model: ACTUAL"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"ACTUAL","legendgroup":"ACTUAL","showlegend":false,"xaxis":"x10","yaxis":"y10","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[205.398434501236,205.068472848327,223.742413111954,215.270921978421,215.735631770111,207.741061736157,198.759291218723,229.715922143153,224.147647123912,215.288844693043,203.962043195008,231.34340266934],"text":["date: 2018-08-01<br />pax/1000: 205.39843<br />model: ARIMA","date: 2018-09-01<br />pax/1000: 205.06847<br />model: ARIMA","date: 2018-10-01<br />pax/1000: 223.74241<br />model: ARIMA","date: 2018-11-01<br />pax/1000: 215.27092<br />model: ARIMA","date: 2018-12-01<br />pax/1000: 215.73563<br />model: ARIMA","date: 2019-01-01<br />pax/1000: 207.74106<br />model: ARIMA","date: 2019-02-01<br />pax/1000: 198.75929<br />model: ARIMA","date: 2019-03-01<br />pax/1000: 229.71592<br />model: ARIMA","date: 2019-04-01<br />pax/1000: 224.14765<br />model: ARIMA","date: 2019-05-01<br />pax/1000: 215.28884<br />model: ARIMA","date: 2019-06-01<br />pax/1000: 203.96204<br />model: ARIMA","date: 2019-07-01<br />pax/1000: 231.34340<br />model: ARIMA"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(205,150,0,1)","dash":"solid"},"hoveron":"points","name":"ARIMA","legendgroup":"ARIMA","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[154.17199534681,158.373268951071,177.836986422607,169.689616377978,175.531238006912,170.072272731241,153.907731970582,180.2316631342,175.793767062955,160.380582779506,148.858618985911,172.420983599443],"text":["date: 2018-08-01<br />pax/1000: 154.17200<br />model: ARIMA","date: 2018-09-01<br />pax/1000: 158.37327<br />model: ARIMA","date: 2018-10-01<br />pax/1000: 177.83699<br />model: ARIMA","date: 2018-11-01<br />pax/1000: 169.68962<br />model: ARIMA","date: 2018-12-01<br />pax/1000: 175.53124<br />model: ARIMA","date: 2019-01-01<br />pax/1000: 170.07227<br />model: ARIMA","date: 2019-02-01<br />pax/1000: 153.90773<br />model: ARIMA","date: 2019-03-01<br />pax/1000: 180.23166<br />model: ARIMA","date: 2019-04-01<br />pax/1000: 175.79377<br />model: ARIMA","date: 2019-05-01<br />pax/1000: 160.38058<br />model: ARIMA","date: 2019-06-01<br />pax/1000: 148.85862<br />model: ARIMA","date: 2019-07-01<br />pax/1000: 172.42098<br />model: ARIMA"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(205,150,0,1)","dash":"solid"},"hoveron":"points","name":"ARIMA","legendgroup":"ARIMA","showlegend":false,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[118.682601113349,113.588824168151,118.785328408121,114.378355404782,120.717730205165,111.606971675695,103.004600439116,109.373521408183,111.471886330811,108.090220741064,113.433833396794,132.070194053439],"text":["date: 2018-08-01<br />pax/1000: 118.68260<br />model: ARIMA","date: 2018-09-01<br />pax/1000: 113.58882<br />model: ARIMA","date: 2018-10-01<br />pax/1000: 118.78533<br />model: ARIMA","date: 2018-11-01<br />pax/1000: 114.37836<br />model: ARIMA","date: 2018-12-01<br />pax/1000: 120.71773<br />model: ARIMA","date: 2019-01-01<br />pax/1000: 111.60697<br />model: ARIMA","date: 2019-02-01<br />pax/1000: 103.00460<br />model: ARIMA","date: 2019-03-01<br />pax/1000: 109.37352<br />model: ARIMA","date: 2019-04-01<br />pax/1000: 111.47189<br />model: ARIMA","date: 2019-05-01<br />pax/1000: 108.09022<br />model: ARIMA","date: 2019-06-01<br />pax/1000: 113.43383<br />model: ARIMA","date: 2019-07-01<br />pax/1000: 132.07019<br />model: ARIMA"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(205,150,0,1)","dash":"solid"},"hoveron":"points","name":"ARIMA","legendgroup":"ARIMA","showlegend":false,"xaxis":"x3","yaxis":"y3","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[310.355546137299,321.269298641546,339.41988299287,320.289400921245,325.199580508293,309.300232838952,262.447275389911,308.555738360374,302.5977845416,289.945747906123,294.467511713402,343.162863497032],"text":["date: 2018-08-01<br />pax/1000: 310.35555<br />model: ARIMA","date: 2018-09-01<br />pax/1000: 321.26930<br />model: ARIMA","date: 2018-10-01<br />pax/1000: 339.41988<br />model: ARIMA","date: 2018-11-01<br />pax/1000: 320.28940<br />model: ARIMA","date: 2018-12-01<br />pax/1000: 325.19958<br />model: ARIMA","date: 2019-01-01<br />pax/1000: 309.30023<br />model: ARIMA","date: 2019-02-01<br />pax/1000: 262.44728<br />model: ARIMA","date: 2019-03-01<br />pax/1000: 308.55574<br />model: ARIMA","date: 2019-04-01<br />pax/1000: 302.59778<br />model: ARIMA","date: 2019-05-01<br />pax/1000: 289.94575<br />model: ARIMA","date: 2019-06-01<br />pax/1000: 294.46751<br />model: ARIMA","date: 2019-07-01<br />pax/1000: 343.16286<br />model: ARIMA"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(205,150,0,1)","dash":"solid"},"hoveron":"points","name":"ARIMA","legendgroup":"ARIMA","showlegend":false,"xaxis":"x4","yaxis":"y4","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[412.148636826249,414.347253186278,431.854202828455,418.00574262616,423.234455378119,377.021513025446,368.800186546586,414.28935658687,399.491624370532,396.354577586516,387.533756401914,437.597518595295],"text":["date: 2018-08-01<br />pax/1000: 412.14864<br />model: ARIMA","date: 2018-09-01<br />pax/1000: 414.34725<br />model: ARIMA","date: 2018-10-01<br />pax/1000: 431.85420<br />model: ARIMA","date: 2018-11-01<br />pax/1000: 418.00574<br />model: ARIMA","date: 2018-12-01<br />pax/1000: 423.23446<br />model: ARIMA","date: 2019-01-01<br />pax/1000: 377.02151<br />model: ARIMA","date: 2019-02-01<br />pax/1000: 368.80019<br />model: ARIMA","date: 2019-03-01<br />pax/1000: 414.28936<br />model: ARIMA","date: 2019-04-01<br />pax/1000: 399.49162<br />model: ARIMA","date: 2019-05-01<br />pax/1000: 396.35458<br />model: ARIMA","date: 2019-06-01<br />pax/1000: 387.53376<br />model: ARIMA","date: 2019-07-01<br />pax/1000: 437.59752<br />model: ARIMA"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(205,150,0,1)","dash":"solid"},"hoveron":"points","name":"ARIMA","legendgroup":"ARIMA","showlegend":false,"xaxis":"x5","yaxis":"y5","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[203.843519042086,227.289685009954,243.695750466554,228.152940322656,246.577386358331,266.447316133048,210.17187400503,226.50922953875,232.998021456622,203.159140895449,195.550664823154,233.12046859355],"text":["date: 2018-08-01<br />pax/1000: 203.84352<br />model: ARIMA","date: 2018-09-01<br />pax/1000: 227.28969<br />model: ARIMA","date: 2018-10-01<br />pax/1000: 243.69575<br />model: ARIMA","date: 2018-11-01<br />pax/1000: 228.15294<br />model: ARIMA","date: 2018-12-01<br />pax/1000: 246.57739<br />model: ARIMA","date: 2019-01-01<br />pax/1000: 266.44732<br />model: ARIMA","date: 2019-02-01<br />pax/1000: 210.17187<br />model: ARIMA","date: 2019-03-01<br />pax/1000: 226.50923<br />model: ARIMA","date: 2019-04-01<br />pax/1000: 232.99802<br />model: ARIMA","date: 2019-05-01<br />pax/1000: 203.15914<br />model: ARIMA","date: 2019-06-01<br />pax/1000: 195.55066<br />model: ARIMA","date: 2019-07-01<br />pax/1000: 233.12047<br />model: ARIMA"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(205,150,0,1)","dash":"solid"},"hoveron":"points","name":"ARIMA","legendgroup":"ARIMA","showlegend":false,"xaxis":"x6","yaxis":"y6","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[173.350172464127,191.84782056448,201.194727486313,178.097202078699,193.553430844121,212.602246319828,149.290109667648,170.414775422789,179.743730401716,154.642204932611,161.752507311658,197.871282442619],"text":["date: 2018-08-01<br />pax/1000: 173.35017<br />model: ARIMA","date: 2018-09-01<br />pax/1000: 191.84782<br />model: ARIMA","date: 2018-10-01<br />pax/1000: 201.19473<br />model: ARIMA","date: 2018-11-01<br />pax/1000: 178.09720<br />model: ARIMA","date: 2018-12-01<br />pax/1000: 193.55343<br />model: ARIMA","date: 2019-01-01<br />pax/1000: 212.60225<br />model: ARIMA","date: 2019-02-01<br />pax/1000: 149.29011<br />model: ARIMA","date: 2019-03-01<br />pax/1000: 170.41478<br />model: ARIMA","date: 2019-04-01<br />pax/1000: 179.74373<br />model: ARIMA","date: 2019-05-01<br />pax/1000: 154.64220<br />model: ARIMA","date: 2019-06-01<br />pax/1000: 161.75251<br />model: ARIMA","date: 2019-07-01<br />pax/1000: 197.87128<br />model: ARIMA"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(205,150,0,1)","dash":"solid"},"hoveron":"points","name":"ARIMA","legendgroup":"ARIMA","showlegend":false,"xaxis":"x7","yaxis":"y7","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[165.400652659054,170.288382005891,188.334267612221,176.867565098814,195.026477342858,193.68755472861,155.753909255688,183.141452077275,182.861042027458,164.474141368163,159.387892022181,187.314613990086],"text":["date: 2018-08-01<br />pax/1000: 165.40065<br />model: ARIMA","date: 2018-09-01<br />pax/1000: 170.28838<br />model: ARIMA","date: 2018-10-01<br />pax/1000: 188.33427<br />model: ARIMA","date: 2018-11-01<br />pax/1000: 176.86757<br />model: ARIMA","date: 2018-12-01<br />pax/1000: 195.02648<br />model: ARIMA","date: 2019-01-01<br />pax/1000: 193.68755<br />model: ARIMA","date: 2019-02-01<br />pax/1000: 155.75391<br />model: ARIMA","date: 2019-03-01<br />pax/1000: 183.14145<br />model: ARIMA","date: 2019-04-01<br />pax/1000: 182.86104<br />model: ARIMA","date: 2019-05-01<br />pax/1000: 164.47414<br />model: ARIMA","date: 2019-06-01<br />pax/1000: 159.38789<br />model: ARIMA","date: 2019-07-01<br />pax/1000: 187.31461<br />model: ARIMA"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(205,150,0,1)","dash":"solid"},"hoveron":"points","name":"ARIMA","legendgroup":"ARIMA","showlegend":false,"xaxis":"x8","yaxis":"y8","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[762.656058158211,756.881487867865,818.666717047121,838.53759354884,773.86012637282,754.411114117429,770.854420196288,847.758300749856,784.839820208946,788.853578850192,755.810272545945,813.677581917259],"text":["date: 2018-08-01<br />pax/1000: 762.65606<br />model: ARIMA","date: 2018-09-01<br />pax/1000: 756.88149<br />model: ARIMA","date: 2018-10-01<br />pax/1000: 818.66672<br />model: ARIMA","date: 2018-11-01<br />pax/1000: 838.53759<br />model: ARIMA","date: 2018-12-01<br />pax/1000: 773.86013<br />model: ARIMA","date: 2019-01-01<br />pax/1000: 754.41111<br />model: ARIMA","date: 2019-02-01<br />pax/1000: 770.85442<br />model: ARIMA","date: 2019-03-01<br />pax/1000: 847.75830<br />model: ARIMA","date: 2019-04-01<br />pax/1000: 784.83982<br />model: ARIMA","date: 2019-05-01<br />pax/1000: 788.85358<br />model: ARIMA","date: 2019-06-01<br />pax/1000: 755.81027<br />model: ARIMA","date: 2019-07-01<br />pax/1000: 813.67758<br />model: ARIMA"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(205,150,0,1)","dash":"solid"},"hoveron":"points","name":"ARIMA","legendgroup":"ARIMA","showlegend":false,"xaxis":"x9","yaxis":"y9","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[136.857007315161,143.257389290397,154.084685981601,146.907904296436,160.659841549798,156.213769490595,130.326380797968,148.825866573041,148.523323523196,135.468970465018,127.170211331941,148.286131094279],"text":["date: 2018-08-01<br />pax/1000: 136.85701<br />model: ARIMA","date: 2018-09-01<br />pax/1000: 143.25739<br />model: ARIMA","date: 2018-10-01<br />pax/1000: 154.08469<br />model: ARIMA","date: 2018-11-01<br />pax/1000: 146.90790<br />model: ARIMA","date: 2018-12-01<br />pax/1000: 160.65984<br />model: ARIMA","date: 2019-01-01<br />pax/1000: 156.21377<br />model: ARIMA","date: 2019-02-01<br />pax/1000: 130.32638<br />model: ARIMA","date: 2019-03-01<br />pax/1000: 148.82587<br />model: ARIMA","date: 2019-04-01<br />pax/1000: 148.52332<br />model: ARIMA","date: 2019-05-01<br />pax/1000: 135.46897<br />model: ARIMA","date: 2019-06-01<br />pax/1000: 127.17021<br />model: ARIMA","date: 2019-07-01<br />pax/1000: 148.28613<br />model: ARIMA"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(205,150,0,1)","dash":"solid"},"hoveron":"points","name":"ARIMA","legendgroup":"ARIMA","showlegend":false,"xaxis":"x10","yaxis":"y10","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[196.428650421496,199.200439243515,210.594690267646,207.056300316272,202.733609597292,199.50587466408,189.609169199157,213.458319684274,211.533288219703,200.41872621622,194.36068662776,215.659651836848],"text":["date: 2018-08-01<br />pax/1000: 196.42865<br />model: KERNLAB","date: 2018-09-01<br />pax/1000: 199.20044<br />model: KERNLAB","date: 2018-10-01<br />pax/1000: 210.59469<br />model: KERNLAB","date: 2018-11-01<br />pax/1000: 207.05630<br />model: KERNLAB","date: 2018-12-01<br />pax/1000: 202.73361<br />model: KERNLAB","date: 2019-01-01<br />pax/1000: 199.50587<br />model: KERNLAB","date: 2019-02-01<br />pax/1000: 189.60917<br />model: KERNLAB","date: 2019-03-01<br />pax/1000: 213.45832<br />model: KERNLAB","date: 2019-04-01<br />pax/1000: 211.53329<br />model: KERNLAB","date: 2019-05-01<br />pax/1000: 200.41873<br />model: KERNLAB","date: 2019-06-01<br />pax/1000: 194.36069<br />model: KERNLAB","date: 2019-07-01<br />pax/1000: 215.65965<br />model: KERNLAB"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(124,174,0,1)","dash":"solid"},"hoveron":"points","name":"KERNLAB","legendgroup":"KERNLAB","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[150.542839121131,154.691121808231,168.167031741497,165.414501199139,168.557739022765,165.4835458812,150.963292697906,170.936699898806,164.9002991468,154.878720336907,143.946288913469,160.330974206479],"text":["date: 2018-08-01<br />pax/1000: 150.54284<br />model: KERNLAB","date: 2018-09-01<br />pax/1000: 154.69112<br />model: KERNLAB","date: 2018-10-01<br />pax/1000: 168.16703<br />model: KERNLAB","date: 2018-11-01<br />pax/1000: 165.41450<br />model: KERNLAB","date: 2018-12-01<br />pax/1000: 168.55774<br />model: KERNLAB","date: 2019-01-01<br />pax/1000: 165.48355<br />model: KERNLAB","date: 2019-02-01<br />pax/1000: 150.96329<br />model: KERNLAB","date: 2019-03-01<br />pax/1000: 170.93670<br />model: KERNLAB","date: 2019-04-01<br />pax/1000: 164.90030<br />model: KERNLAB","date: 2019-05-01<br />pax/1000: 154.87872<br />model: KERNLAB","date: 2019-06-01<br />pax/1000: 143.94629<br />model: KERNLAB","date: 2019-07-01<br />pax/1000: 160.33097<br />model: KERNLAB"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(124,174,0,1)","dash":"solid"},"hoveron":"points","name":"KERNLAB","legendgroup":"KERNLAB","showlegend":false,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[119.265495910865,117.127868886613,121.127478686251,117.536721866375,119.931046179088,113.335580543461,105.659047500548,108.435233845877,111.715865534482,108.128900790266,108.560439796924,125.484451231294],"text":["date: 2018-08-01<br />pax/1000: 119.26550<br />model: KERNLAB","date: 2018-09-01<br />pax/1000: 117.12787<br />model: KERNLAB","date: 2018-10-01<br />pax/1000: 121.12748<br />model: KERNLAB","date: 2018-11-01<br />pax/1000: 117.53672<br />model: KERNLAB","date: 2018-12-01<br />pax/1000: 119.93105<br />model: KERNLAB","date: 2019-01-01<br />pax/1000: 113.33558<br />model: KERNLAB","date: 2019-02-01<br />pax/1000: 105.65905<br />model: KERNLAB","date: 2019-03-01<br />pax/1000: 108.43523<br />model: KERNLAB","date: 2019-04-01<br />pax/1000: 111.71587<br />model: KERNLAB","date: 2019-05-01<br />pax/1000: 108.12890<br />model: KERNLAB","date: 2019-06-01<br />pax/1000: 108.56044<br />model: KERNLAB","date: 2019-07-01<br />pax/1000: 125.48445<br />model: KERNLAB"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(124,174,0,1)","dash":"solid"},"hoveron":"points","name":"KERNLAB","legendgroup":"KERNLAB","showlegend":false,"xaxis":"x3","yaxis":"y3","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[297.438210371151,306.592113292909,318.873066446512,306.242150263258,311.161074218367,294.298957866873,258.636121433718,292.956557964775,292.433047194305,282.500892598889,285.29580958381,326.775959254133],"text":["date: 2018-08-01<br />pax/1000: 297.43821<br />model: KERNLAB","date: 2018-09-01<br />pax/1000: 306.59211<br />model: KERNLAB","date: 2018-10-01<br />pax/1000: 318.87307<br />model: KERNLAB","date: 2018-11-01<br />pax/1000: 306.24215<br />model: KERNLAB","date: 2018-12-01<br />pax/1000: 311.16107<br />model: KERNLAB","date: 2019-01-01<br />pax/1000: 294.29896<br />model: KERNLAB","date: 2019-02-01<br />pax/1000: 258.63612<br />model: KERNLAB","date: 2019-03-01<br />pax/1000: 292.95656<br />model: KERNLAB","date: 2019-04-01<br />pax/1000: 292.43305<br />model: KERNLAB","date: 2019-05-01<br />pax/1000: 282.50089<br />model: KERNLAB","date: 2019-06-01<br />pax/1000: 285.29581<br />model: KERNLAB","date: 2019-07-01<br />pax/1000: 326.77596<br />model: KERNLAB"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(124,174,0,1)","dash":"solid"},"hoveron":"points","name":"KERNLAB","legendgroup":"KERNLAB","showlegend":false,"xaxis":"x4","yaxis":"y4","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[398.643251523503,402.017020483035,413.968480911059,405.719682173815,411.089893809232,374.413648040003,367.726056815759,404.65701217482,391.236480732055,394.952448874124,387.518630245084,427.743423719988],"text":["date: 2018-08-01<br />pax/1000: 398.64325<br />model: KERNLAB","date: 2018-09-01<br />pax/1000: 402.01702<br />model: KERNLAB","date: 2018-10-01<br />pax/1000: 413.96848<br />model: KERNLAB","date: 2018-11-01<br />pax/1000: 405.71968<br />model: KERNLAB","date: 2018-12-01<br />pax/1000: 411.08989<br />model: KERNLAB","date: 2019-01-01<br />pax/1000: 374.41365<br />model: KERNLAB","date: 2019-02-01<br />pax/1000: 367.72606<br />model: KERNLAB","date: 2019-03-01<br />pax/1000: 404.65701<br />model: KERNLAB","date: 2019-04-01<br />pax/1000: 391.23648<br />model: KERNLAB","date: 2019-05-01<br />pax/1000: 394.95245<br />model: KERNLAB","date: 2019-06-01<br />pax/1000: 387.51863<br />model: KERNLAB","date: 2019-07-01<br />pax/1000: 427.74342<br />model: KERNLAB"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(124,174,0,1)","dash":"solid"},"hoveron":"points","name":"KERNLAB","legendgroup":"KERNLAB","showlegend":false,"xaxis":"x5","yaxis":"y5","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[210.91053870184,223.569998314084,241.198763527774,231.407651102866,244.838908459427,256.54472927846,217.576321189921,226.604847321628,236.892886737931,210.579042216504,201.918857743463,230.805532710798],"text":["date: 2018-08-01<br />pax/1000: 210.91054<br />model: KERNLAB","date: 2018-09-01<br />pax/1000: 223.57000<br />model: KERNLAB","date: 2018-10-01<br />pax/1000: 241.19876<br />model: KERNLAB","date: 2018-11-01<br />pax/1000: 231.40765<br />model: KERNLAB","date: 2018-12-01<br />pax/1000: 244.83891<br />model: KERNLAB","date: 2019-01-01<br />pax/1000: 256.54473<br />model: KERNLAB","date: 2019-02-01<br />pax/1000: 217.57632<br />model: KERNLAB","date: 2019-03-01<br />pax/1000: 226.60485<br />model: KERNLAB","date: 2019-04-01<br />pax/1000: 236.89289<br />model: KERNLAB","date: 2019-05-01<br />pax/1000: 210.57904<br />model: KERNLAB","date: 2019-06-01<br />pax/1000: 201.91886<br />model: KERNLAB","date: 2019-07-01<br />pax/1000: 230.80553<br />model: KERNLAB"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(124,174,0,1)","dash":"solid"},"hoveron":"points","name":"KERNLAB","legendgroup":"KERNLAB","showlegend":false,"xaxis":"x6","yaxis":"y6","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[160.131890428405,172.775357759196,186.147494372729,164.487092332385,174.991419580567,192.171444500109,145.559309535777,157.899308275981,168.935464308909,145.783561400075,147.770200960799,181.666552338685],"text":["date: 2018-08-01<br />pax/1000: 160.13189<br />model: KERNLAB","date: 2018-09-01<br />pax/1000: 172.77536<br />model: KERNLAB","date: 2018-10-01<br />pax/1000: 186.14749<br />model: KERNLAB","date: 2018-11-01<br />pax/1000: 164.48709<br />model: KERNLAB","date: 2018-12-01<br />pax/1000: 174.99142<br />model: KERNLAB","date: 2019-01-01<br />pax/1000: 192.17144<br />model: KERNLAB","date: 2019-02-01<br />pax/1000: 145.55931<br />model: KERNLAB","date: 2019-03-01<br />pax/1000: 157.89931<br />model: KERNLAB","date: 2019-04-01<br />pax/1000: 168.93546<br />model: KERNLAB","date: 2019-05-01<br />pax/1000: 145.78356<br />model: KERNLAB","date: 2019-06-01<br />pax/1000: 147.77020<br />model: KERNLAB","date: 2019-07-01<br />pax/1000: 181.66655<br />model: KERNLAB"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(124,174,0,1)","dash":"solid"},"hoveron":"points","name":"KERNLAB","legendgroup":"KERNLAB","showlegend":false,"xaxis":"x7","yaxis":"y7","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[160.598942635995,163.365189681951,182.150096769463,177.467899003053,190.137733224907,190.283194599182,153.851561648939,175.382246211515,180.23579426808,162.559090751141,156.537949088651,181.600943277392],"text":["date: 2018-08-01<br />pax/1000: 160.59894<br />model: KERNLAB","date: 2018-09-01<br />pax/1000: 163.36519<br />model: KERNLAB","date: 2018-10-01<br />pax/1000: 182.15010<br />model: KERNLAB","date: 2018-11-01<br />pax/1000: 177.46790<br />model: KERNLAB","date: 2018-12-01<br />pax/1000: 190.13773<br />model: KERNLAB","date: 2019-01-01<br />pax/1000: 190.28319<br />model: KERNLAB","date: 2019-02-01<br />pax/1000: 153.85156<br />model: KERNLAB","date: 2019-03-01<br />pax/1000: 175.38225<br />model: KERNLAB","date: 2019-04-01<br />pax/1000: 180.23579<br />model: KERNLAB","date: 2019-05-01<br />pax/1000: 162.55909<br />model: KERNLAB","date: 2019-06-01<br />pax/1000: 156.53795<br />model: KERNLAB","date: 2019-07-01<br />pax/1000: 181.60094<br />model: KERNLAB"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(124,174,0,1)","dash":"solid"},"hoveron":"points","name":"KERNLAB","legendgroup":"KERNLAB","showlegend":false,"xaxis":"x8","yaxis":"y8","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[746.978080937421,757.512409159418,804.802964517554,805.307521645996,758.288426309413,744.701495732253,742.988628101109,814.057470768326,767.20015953072,759.291162770522,731.278963761365,774.089406895794],"text":["date: 2018-08-01<br />pax/1000: 746.97808<br />model: KERNLAB","date: 2018-09-01<br />pax/1000: 757.51241<br />model: KERNLAB","date: 2018-10-01<br />pax/1000: 804.80296<br />model: KERNLAB","date: 2018-11-01<br />pax/1000: 805.30752<br />model: KERNLAB","date: 2018-12-01<br />pax/1000: 758.28843<br />model: KERNLAB","date: 2019-01-01<br />pax/1000: 744.70150<br />model: KERNLAB","date: 2019-02-01<br />pax/1000: 742.98863<br />model: KERNLAB","date: 2019-03-01<br />pax/1000: 814.05747<br />model: KERNLAB","date: 2019-04-01<br />pax/1000: 767.20016<br />model: KERNLAB","date: 2019-05-01<br />pax/1000: 759.29116<br />model: KERNLAB","date: 2019-06-01<br />pax/1000: 731.27896<br />model: KERNLAB","date: 2019-07-01<br />pax/1000: 774.08941<br />model: KERNLAB"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(124,174,0,1)","dash":"solid"},"hoveron":"points","name":"KERNLAB","legendgroup":"KERNLAB","showlegend":false,"xaxis":"x9","yaxis":"y9","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[136.283521298153,142.818102300604,151.971747758596,148.560362396689,158.982997555624,154.764366935218,131.518858495068,146.543598858273,149.152021346462,140.165276391291,130.528980879979,150.022104300274],"text":["date: 2018-08-01<br />pax/1000: 136.28352<br />model: KERNLAB","date: 2018-09-01<br />pax/1000: 142.81810<br />model: KERNLAB","date: 2018-10-01<br />pax/1000: 151.97175<br />model: KERNLAB","date: 2018-11-01<br />pax/1000: 148.56036<br />model: KERNLAB","date: 2018-12-01<br />pax/1000: 158.98300<br />model: KERNLAB","date: 2019-01-01<br />pax/1000: 154.76437<br />model: KERNLAB","date: 2019-02-01<br />pax/1000: 131.51886<br />model: KERNLAB","date: 2019-03-01<br />pax/1000: 146.54360<br />model: KERNLAB","date: 2019-04-01<br />pax/1000: 149.15202<br />model: KERNLAB","date: 2019-05-01<br />pax/1000: 140.16528<br />model: KERNLAB","date: 2019-06-01<br />pax/1000: 130.52898<br />model: KERNLAB","date: 2019-07-01<br />pax/1000: 150.02210<br />model: KERNLAB"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(124,174,0,1)","dash":"solid"},"hoveron":"points","name":"KERNLAB","legendgroup":"KERNLAB","showlegend":false,"xaxis":"x10","yaxis":"y10","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[164.619602693992,164.619602693992,164.619602693992,164.619602693992,164.619602693992,164.619602693992,164.619602693992,164.619602693992,164.619602693992,164.619602693992,164.619602693992,164.619602693992],"text":["date: 2018-08-01<br />pax/1000: 164.61960<br />model: NNET","date: 2018-09-01<br />pax/1000: 164.61960<br />model: NNET","date: 2018-10-01<br />pax/1000: 164.61960<br />model: NNET","date: 2018-11-01<br />pax/1000: 164.61960<br />model: NNET","date: 2018-12-01<br />pax/1000: 164.61960<br />model: NNET","date: 2019-01-01<br />pax/1000: 164.61960<br />model: NNET","date: 2019-02-01<br />pax/1000: 164.61960<br />model: NNET","date: 2019-03-01<br />pax/1000: 164.61960<br />model: NNET","date: 2019-04-01<br />pax/1000: 164.61960<br />model: NNET","date: 2019-05-01<br />pax/1000: 164.61960<br />model: NNET","date: 2019-06-01<br />pax/1000: 164.61960<br />model: NNET","date: 2019-07-01<br />pax/1000: 164.61960<br />model: NNET"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,190,103,1)","dash":"solid"},"hoveron":"points","name":"NNET","legendgroup":"NNET","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[154.759479111265,156.932005944814,168.89750341726,167.670883413437,170.458318606571,168.273609955127,162.194567219675,169.236013954814,167.929517456049,162.376619778935,153.597318794904,162.06843601935],"text":["date: 2018-08-01<br />pax/1000: 154.75948<br />model: NNET","date: 2018-09-01<br />pax/1000: 156.93201<br />model: NNET","date: 2018-10-01<br />pax/1000: 168.89750<br />model: NNET","date: 2018-11-01<br />pax/1000: 167.67088<br />model: NNET","date: 2018-12-01<br />pax/1000: 170.45832<br />model: NNET","date: 2019-01-01<br />pax/1000: 168.27361<br />model: NNET","date: 2019-02-01<br />pax/1000: 162.19457<br />model: NNET","date: 2019-03-01<br />pax/1000: 169.23601<br />model: NNET","date: 2019-04-01<br />pax/1000: 167.92952<br />model: NNET","date: 2019-05-01<br />pax/1000: 162.37662<br />model: NNET","date: 2019-06-01<br />pax/1000: 153.59732<br />model: NNET","date: 2019-07-01<br />pax/1000: 162.06844<br />model: NNET"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,190,103,1)","dash":"solid"},"hoveron":"points","name":"NNET","legendgroup":"NNET","showlegend":false,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[95.1410404410303,95.1410404410303,95.1410404410303,95.1410404410303,95.1410404410303,95.1410404410303,95.1410404410303,95.1410404410303,95.1410404410303,95.1410404410303,95.1410404410303,95.1410404410303],"text":["date: 2018-08-01<br />pax/1000:  95.14104<br />model: NNET","date: 2018-09-01<br />pax/1000:  95.14104<br />model: NNET","date: 2018-10-01<br />pax/1000:  95.14104<br />model: NNET","date: 2018-11-01<br />pax/1000:  95.14104<br />model: NNET","date: 2018-12-01<br />pax/1000:  95.14104<br />model: NNET","date: 2019-01-01<br />pax/1000:  95.14104<br />model: NNET","date: 2019-02-01<br />pax/1000:  95.14104<br />model: NNET","date: 2019-03-01<br />pax/1000:  95.14104<br />model: NNET","date: 2019-04-01<br />pax/1000:  95.14104<br />model: NNET","date: 2019-05-01<br />pax/1000:  95.14104<br />model: NNET","date: 2019-06-01<br />pax/1000:  95.14104<br />model: NNET","date: 2019-07-01<br />pax/1000:  95.14104<br />model: NNET"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,190,103,1)","dash":"solid"},"hoveron":"points","name":"NNET","legendgroup":"NNET","showlegend":false,"xaxis":"x3","yaxis":"y3","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[302.491228051323,314.25108594362,325.774482498624,315.202911362047,323.537795793139,315.610776344211,264.52954601996,298.914806302408,302.861759029796,296.824077394441,299.85264120996,328.415052974928],"text":["date: 2018-08-01<br />pax/1000: 302.49123<br />model: NNET","date: 2018-09-01<br />pax/1000: 314.25109<br />model: NNET","date: 2018-10-01<br />pax/1000: 325.77448<br />model: NNET","date: 2018-11-01<br />pax/1000: 315.20291<br />model: NNET","date: 2018-12-01<br />pax/1000: 323.53780<br />model: NNET","date: 2019-01-01<br />pax/1000: 315.61078<br />model: NNET","date: 2019-02-01<br />pax/1000: 264.52955<br />model: NNET","date: 2019-03-01<br />pax/1000: 298.91481<br />model: NNET","date: 2019-04-01<br />pax/1000: 302.86176<br />model: NNET","date: 2019-05-01<br />pax/1000: 296.82408<br />model: NNET","date: 2019-06-01<br />pax/1000: 299.85264<br />model: NNET","date: 2019-07-01<br />pax/1000: 328.41505<br />model: NNET"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,190,103,1)","dash":"solid"},"hoveron":"points","name":"NNET","legendgroup":"NNET","showlegend":false,"xaxis":"x4","yaxis":"y4","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[404.782737073533,403.651647119872,427.584786806374,408.115965721907,427.794652688206,395.756723750847,364.443645468872,406.683140680886,405.076632865645,377.702956641933,380.276180614148,417.950652232533],"text":["date: 2018-08-01<br />pax/1000: 404.78274<br />model: NNET","date: 2018-09-01<br />pax/1000: 403.65165<br />model: NNET","date: 2018-10-01<br />pax/1000: 427.58479<br />model: NNET","date: 2018-11-01<br />pax/1000: 408.11597<br />model: NNET","date: 2018-12-01<br />pax/1000: 427.79465<br />model: NNET","date: 2019-01-01<br />pax/1000: 395.75672<br />model: NNET","date: 2019-02-01<br />pax/1000: 364.44365<br />model: NNET","date: 2019-03-01<br />pax/1000: 406.68314<br />model: NNET","date: 2019-04-01<br />pax/1000: 405.07663<br />model: NNET","date: 2019-05-01<br />pax/1000: 377.70296<br />model: NNET","date: 2019-06-01<br />pax/1000: 380.27618<br />model: NNET","date: 2019-07-01<br />pax/1000: 417.95065<br />model: NNET"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,190,103,1)","dash":"solid"},"hoveron":"points","name":"NNET","legendgroup":"NNET","showlegend":false,"xaxis":"x5","yaxis":"y5","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[216.854734764489,221.629100354453,227.37714270923,228.875279382244,229.939659843165,262.277515166117,225.73076299293,225.994441808396,225.449238819877,222.990851076408,220.429936623004,222.21683134224],"text":["date: 2018-08-01<br />pax/1000: 216.85473<br />model: NNET","date: 2018-09-01<br />pax/1000: 221.62910<br />model: NNET","date: 2018-10-01<br />pax/1000: 227.37714<br />model: NNET","date: 2018-11-01<br />pax/1000: 228.87528<br />model: NNET","date: 2018-12-01<br />pax/1000: 229.93966<br />model: NNET","date: 2019-01-01<br />pax/1000: 262.27752<br />model: NNET","date: 2019-02-01<br />pax/1000: 225.73076<br />model: NNET","date: 2019-03-01<br />pax/1000: 225.99444<br />model: NNET","date: 2019-04-01<br />pax/1000: 225.44924<br />model: NNET","date: 2019-05-01<br />pax/1000: 222.99085<br />model: NNET","date: 2019-06-01<br />pax/1000: 220.42994<br />model: NNET","date: 2019-07-01<br />pax/1000: 222.21683<br />model: NNET"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,190,103,1)","dash":"solid"},"hoveron":"points","name":"NNET","legendgroup":"NNET","showlegend":false,"xaxis":"x6","yaxis":"y6","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[172.119279289868,167.539795318401,181.557907014852,164.891053587568,177.453479723038,186.290580756438,159.001446713151,154.760234347522,177.735931241727,151.504252895388,146.263743903231,172.424983955921],"text":["date: 2018-08-01<br />pax/1000: 172.11928<br />model: NNET","date: 2018-09-01<br />pax/1000: 167.53980<br />model: NNET","date: 2018-10-01<br />pax/1000: 181.55791<br />model: NNET","date: 2018-11-01<br />pax/1000: 164.89105<br />model: NNET","date: 2018-12-01<br />pax/1000: 177.45348<br />model: NNET","date: 2019-01-01<br />pax/1000: 186.29058<br />model: NNET","date: 2019-02-01<br />pax/1000: 159.00145<br />model: NNET","date: 2019-03-01<br />pax/1000: 154.76023<br />model: NNET","date: 2019-04-01<br />pax/1000: 177.73593<br />model: NNET","date: 2019-05-01<br />pax/1000: 151.50425<br />model: NNET","date: 2019-06-01<br />pax/1000: 146.26374<br />model: NNET","date: 2019-07-01<br />pax/1000: 172.42498<br />model: NNET"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,190,103,1)","dash":"solid"},"hoveron":"points","name":"NNET","legendgroup":"NNET","showlegend":false,"xaxis":"x7","yaxis":"y7","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[150.171481587075,152.16733109042,196.196852569154,187.463713235869,200.366303003818,203.665143479957,149.797053579672,182.139677957684,191.365394160518,159.539820191124,145.342412359299,199.998321684188],"text":["date: 2018-08-01<br />pax/1000: 150.17148<br />model: NNET","date: 2018-09-01<br />pax/1000: 152.16733<br />model: NNET","date: 2018-10-01<br />pax/1000: 196.19685<br />model: NNET","date: 2018-11-01<br />pax/1000: 187.46371<br />model: NNET","date: 2018-12-01<br />pax/1000: 200.36630<br />model: NNET","date: 2019-01-01<br />pax/1000: 203.66514<br />model: NNET","date: 2019-02-01<br />pax/1000: 149.79705<br />model: NNET","date: 2019-03-01<br />pax/1000: 182.13968<br />model: NNET","date: 2019-04-01<br />pax/1000: 191.36539<br />model: NNET","date: 2019-05-01<br />pax/1000: 159.53982<br />model: NNET","date: 2019-06-01<br />pax/1000: 145.34241<br />model: NNET","date: 2019-07-01<br />pax/1000: 199.99832<br />model: NNET"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,190,103,1)","dash":"solid"},"hoveron":"points","name":"NNET","legendgroup":"NNET","showlegend":false,"xaxis":"x8","yaxis":"y8","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[600.846656425743,600.846656425743,600.846656425743,600.846656425743,600.846656425743,600.846656425743,600.846656425743,600.846656425743,600.846656425743,600.846656425743,600.846656425743,600.846656425743],"text":["date: 2018-08-01<br />pax/1000: 600.84666<br />model: NNET","date: 2018-09-01<br />pax/1000: 600.84666<br />model: NNET","date: 2018-10-01<br />pax/1000: 600.84666<br />model: NNET","date: 2018-11-01<br />pax/1000: 600.84666<br />model: NNET","date: 2018-12-01<br />pax/1000: 600.84666<br />model: NNET","date: 2019-01-01<br />pax/1000: 600.84666<br />model: NNET","date: 2019-02-01<br />pax/1000: 600.84666<br />model: NNET","date: 2019-03-01<br />pax/1000: 600.84666<br />model: NNET","date: 2019-04-01<br />pax/1000: 600.84666<br />model: NNET","date: 2019-05-01<br />pax/1000: 600.84666<br />model: NNET","date: 2019-06-01<br />pax/1000: 600.84666<br />model: NNET","date: 2019-07-01<br />pax/1000: 600.84666<br />model: NNET"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,190,103,1)","dash":"solid"},"hoveron":"points","name":"NNET","legendgroup":"NNET","showlegend":false,"xaxis":"x9","yaxis":"y9","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[118.854904221604,118.854904221604,118.854904221604,118.854904221604,118.854904221604,118.854904221604,118.854904221604,118.854904221604,118.854904221604,118.854904221604,118.854904221604,118.854904221604],"text":["date: 2018-08-01<br />pax/1000: 118.85490<br />model: NNET","date: 2018-09-01<br />pax/1000: 118.85490<br />model: NNET","date: 2018-10-01<br />pax/1000: 118.85490<br />model: NNET","date: 2018-11-01<br />pax/1000: 118.85490<br />model: NNET","date: 2018-12-01<br />pax/1000: 118.85490<br />model: NNET","date: 2019-01-01<br />pax/1000: 118.85490<br />model: NNET","date: 2019-02-01<br />pax/1000: 118.85490<br />model: NNET","date: 2019-03-01<br />pax/1000: 118.85490<br />model: NNET","date: 2019-04-01<br />pax/1000: 118.85490<br />model: NNET","date: 2019-05-01<br />pax/1000: 118.85490<br />model: NNET","date: 2019-06-01<br />pax/1000: 118.85490<br />model: NNET","date: 2019-07-01<br />pax/1000: 118.85490<br />model: NNET"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,190,103,1)","dash":"solid"},"hoveron":"points","name":"NNET","legendgroup":"NNET","showlegend":false,"xaxis":"x10","yaxis":"y10","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[202.347957738993,204.520542637617,222.8717920351,212.462981289252,214.763326730996,203.79624608488,189.317919253017,220.903732295191,217.96224698516,207.940830201377,198.473140988466,225.634649259536],"text":["date: 2018-08-01<br />pax/1000: 202.34796<br />model: PROPHET W XGBOOST","date: 2018-09-01<br />pax/1000: 204.52054<br />model: PROPHET W XGBOOST","date: 2018-10-01<br />pax/1000: 222.87179<br />model: PROPHET W XGBOOST","date: 2018-11-01<br />pax/1000: 212.46298<br />model: PROPHET W XGBOOST","date: 2018-12-01<br />pax/1000: 214.76333<br />model: PROPHET W XGBOOST","date: 2019-01-01<br />pax/1000: 203.79625<br />model: PROPHET W XGBOOST","date: 2019-02-01<br />pax/1000: 189.31792<br />model: PROPHET W XGBOOST","date: 2019-03-01<br />pax/1000: 220.90373<br />model: PROPHET W XGBOOST","date: 2019-04-01<br />pax/1000: 217.96225<br />model: PROPHET W XGBOOST","date: 2019-05-01<br />pax/1000: 207.94083<br />model: PROPHET W XGBOOST","date: 2019-06-01<br />pax/1000: 198.47314<br />model: PROPHET W XGBOOST","date: 2019-07-01<br />pax/1000: 225.63465<br />model: PROPHET W XGBOOST"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","name":"PROPHET W XGBOOST","legendgroup":"PROPHET W XGBOOST","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[153.148745961436,153.899995684341,173.873903851711,173.522645452044,172.305875907955,166.519782432395,150.060657959163,176.549500143587,171.082626539541,156.200639712968,143.64830463545,165.207896261887],"text":["date: 2018-08-01<br />pax/1000: 153.14875<br />model: PROPHET W XGBOOST","date: 2018-09-01<br />pax/1000: 153.90000<br />model: PROPHET W XGBOOST","date: 2018-10-01<br />pax/1000: 173.87390<br />model: PROPHET W XGBOOST","date: 2018-11-01<br />pax/1000: 173.52265<br />model: PROPHET W XGBOOST","date: 2018-12-01<br />pax/1000: 172.30588<br />model: PROPHET W XGBOOST","date: 2019-01-01<br />pax/1000: 166.51978<br />model: PROPHET W XGBOOST","date: 2019-02-01<br />pax/1000: 150.06066<br />model: PROPHET W XGBOOST","date: 2019-03-01<br />pax/1000: 176.54950<br />model: PROPHET W XGBOOST","date: 2019-04-01<br />pax/1000: 171.08263<br />model: PROPHET W XGBOOST","date: 2019-05-01<br />pax/1000: 156.20064<br />model: PROPHET W XGBOOST","date: 2019-06-01<br />pax/1000: 143.64830<br />model: PROPHET W XGBOOST","date: 2019-07-01<br />pax/1000: 165.20790<br />model: PROPHET W XGBOOST"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","name":"PROPHET W XGBOOST","legendgroup":"PROPHET W XGBOOST","showlegend":false,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[120.644762583083,114.321622741986,118.381670338568,116.595726790439,119.123077340959,113.847495090967,105.679694018242,108.937853329361,112.244164662091,111.498026654045,111.84472620586,126.248400366365],"text":["date: 2018-08-01<br />pax/1000: 120.64476<br />model: PROPHET W XGBOOST","date: 2018-09-01<br />pax/1000: 114.32162<br />model: PROPHET W XGBOOST","date: 2018-10-01<br />pax/1000: 118.38167<br />model: PROPHET W XGBOOST","date: 2018-11-01<br />pax/1000: 116.59573<br />model: PROPHET W XGBOOST","date: 2018-12-01<br />pax/1000: 119.12308<br />model: PROPHET W XGBOOST","date: 2019-01-01<br />pax/1000: 113.84750<br />model: PROPHET W XGBOOST","date: 2019-02-01<br />pax/1000: 105.67969<br />model: PROPHET W XGBOOST","date: 2019-03-01<br />pax/1000: 108.93785<br />model: PROPHET W XGBOOST","date: 2019-04-01<br />pax/1000: 112.24416<br />model: PROPHET W XGBOOST","date: 2019-05-01<br />pax/1000: 111.49803<br />model: PROPHET W XGBOOST","date: 2019-06-01<br />pax/1000: 111.84473<br />model: PROPHET W XGBOOST","date: 2019-07-01<br />pax/1000: 126.24840<br />model: PROPHET W XGBOOST"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","name":"PROPHET W XGBOOST","legendgroup":"PROPHET W XGBOOST","showlegend":false,"xaxis":"x3","yaxis":"y3","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[312.646797791784,317.608560446029,331.521864570875,322.046909053448,317.473059069286,305.410635919431,256.969732756999,299.015001814102,298.496925238542,284.401206586239,288.014870129673,333.945817906896],"text":["date: 2018-08-01<br />pax/1000: 312.64680<br />model: PROPHET W XGBOOST","date: 2018-09-01<br />pax/1000: 317.60856<br />model: PROPHET W XGBOOST","date: 2018-10-01<br />pax/1000: 331.52186<br />model: PROPHET W XGBOOST","date: 2018-11-01<br />pax/1000: 322.04691<br />model: PROPHET W XGBOOST","date: 2018-12-01<br />pax/1000: 317.47306<br />model: PROPHET W XGBOOST","date: 2019-01-01<br />pax/1000: 305.41064<br />model: PROPHET W XGBOOST","date: 2019-02-01<br />pax/1000: 256.96973<br />model: PROPHET W XGBOOST","date: 2019-03-01<br />pax/1000: 299.01500<br />model: PROPHET W XGBOOST","date: 2019-04-01<br />pax/1000: 298.49693<br />model: PROPHET W XGBOOST","date: 2019-05-01<br />pax/1000: 284.40121<br />model: PROPHET W XGBOOST","date: 2019-06-01<br />pax/1000: 288.01487<br />model: PROPHET W XGBOOST","date: 2019-07-01<br />pax/1000: 333.94582<br />model: PROPHET W XGBOOST"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","name":"PROPHET W XGBOOST","legendgroup":"PROPHET W XGBOOST","showlegend":false,"xaxis":"x4","yaxis":"y4","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[414.758589789427,411.783058648519,431.652316267037,431.171755702275,421.799181347315,387.249310104149,381.507142739675,405.405301055,407.013140624076,409.358418477778,391.360603923186,445.317803118674],"text":["date: 2018-08-01<br />pax/1000: 414.75859<br />model: PROPHET W XGBOOST","date: 2018-09-01<br />pax/1000: 411.78306<br />model: PROPHET W XGBOOST","date: 2018-10-01<br />pax/1000: 431.65232<br />model: PROPHET W XGBOOST","date: 2018-11-01<br />pax/1000: 431.17176<br />model: PROPHET W XGBOOST","date: 2018-12-01<br />pax/1000: 421.79918<br />model: PROPHET W XGBOOST","date: 2019-01-01<br />pax/1000: 387.24931<br />model: PROPHET W XGBOOST","date: 2019-02-01<br />pax/1000: 381.50714<br />model: PROPHET W XGBOOST","date: 2019-03-01<br />pax/1000: 405.40530<br />model: PROPHET W XGBOOST","date: 2019-04-01<br />pax/1000: 407.01314<br />model: PROPHET W XGBOOST","date: 2019-05-01<br />pax/1000: 409.35842<br />model: PROPHET W XGBOOST","date: 2019-06-01<br />pax/1000: 391.36060<br />model: PROPHET W XGBOOST","date: 2019-07-01<br />pax/1000: 445.31780<br />model: PROPHET W XGBOOST"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","name":"PROPHET W XGBOOST","legendgroup":"PROPHET W XGBOOST","showlegend":false,"xaxis":"x5","yaxis":"y5","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[211.146344211743,222.272718072148,244.708392893911,244.691982408004,244.098574359824,265.518079764201,213.149002413167,231.956808175945,238.863889355034,213.775858032951,198.697921448237,235.4593113356],"text":["date: 2018-08-01<br />pax/1000: 211.14634<br />model: PROPHET W XGBOOST","date: 2018-09-01<br />pax/1000: 222.27272<br />model: PROPHET W XGBOOST","date: 2018-10-01<br />pax/1000: 244.70839<br />model: PROPHET W XGBOOST","date: 2018-11-01<br />pax/1000: 244.69198<br />model: PROPHET W XGBOOST","date: 2018-12-01<br />pax/1000: 244.09857<br />model: PROPHET W XGBOOST","date: 2019-01-01<br />pax/1000: 265.51808<br />model: PROPHET W XGBOOST","date: 2019-02-01<br />pax/1000: 213.14900<br />model: PROPHET W XGBOOST","date: 2019-03-01<br />pax/1000: 231.95681<br />model: PROPHET W XGBOOST","date: 2019-04-01<br />pax/1000: 238.86389<br />model: PROPHET W XGBOOST","date: 2019-05-01<br />pax/1000: 213.77586<br />model: PROPHET W XGBOOST","date: 2019-06-01<br />pax/1000: 198.69792<br />model: PROPHET W XGBOOST","date: 2019-07-01<br />pax/1000: 235.45931<br />model: PROPHET W XGBOOST"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","name":"PROPHET W XGBOOST","legendgroup":"PROPHET W XGBOOST","showlegend":false,"xaxis":"x6","yaxis":"y6","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[176.013269919513,183.911473556637,198.204990562487,186.664129621461,188.944661728934,216.124330531344,147.290797871818,164.548409952464,176.52746512223,159.748404224253,163.689766051045,196.875377753522],"text":["date: 2018-08-01<br />pax/1000: 176.01327<br />model: PROPHET W XGBOOST","date: 2018-09-01<br />pax/1000: 183.91147<br />model: PROPHET W XGBOOST","date: 2018-10-01<br />pax/1000: 198.20499<br />model: PROPHET W XGBOOST","date: 2018-11-01<br />pax/1000: 186.66413<br />model: PROPHET W XGBOOST","date: 2018-12-01<br />pax/1000: 188.94466<br />model: PROPHET W XGBOOST","date: 2019-01-01<br />pax/1000: 216.12433<br />model: PROPHET W XGBOOST","date: 2019-02-01<br />pax/1000: 147.29080<br />model: PROPHET W XGBOOST","date: 2019-03-01<br />pax/1000: 164.54841<br />model: PROPHET W XGBOOST","date: 2019-04-01<br />pax/1000: 176.52747<br />model: PROPHET W XGBOOST","date: 2019-05-01<br />pax/1000: 159.74840<br />model: PROPHET W XGBOOST","date: 2019-06-01<br />pax/1000: 163.68977<br />model: PROPHET W XGBOOST","date: 2019-07-01<br />pax/1000: 196.87538<br />model: PROPHET W XGBOOST"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","name":"PROPHET W XGBOOST","legendgroup":"PROPHET W XGBOOST","showlegend":false,"xaxis":"x7","yaxis":"y7","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[159.6795486802,160.367886964234,176.876648738461,176.019786716519,184.639983853741,187.116061572529,146.864894165036,163.62663882612,167.881671250915,156.189025839284,146.209157485506,168.779485059371],"text":["date: 2018-08-01<br />pax/1000: 159.67955<br />model: PROPHET W XGBOOST","date: 2018-09-01<br />pax/1000: 160.36789<br />model: PROPHET W XGBOOST","date: 2018-10-01<br />pax/1000: 176.87665<br />model: PROPHET W XGBOOST","date: 2018-11-01<br />pax/1000: 176.01979<br />model: PROPHET W XGBOOST","date: 2018-12-01<br />pax/1000: 184.63998<br />model: PROPHET W XGBOOST","date: 2019-01-01<br />pax/1000: 187.11606<br />model: PROPHET W XGBOOST","date: 2019-02-01<br />pax/1000: 146.86489<br />model: PROPHET W XGBOOST","date: 2019-03-01<br />pax/1000: 163.62664<br />model: PROPHET W XGBOOST","date: 2019-04-01<br />pax/1000: 167.88167<br />model: PROPHET W XGBOOST","date: 2019-05-01<br />pax/1000: 156.18903<br />model: PROPHET W XGBOOST","date: 2019-06-01<br />pax/1000: 146.20916<br />model: PROPHET W XGBOOST","date: 2019-07-01<br />pax/1000: 168.77949<br />model: PROPHET W XGBOOST"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","name":"PROPHET W XGBOOST","legendgroup":"PROPHET W XGBOOST","showlegend":false,"xaxis":"x8","yaxis":"y8","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[773.452097743431,772.959845504935,825.436617029473,845.769706143883,792.383820126389,748.34247520834,758.016976229609,842.93759852398,780.859478580226,780.245149184201,735.633824981932,809.719388892179],"text":["date: 2018-08-01<br />pax/1000: 773.45210<br />model: PROPHET W XGBOOST","date: 2018-09-01<br />pax/1000: 772.95985<br />model: PROPHET W XGBOOST","date: 2018-10-01<br />pax/1000: 825.43662<br />model: PROPHET W XGBOOST","date: 2018-11-01<br />pax/1000: 845.76971<br />model: PROPHET W XGBOOST","date: 2018-12-01<br />pax/1000: 792.38382<br />model: PROPHET W XGBOOST","date: 2019-01-01<br />pax/1000: 748.34248<br />model: PROPHET W XGBOOST","date: 2019-02-01<br />pax/1000: 758.01698<br />model: PROPHET W XGBOOST","date: 2019-03-01<br />pax/1000: 842.93760<br />model: PROPHET W XGBOOST","date: 2019-04-01<br />pax/1000: 780.85948<br />model: PROPHET W XGBOOST","date: 2019-05-01<br />pax/1000: 780.24515<br />model: PROPHET W XGBOOST","date: 2019-06-01<br />pax/1000: 735.63382<br />model: PROPHET W XGBOOST","date: 2019-07-01<br />pax/1000: 809.71939<br />model: PROPHET W XGBOOST"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","name":"PROPHET W XGBOOST","legendgroup":"PROPHET W XGBOOST","showlegend":false,"xaxis":"x9","yaxis":"y9","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[135.173862182247,139.505949743974,150.151257351767,145.325174281074,156.292125830567,161.75857123703,128.608319004137,144.256023914426,145.774453120482,135.978359936193,124.686835746446,145.183682774664],"text":["date: 2018-08-01<br />pax/1000: 135.17386<br />model: PROPHET W XGBOOST","date: 2018-09-01<br />pax/1000: 139.50595<br />model: PROPHET W XGBOOST","date: 2018-10-01<br />pax/1000: 150.15126<br />model: PROPHET W XGBOOST","date: 2018-11-01<br />pax/1000: 145.32517<br />model: PROPHET W XGBOOST","date: 2018-12-01<br />pax/1000: 156.29213<br />model: PROPHET W XGBOOST","date: 2019-01-01<br />pax/1000: 161.75857<br />model: PROPHET W XGBOOST","date: 2019-02-01<br />pax/1000: 128.60832<br />model: PROPHET W XGBOOST","date: 2019-03-01<br />pax/1000: 144.25602<br />model: PROPHET W XGBOOST","date: 2019-04-01<br />pax/1000: 145.77445<br />model: PROPHET W XGBOOST","date: 2019-05-01<br />pax/1000: 135.97836<br />model: PROPHET W XGBOOST","date: 2019-06-01<br />pax/1000: 124.68684<br />model: PROPHET W XGBOOST","date: 2019-07-01<br />pax/1000: 145.18368<br />model: PROPHET W XGBOOST"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","name":"PROPHET W XGBOOST","legendgroup":"PROPHET W XGBOOST","showlegend":false,"xaxis":"x10","yaxis":"y10","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[202.043782902841,205.672066096998,213.9470876888,211.423984530002,209.492621487344,203.17069456851,194.383237605071,207.732216404119,210.435708715448,203.349743721989,195.865929501124,212.206103868604],"text":["date: 2018-08-01<br />pax/1000: 202.04378<br />model: RANGER","date: 2018-09-01<br />pax/1000: 205.67207<br />model: RANGER","date: 2018-10-01<br />pax/1000: 213.94709<br />model: RANGER","date: 2018-11-01<br />pax/1000: 211.42398<br />model: RANGER","date: 2018-12-01<br />pax/1000: 209.49262<br />model: RANGER","date: 2019-01-01<br />pax/1000: 203.17069<br />model: RANGER","date: 2019-02-01<br />pax/1000: 194.38324<br />model: RANGER","date: 2019-03-01<br />pax/1000: 207.73222<br />model: RANGER","date: 2019-04-01<br />pax/1000: 210.43571<br />model: RANGER","date: 2019-05-01<br />pax/1000: 203.34974<br />model: RANGER","date: 2019-06-01<br />pax/1000: 195.86593<br />model: RANGER","date: 2019-07-01<br />pax/1000: 212.20610<br />model: RANGER"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,169,255,1)","dash":"solid"},"hoveron":"points","name":"RANGER","legendgroup":"RANGER","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[150.022090885274,152.115217084753,166.080784906208,166.347492005053,165.841515497022,163.265813416813,151.521823279006,161.141606365523,166.391161118836,155.421976797346,145.488450638308,160.193936707115],"text":["date: 2018-08-01<br />pax/1000: 150.02209<br />model: RANGER","date: 2018-09-01<br />pax/1000: 152.11522<br />model: RANGER","date: 2018-10-01<br />pax/1000: 166.08078<br />model: RANGER","date: 2018-11-01<br />pax/1000: 166.34749<br />model: RANGER","date: 2018-12-01<br />pax/1000: 165.84152<br />model: RANGER","date: 2019-01-01<br />pax/1000: 163.26581<br />model: RANGER","date: 2019-02-01<br />pax/1000: 151.52182<br />model: RANGER","date: 2019-03-01<br />pax/1000: 161.14161<br />model: RANGER","date: 2019-04-01<br />pax/1000: 166.39116<br />model: RANGER","date: 2019-05-01<br />pax/1000: 155.42198<br />model: RANGER","date: 2019-06-01<br />pax/1000: 145.48845<br />model: RANGER","date: 2019-07-01<br />pax/1000: 160.19394<br />model: RANGER"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,169,255,1)","dash":"solid"},"hoveron":"points","name":"RANGER","legendgroup":"RANGER","showlegend":false,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[118.625753303274,117.028259854287,119.736430144733,116.591413441648,116.178074119736,109.981651055174,102.383501711729,105.565561596532,108.591893156557,107.311465613249,104.983742848792,121.347667503474],"text":["date: 2018-08-01<br />pax/1000: 118.62575<br />model: RANGER","date: 2018-09-01<br />pax/1000: 117.02826<br />model: RANGER","date: 2018-10-01<br />pax/1000: 119.73643<br />model: RANGER","date: 2018-11-01<br />pax/1000: 116.59141<br />model: RANGER","date: 2018-12-01<br />pax/1000: 116.17807<br />model: RANGER","date: 2019-01-01<br />pax/1000: 109.98165<br />model: RANGER","date: 2019-02-01<br />pax/1000: 102.38350<br />model: RANGER","date: 2019-03-01<br />pax/1000: 105.56556<br />model: RANGER","date: 2019-04-01<br />pax/1000: 108.59189<br />model: RANGER","date: 2019-05-01<br />pax/1000: 107.31147<br />model: RANGER","date: 2019-06-01<br />pax/1000: 104.98374<br />model: RANGER","date: 2019-07-01<br />pax/1000: 121.34767<br />model: RANGER"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,169,255,1)","dash":"solid"},"hoveron":"points","name":"RANGER","legendgroup":"RANGER","showlegend":false,"xaxis":"x3","yaxis":"y3","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[310.408409318775,309.536058564629,320.912629203642,312.238541429177,308.060695179784,291.001670560049,262.076571569369,282.254561893727,287.646529122322,280.078693960777,285.438505861196,318.288574487809],"text":["date: 2018-08-01<br />pax/1000: 310.40841<br />model: RANGER","date: 2018-09-01<br />pax/1000: 309.53606<br />model: RANGER","date: 2018-10-01<br />pax/1000: 320.91263<br />model: RANGER","date: 2018-11-01<br />pax/1000: 312.23854<br />model: RANGER","date: 2018-12-01<br />pax/1000: 308.06070<br />model: RANGER","date: 2019-01-01<br />pax/1000: 291.00167<br />model: RANGER","date: 2019-02-01<br />pax/1000: 262.07657<br />model: RANGER","date: 2019-03-01<br />pax/1000: 282.25456<br />model: RANGER","date: 2019-04-01<br />pax/1000: 287.64653<br />model: RANGER","date: 2019-05-01<br />pax/1000: 280.07869<br />model: RANGER","date: 2019-06-01<br />pax/1000: 285.43851<br />model: RANGER","date: 2019-07-01<br />pax/1000: 318.28857<br />model: RANGER"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,169,255,1)","dash":"solid"},"hoveron":"points","name":"RANGER","legendgroup":"RANGER","showlegend":false,"xaxis":"x4","yaxis":"y4","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[409.084679456189,408.137015844846,412.754315369187,410.129860691543,408.393168376114,378.781629133006,376.925646810159,395.962957967355,394.579854059877,398.248425119239,388.030665982517,417.710375370014],"text":["date: 2018-08-01<br />pax/1000: 409.08468<br />model: RANGER","date: 2018-09-01<br />pax/1000: 408.13702<br />model: RANGER","date: 2018-10-01<br />pax/1000: 412.75432<br />model: RANGER","date: 2018-11-01<br />pax/1000: 410.12986<br />model: RANGER","date: 2018-12-01<br />pax/1000: 408.39317<br />model: RANGER","date: 2019-01-01<br />pax/1000: 378.78163<br />model: RANGER","date: 2019-02-01<br />pax/1000: 376.92565<br />model: RANGER","date: 2019-03-01<br />pax/1000: 395.96296<br />model: RANGER","date: 2019-04-01<br />pax/1000: 394.57985<br />model: RANGER","date: 2019-05-01<br />pax/1000: 398.24843<br />model: RANGER","date: 2019-06-01<br />pax/1000: 388.03067<br />model: RANGER","date: 2019-07-01<br />pax/1000: 417.71038<br />model: RANGER"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,169,255,1)","dash":"solid"},"hoveron":"points","name":"RANGER","legendgroup":"RANGER","showlegend":false,"xaxis":"x5","yaxis":"y5","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[214.863831869096,221.670791965495,239.634545468599,238.375061640793,237.065575201993,253.8687882102,220.712607167888,223.780490966878,233.978293599356,206.610842183337,198.633781887257,227.066770501936],"text":["date: 2018-08-01<br />pax/1000: 214.86383<br />model: RANGER","date: 2018-09-01<br />pax/1000: 221.67079<br />model: RANGER","date: 2018-10-01<br />pax/1000: 239.63455<br />model: RANGER","date: 2018-11-01<br />pax/1000: 238.37506<br />model: RANGER","date: 2018-12-01<br />pax/1000: 237.06558<br />model: RANGER","date: 2019-01-01<br />pax/1000: 253.86879<br />model: RANGER","date: 2019-02-01<br />pax/1000: 220.71261<br />model: RANGER","date: 2019-03-01<br />pax/1000: 223.78049<br />model: RANGER","date: 2019-04-01<br />pax/1000: 233.97829<br />model: RANGER","date: 2019-05-01<br />pax/1000: 206.61084<br />model: RANGER","date: 2019-06-01<br />pax/1000: 198.63378<br />model: RANGER","date: 2019-07-01<br />pax/1000: 227.06677<br />model: RANGER"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,169,255,1)","dash":"solid"},"hoveron":"points","name":"RANGER","legendgroup":"RANGER","showlegend":false,"xaxis":"x6","yaxis":"y6","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[167.499295574706,172.794276625081,184.874696917077,174.352861227626,175.238395257239,188.472596134726,149.723959059648,157.775975701272,169.961138841987,151.31706482102,156.80241800096,180.345724212499],"text":["date: 2018-08-01<br />pax/1000: 167.49930<br />model: RANGER","date: 2018-09-01<br />pax/1000: 172.79428<br />model: RANGER","date: 2018-10-01<br />pax/1000: 184.87470<br />model: RANGER","date: 2018-11-01<br />pax/1000: 174.35286<br />model: RANGER","date: 2018-12-01<br />pax/1000: 175.23840<br />model: RANGER","date: 2019-01-01<br />pax/1000: 188.47260<br />model: RANGER","date: 2019-02-01<br />pax/1000: 149.72396<br />model: RANGER","date: 2019-03-01<br />pax/1000: 157.77598<br />model: RANGER","date: 2019-04-01<br />pax/1000: 169.96114<br />model: RANGER","date: 2019-05-01<br />pax/1000: 151.31706<br />model: RANGER","date: 2019-06-01<br />pax/1000: 156.80242<br />model: RANGER","date: 2019-07-01<br />pax/1000: 180.34572<br />model: RANGER"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,169,255,1)","dash":"solid"},"hoveron":"points","name":"RANGER","legendgroup":"RANGER","showlegend":false,"xaxis":"x7","yaxis":"y7","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[166.82871156064,162.743620337301,179.130906504456,183.141139966852,184.271616848154,186.42943195944,159.938302951041,171.195744456939,177.16797709318,166.939171198156,155.574375444457,176.122151374152],"text":["date: 2018-08-01<br />pax/1000: 166.82871<br />model: RANGER","date: 2018-09-01<br />pax/1000: 162.74362<br />model: RANGER","date: 2018-10-01<br />pax/1000: 179.13091<br />model: RANGER","date: 2018-11-01<br />pax/1000: 183.14114<br />model: RANGER","date: 2018-12-01<br />pax/1000: 184.27162<br />model: RANGER","date: 2019-01-01<br />pax/1000: 186.42943<br />model: RANGER","date: 2019-02-01<br />pax/1000: 159.93830<br />model: RANGER","date: 2019-03-01<br />pax/1000: 171.19574<br />model: RANGER","date: 2019-04-01<br />pax/1000: 177.16798<br />model: RANGER","date: 2019-05-01<br />pax/1000: 166.93917<br />model: RANGER","date: 2019-06-01<br />pax/1000: 155.57438<br />model: RANGER","date: 2019-07-01<br />pax/1000: 176.12215<br />model: RANGER"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,169,255,1)","dash":"solid"},"hoveron":"points","name":"RANGER","legendgroup":"RANGER","showlegend":false,"xaxis":"x8","yaxis":"y8","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[760.919155673252,759.761901805214,788.239658947225,796.622797194704,772.812363361989,748.583485938191,755.294627660764,788.81134388968,771.995230403671,763.153177441937,741.221641806033,771.568808779727],"text":["date: 2018-08-01<br />pax/1000: 760.91916<br />model: RANGER","date: 2018-09-01<br />pax/1000: 759.76190<br />model: RANGER","date: 2018-10-01<br />pax/1000: 788.23966<br />model: RANGER","date: 2018-11-01<br />pax/1000: 796.62280<br />model: RANGER","date: 2018-12-01<br />pax/1000: 772.81236<br />model: RANGER","date: 2019-01-01<br />pax/1000: 748.58349<br />model: RANGER","date: 2019-02-01<br />pax/1000: 755.29463<br />model: RANGER","date: 2019-03-01<br />pax/1000: 788.81134<br />model: RANGER","date: 2019-04-01<br />pax/1000: 771.99523<br />model: RANGER","date: 2019-05-01<br />pax/1000: 763.15318<br />model: RANGER","date: 2019-06-01<br />pax/1000: 741.22164<br />model: RANGER","date: 2019-07-01<br />pax/1000: 771.56881<br />model: RANGER"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,169,255,1)","dash":"solid"},"hoveron":"points","name":"RANGER","legendgroup":"RANGER","showlegend":false,"xaxis":"x9","yaxis":"y9","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[138.035818819174,141.748470654454,149.096447504802,149.621177610204,156.727823973215,151.352113212461,133.791086090645,146.50147093027,147.619807632467,140.065631384289,130.331981771681,145.935832543667],"text":["date: 2018-08-01<br />pax/1000: 138.03582<br />model: RANGER","date: 2018-09-01<br />pax/1000: 141.74847<br />model: RANGER","date: 2018-10-01<br />pax/1000: 149.09645<br />model: RANGER","date: 2018-11-01<br />pax/1000: 149.62118<br />model: RANGER","date: 2018-12-01<br />pax/1000: 156.72782<br />model: RANGER","date: 2019-01-01<br />pax/1000: 151.35211<br />model: RANGER","date: 2019-02-01<br />pax/1000: 133.79109<br />model: RANGER","date: 2019-03-01<br />pax/1000: 146.50147<br />model: RANGER","date: 2019-04-01<br />pax/1000: 147.61981<br />model: RANGER","date: 2019-05-01<br />pax/1000: 140.06563<br />model: RANGER","date: 2019-06-01<br />pax/1000: 130.33198<br />model: RANGER","date: 2019-07-01<br />pax/1000: 145.93583<br />model: RANGER"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,169,255,1)","dash":"solid"},"hoveron":"points","name":"RANGER","legendgroup":"RANGER","showlegend":false,"xaxis":"x10","yaxis":"y10","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[208.007734289801,203.965775137594,216.043758935589,206.181111339377,204.894756175877,199.184684380758,190.266816352443,219.036366148903,211.679860320176,206.158195454754,192.60671786627,216.507906356362],"text":["date: 2018-08-01<br />pax/1000: 208.00773<br />model: THIEF","date: 2018-09-01<br />pax/1000: 203.96578<br />model: THIEF","date: 2018-10-01<br />pax/1000: 216.04376<br />model: THIEF","date: 2018-11-01<br />pax/1000: 206.18111<br />model: THIEF","date: 2018-12-01<br />pax/1000: 204.89476<br />model: THIEF","date: 2019-01-01<br />pax/1000: 199.18468<br />model: THIEF","date: 2019-02-01<br />pax/1000: 190.26682<br />model: THIEF","date: 2019-03-01<br />pax/1000: 219.03637<br />model: THIEF","date: 2019-04-01<br />pax/1000: 211.67986<br />model: THIEF","date: 2019-05-01<br />pax/1000: 206.15820<br />model: THIEF","date: 2019-06-01<br />pax/1000: 192.60672<br />model: THIEF","date: 2019-07-01<br />pax/1000: 216.50791<br />model: THIEF"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(199,124,255,1)","dash":"solid"},"hoveron":"points","name":"THIEF","legendgroup":"THIEF","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[155.599563704599,156.618447339605,174.11954741961,161.617417925215,167.465697636336,161.934230340722,146.382500951201,170.458565302863,166.45894783436,152.096480181723,140.341544216965,164.658794865309],"text":["date: 2018-08-01<br />pax/1000: 155.59956<br />model: THIEF","date: 2018-09-01<br />pax/1000: 156.61845<br />model: THIEF","date: 2018-10-01<br />pax/1000: 174.11955<br />model: THIEF","date: 2018-11-01<br />pax/1000: 161.61742<br />model: THIEF","date: 2018-12-01<br />pax/1000: 167.46570<br />model: THIEF","date: 2019-01-01<br />pax/1000: 161.93423<br />model: THIEF","date: 2019-02-01<br />pax/1000: 146.38250<br />model: THIEF","date: 2019-03-01<br />pax/1000: 170.45857<br />model: THIEF","date: 2019-04-01<br />pax/1000: 166.45895<br />model: THIEF","date: 2019-05-01<br />pax/1000: 152.09648<br />model: THIEF","date: 2019-06-01<br />pax/1000: 140.34154<br />model: THIEF","date: 2019-07-01<br />pax/1000: 164.65879<br />model: THIEF"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(199,124,255,1)","dash":"solid"},"hoveron":"points","name":"THIEF","legendgroup":"THIEF","showlegend":false,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[120.838938801123,112.23383452359,118.010002400748,111.372704417616,114.729810168837,108.284209017725,96.3660055787426,104.26943646575,106.468701165818,103.66875299665,108.42956968145,125.091564152114],"text":["date: 2018-08-01<br />pax/1000: 120.83894<br />model: THIEF","date: 2018-09-01<br />pax/1000: 112.23383<br />model: THIEF","date: 2018-10-01<br />pax/1000: 118.01000<br />model: THIEF","date: 2018-11-01<br />pax/1000: 111.37270<br />model: THIEF","date: 2018-12-01<br />pax/1000: 114.72981<br />model: THIEF","date: 2019-01-01<br />pax/1000: 108.28421<br />model: THIEF","date: 2019-02-01<br />pax/1000:  96.36601<br />model: THIEF","date: 2019-03-01<br />pax/1000: 104.26944<br />model: THIEF","date: 2019-04-01<br />pax/1000: 106.46870<br />model: THIEF","date: 2019-05-01<br />pax/1000: 103.66875<br />model: THIEF","date: 2019-06-01<br />pax/1000: 108.42957<br />model: THIEF","date: 2019-07-01<br />pax/1000: 125.09156<br />model: THIEF"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(199,124,255,1)","dash":"solid"},"hoveron":"points","name":"THIEF","legendgroup":"THIEF","showlegend":false,"xaxis":"x3","yaxis":"y3","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[309.376031879722,324.242209035737,335.931388977824,311.681998312707,317.124834060402,313.963382789817,255.832961423343,297.300676251957,297.187373701033,280.282103948152,286.820545661983,327.049231769634],"text":["date: 2018-08-01<br />pax/1000: 309.37603<br />model: THIEF","date: 2018-09-01<br />pax/1000: 324.24221<br />model: THIEF","date: 2018-10-01<br />pax/1000: 335.93139<br />model: THIEF","date: 2018-11-01<br />pax/1000: 311.68200<br />model: THIEF","date: 2018-12-01<br />pax/1000: 317.12483<br />model: THIEF","date: 2019-01-01<br />pax/1000: 313.96338<br />model: THIEF","date: 2019-02-01<br />pax/1000: 255.83296<br />model: THIEF","date: 2019-03-01<br />pax/1000: 297.30068<br />model: THIEF","date: 2019-04-01<br />pax/1000: 297.18737<br />model: THIEF","date: 2019-05-01<br />pax/1000: 280.28210<br />model: THIEF","date: 2019-06-01<br />pax/1000: 286.82055<br />model: THIEF","date: 2019-07-01<br />pax/1000: 327.04923<br />model: THIEF"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(199,124,255,1)","dash":"solid"},"hoveron":"points","name":"THIEF","legendgroup":"THIEF","showlegend":false,"xaxis":"x4","yaxis":"y4","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[408.33742441771,414.00766239118,430.41072334846,417.513632400882,425.882685525896,383.652321454181,368.732406321534,413.653499204289,399.854282354612,397.319832569668,387.087359046212,433.175226426461],"text":["date: 2018-08-01<br />pax/1000: 408.33742<br />model: THIEF","date: 2018-09-01<br />pax/1000: 414.00766<br />model: THIEF","date: 2018-10-01<br />pax/1000: 430.41072<br />model: THIEF","date: 2018-11-01<br />pax/1000: 417.51363<br />model: THIEF","date: 2018-12-01<br />pax/1000: 425.88269<br />model: THIEF","date: 2019-01-01<br />pax/1000: 383.65232<br />model: THIEF","date: 2019-02-01<br />pax/1000: 368.73241<br />model: THIEF","date: 2019-03-01<br />pax/1000: 413.65350<br />model: THIEF","date: 2019-04-01<br />pax/1000: 399.85428<br />model: THIEF","date: 2019-05-01<br />pax/1000: 397.31983<br />model: THIEF","date: 2019-06-01<br />pax/1000: 387.08736<br />model: THIEF","date: 2019-07-01<br />pax/1000: 433.17523<br />model: THIEF"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(199,124,255,1)","dash":"solid"},"hoveron":"points","name":"THIEF","legendgroup":"THIEF","showlegend":false,"xaxis":"x5","yaxis":"y5","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[214.306809607459,224.672801384927,243.67517308219,227.778032941533,241.486877320245,264.131931904589,207.467292253542,223.810962107459,222.727941766336,205.100073696622,197.544309870458,231.998842515964],"text":["date: 2018-08-01<br />pax/1000: 214.30681<br />model: THIEF","date: 2018-09-01<br />pax/1000: 224.67280<br />model: THIEF","date: 2018-10-01<br />pax/1000: 243.67517<br />model: THIEF","date: 2018-11-01<br />pax/1000: 227.77803<br />model: THIEF","date: 2018-12-01<br />pax/1000: 241.48688<br />model: THIEF","date: 2019-01-01<br />pax/1000: 264.13193<br />model: THIEF","date: 2019-02-01<br />pax/1000: 207.46729<br />model: THIEF","date: 2019-03-01<br />pax/1000: 223.81096<br />model: THIEF","date: 2019-04-01<br />pax/1000: 222.72794<br />model: THIEF","date: 2019-05-01<br />pax/1000: 205.10007<br />model: THIEF","date: 2019-06-01<br />pax/1000: 197.54431<br />model: THIEF","date: 2019-07-01<br />pax/1000: 231.99884<br />model: THIEF"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(199,124,255,1)","dash":"solid"},"hoveron":"points","name":"THIEF","legendgroup":"THIEF","showlegend":false,"xaxis":"x6","yaxis":"y6","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[172.466870386524,181.791183418787,186.821955949825,170.723740682796,181.041512765149,202.278369216298,151.77922162618,173.458345126293,167.762299062066,152.090550312344,158.05540057354,181.199011838263],"text":["date: 2018-08-01<br />pax/1000: 172.46687<br />model: THIEF","date: 2018-09-01<br />pax/1000: 181.79118<br />model: THIEF","date: 2018-10-01<br />pax/1000: 186.82196<br />model: THIEF","date: 2018-11-01<br />pax/1000: 170.72374<br />model: THIEF","date: 2018-12-01<br />pax/1000: 181.04151<br />model: THIEF","date: 2019-01-01<br />pax/1000: 202.27837<br />model: THIEF","date: 2019-02-01<br />pax/1000: 151.77922<br />model: THIEF","date: 2019-03-01<br />pax/1000: 173.45835<br />model: THIEF","date: 2019-04-01<br />pax/1000: 167.76230<br />model: THIEF","date: 2019-05-01<br />pax/1000: 152.09055<br />model: THIEF","date: 2019-06-01<br />pax/1000: 158.05540<br />model: THIEF","date: 2019-07-01<br />pax/1000: 181.19901<br />model: THIEF"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(199,124,255,1)","dash":"solid"},"hoveron":"points","name":"THIEF","legendgroup":"THIEF","showlegend":false,"xaxis":"x7","yaxis":"y7","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[166.285796474114,170.941295695743,185.76223677142,174.667744985309,192.364225060523,195.217884054936,158.117953901417,182.848233548291,180.964810950904,163.885666981665,157.997581236397,181.965734825345],"text":["date: 2018-08-01<br />pax/1000: 166.28580<br />model: THIEF","date: 2018-09-01<br />pax/1000: 170.94130<br />model: THIEF","date: 2018-10-01<br />pax/1000: 185.76224<br />model: THIEF","date: 2018-11-01<br />pax/1000: 174.66774<br />model: THIEF","date: 2018-12-01<br />pax/1000: 192.36423<br />model: THIEF","date: 2019-01-01<br />pax/1000: 195.21788<br />model: THIEF","date: 2019-02-01<br />pax/1000: 158.11795<br />model: THIEF","date: 2019-03-01<br />pax/1000: 182.84823<br />model: THIEF","date: 2019-04-01<br />pax/1000: 180.96481<br />model: THIEF","date: 2019-05-01<br />pax/1000: 163.88567<br />model: THIEF","date: 2019-06-01<br />pax/1000: 157.99758<br />model: THIEF","date: 2019-07-01<br />pax/1000: 181.96573<br />model: THIEF"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(199,124,255,1)","dash":"solid"},"hoveron":"points","name":"THIEF","legendgroup":"THIEF","showlegend":false,"xaxis":"x8","yaxis":"y8","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[782.788456939565,770.017421021546,814.452475310263,818.067265660408,768.174083533814,744.796150722582,748.291407420669,820.139064104775,764.162294692137,756.129346849348,722.481793105323,792.20943305242],"text":["date: 2018-08-01<br />pax/1000: 782.78846<br />model: THIEF","date: 2018-09-01<br />pax/1000: 770.01742<br />model: THIEF","date: 2018-10-01<br />pax/1000: 814.45248<br />model: THIEF","date: 2018-11-01<br />pax/1000: 818.06727<br />model: THIEF","date: 2018-12-01<br />pax/1000: 768.17408<br />model: THIEF","date: 2019-01-01<br />pax/1000: 744.79615<br />model: THIEF","date: 2019-02-01<br />pax/1000: 748.29141<br />model: THIEF","date: 2019-03-01<br />pax/1000: 820.13906<br />model: THIEF","date: 2019-04-01<br />pax/1000: 764.16229<br />model: THIEF","date: 2019-05-01<br />pax/1000: 756.12935<br />model: THIEF","date: 2019-06-01<br />pax/1000: 722.48179<br />model: THIEF","date: 2019-07-01<br />pax/1000: 792.20943<br />model: THIEF"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(199,124,255,1)","dash":"solid"},"hoveron":"points","name":"THIEF","legendgroup":"THIEF","showlegend":false,"xaxis":"x9","yaxis":"y9","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[136.516735158269,143.395938633967,155.91282843556,146.152531875823,158.486724797776,159.545834722528,131.910416848035,148.600148061324,149.918739784429,135.636467066297,126.512088143356,147.877954753339],"text":["date: 2018-08-01<br />pax/1000: 136.51674<br />model: THIEF","date: 2018-09-01<br />pax/1000: 143.39594<br />model: THIEF","date: 2018-10-01<br />pax/1000: 155.91283<br />model: THIEF","date: 2018-11-01<br />pax/1000: 146.15253<br />model: THIEF","date: 2018-12-01<br />pax/1000: 158.48672<br />model: THIEF","date: 2019-01-01<br />pax/1000: 159.54583<br />model: THIEF","date: 2019-02-01<br />pax/1000: 131.91042<br />model: THIEF","date: 2019-03-01<br />pax/1000: 148.60015<br />model: THIEF","date: 2019-04-01<br />pax/1000: 149.91874<br />model: THIEF","date: 2019-05-01<br />pax/1000: 135.63647<br />model: THIEF","date: 2019-06-01<br />pax/1000: 126.51209<br />model: THIEF","date: 2019-07-01<br />pax/1000: 147.87795<br />model: THIEF"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(199,124,255,1)","dash":"solid"},"hoveron":"points","name":"THIEF","legendgroup":"THIEF","showlegend":false,"xaxis":"x10","yaxis":"y10","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[200.318959650035,197.584714154338,214.885532041721,211.676929390444,212.062653676832,201.520368809839,185.799737857345,210.953448805504,213.214085131781,200.332141843788,189.844697673095,214.279993737361],"text":["date: 2018-08-01<br />pax/1000: 200.31896<br />model: XGBOOST","date: 2018-09-01<br />pax/1000: 197.58471<br />model: XGBOOST","date: 2018-10-01<br />pax/1000: 214.88553<br />model: XGBOOST","date: 2018-11-01<br />pax/1000: 211.67693<br />model: XGBOOST","date: 2018-12-01<br />pax/1000: 212.06265<br />model: XGBOOST","date: 2019-01-01<br />pax/1000: 201.52037<br />model: XGBOOST","date: 2019-02-01<br />pax/1000: 185.79974<br />model: XGBOOST","date: 2019-03-01<br />pax/1000: 210.95345<br />model: XGBOOST","date: 2019-04-01<br />pax/1000: 213.21409<br />model: XGBOOST","date: 2019-05-01<br />pax/1000: 200.33214<br />model: XGBOOST","date: 2019-06-01<br />pax/1000: 189.84470<br />model: XGBOOST","date: 2019-07-01<br />pax/1000: 214.27999<br />model: XGBOOST"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(255,97,204,1)","dash":"solid"},"hoveron":"points","name":"XGBOOST","legendgroup":"XGBOOST","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[149.871407818559,151.683905991029,171.241276737041,168.962889586382,168.492222027988,164.463870058818,148.0301598434,171.495411183206,168.379135883035,153.070970112399,142.732611227684,163.73396516503],"text":["date: 2018-08-01<br />pax/1000: 149.87141<br />model: XGBOOST","date: 2018-09-01<br />pax/1000: 151.68391<br />model: XGBOOST","date: 2018-10-01<br />pax/1000: 171.24128<br />model: XGBOOST","date: 2018-11-01<br />pax/1000: 168.96289<br />model: XGBOOST","date: 2018-12-01<br />pax/1000: 168.49222<br />model: XGBOOST","date: 2019-01-01<br />pax/1000: 164.46387<br />model: XGBOOST","date: 2019-02-01<br />pax/1000: 148.03016<br />model: XGBOOST","date: 2019-03-01<br />pax/1000: 171.49541<br />model: XGBOOST","date: 2019-04-01<br />pax/1000: 168.37914<br />model: XGBOOST","date: 2019-05-01<br />pax/1000: 153.07097<br />model: XGBOOST","date: 2019-06-01<br />pax/1000: 142.73261<br />model: XGBOOST","date: 2019-07-01<br />pax/1000: 163.73397<br />model: XGBOOST"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(255,97,204,1)","dash":"solid"},"hoveron":"points","name":"XGBOOST","legendgroup":"XGBOOST","showlegend":false,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[116.238421998091,113.73919489805,113.374017821084,114.402033251129,114.888903020567,110.465414452477,102.379479109842,102.698468983335,110.30845074191,111.575858728544,100.66272513444,122.300764581916],"text":["date: 2018-08-01<br />pax/1000: 116.23842<br />model: XGBOOST","date: 2018-09-01<br />pax/1000: 113.73919<br />model: XGBOOST","date: 2018-10-01<br />pax/1000: 113.37402<br />model: XGBOOST","date: 2018-11-01<br />pax/1000: 114.40203<br />model: XGBOOST","date: 2018-12-01<br />pax/1000: 114.88890<br />model: XGBOOST","date: 2019-01-01<br />pax/1000: 110.46541<br />model: XGBOOST","date: 2019-02-01<br />pax/1000: 102.37948<br />model: XGBOOST","date: 2019-03-01<br />pax/1000: 102.69847<br />model: XGBOOST","date: 2019-04-01<br />pax/1000: 110.30845<br />model: XGBOOST","date: 2019-05-01<br />pax/1000: 111.57586<br />model: XGBOOST","date: 2019-06-01<br />pax/1000: 100.66273<br />model: XGBOOST","date: 2019-07-01<br />pax/1000: 122.30076<br />model: XGBOOST"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(255,97,204,1)","dash":"solid"},"hoveron":"points","name":"XGBOOST","legendgroup":"XGBOOST","showlegend":false,"xaxis":"x3","yaxis":"y3","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[312.852722554258,312.318219184253,323.860196539819,310.948733942365,310.539771323787,298.920959355565,255.38879494802,298.710648617727,289.591502248689,278.138797541755,286.717872630054,316.617833320732],"text":["date: 2018-08-01<br />pax/1000: 312.85272<br />model: XGBOOST","date: 2018-09-01<br />pax/1000: 312.31822<br />model: XGBOOST","date: 2018-10-01<br />pax/1000: 323.86020<br />model: XGBOOST","date: 2018-11-01<br />pax/1000: 310.94873<br />model: XGBOOST","date: 2018-12-01<br />pax/1000: 310.53977<br />model: XGBOOST","date: 2019-01-01<br />pax/1000: 298.92096<br />model: XGBOOST","date: 2019-02-01<br />pax/1000: 255.38879<br />model: XGBOOST","date: 2019-03-01<br />pax/1000: 298.71065<br />model: XGBOOST","date: 2019-04-01<br />pax/1000: 289.59150<br />model: XGBOOST","date: 2019-05-01<br />pax/1000: 278.13880<br />model: XGBOOST","date: 2019-06-01<br />pax/1000: 286.71787<br />model: XGBOOST","date: 2019-07-01<br />pax/1000: 316.61783<br />model: XGBOOST"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(255,97,204,1)","dash":"solid"},"hoveron":"points","name":"XGBOOST","legendgroup":"XGBOOST","showlegend":false,"xaxis":"x4","yaxis":"y4","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[415.231552360449,413.385177412104,423.204895403099,421.688868264121,414.425690245684,369.678485932264,375.451391523947,400.654394602068,405.010477346566,403.324542803276,382.617811477348,427.946935304125],"text":["date: 2018-08-01<br />pax/1000: 415.23155<br />model: XGBOOST","date: 2018-09-01<br />pax/1000: 413.38518<br />model: XGBOOST","date: 2018-10-01<br />pax/1000: 423.20490<br />model: XGBOOST","date: 2018-11-01<br />pax/1000: 421.68887<br />model: XGBOOST","date: 2018-12-01<br />pax/1000: 414.42569<br />model: XGBOOST","date: 2019-01-01<br />pax/1000: 369.67849<br />model: XGBOOST","date: 2019-02-01<br />pax/1000: 375.45139<br />model: XGBOOST","date: 2019-03-01<br />pax/1000: 400.65439<br />model: XGBOOST","date: 2019-04-01<br />pax/1000: 405.01048<br />model: XGBOOST","date: 2019-05-01<br />pax/1000: 403.32454<br />model: XGBOOST","date: 2019-06-01<br />pax/1000: 382.61781<br />model: XGBOOST","date: 2019-07-01<br />pax/1000: 427.94694<br />model: XGBOOST"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(255,97,204,1)","dash":"solid"},"hoveron":"points","name":"XGBOOST","legendgroup":"XGBOOST","showlegend":false,"xaxis":"x5","yaxis":"y5","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[203.417467726167,219.217220269828,241.13192092728,239.77095005366,242.54826261323,254.125667306073,213.560447006468,229.361842455906,238.8199964825,200.40571058914,196.794880854462,226.930214179826],"text":["date: 2018-08-01<br />pax/1000: 203.41747<br />model: XGBOOST","date: 2018-09-01<br />pax/1000: 219.21722<br />model: XGBOOST","date: 2018-10-01<br />pax/1000: 241.13192<br />model: XGBOOST","date: 2018-11-01<br />pax/1000: 239.77095<br />model: XGBOOST","date: 2018-12-01<br />pax/1000: 242.54826<br />model: XGBOOST","date: 2019-01-01<br />pax/1000: 254.12567<br />model: XGBOOST","date: 2019-02-01<br />pax/1000: 213.56045<br />model: XGBOOST","date: 2019-03-01<br />pax/1000: 229.36184<br />model: XGBOOST","date: 2019-04-01<br />pax/1000: 238.82000<br />model: XGBOOST","date: 2019-05-01<br />pax/1000: 200.40571<br />model: XGBOOST","date: 2019-06-01<br />pax/1000: 196.79488<br />model: XGBOOST","date: 2019-07-01<br />pax/1000: 226.93021<br />model: XGBOOST"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(255,97,204,1)","dash":"solid"},"hoveron":"points","name":"XGBOOST","legendgroup":"XGBOOST","showlegend":false,"xaxis":"x6","yaxis":"y6","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[164.042025920859,178.026796430886,189.928361649082,177.208135193574,182.65890147305,191.299556905912,147.073426211312,158.83036728392,174.197249585076,153.74762251543,159.610547462716,185.611653737474],"text":["date: 2018-08-01<br />pax/1000: 164.04203<br />model: XGBOOST","date: 2018-09-01<br />pax/1000: 178.02680<br />model: XGBOOST","date: 2018-10-01<br />pax/1000: 189.92836<br />model: XGBOOST","date: 2018-11-01<br />pax/1000: 177.20814<br />model: XGBOOST","date: 2018-12-01<br />pax/1000: 182.65890<br />model: XGBOOST","date: 2019-01-01<br />pax/1000: 191.29956<br />model: XGBOOST","date: 2019-02-01<br />pax/1000: 147.07343<br />model: XGBOOST","date: 2019-03-01<br />pax/1000: 158.83037<br />model: XGBOOST","date: 2019-04-01<br />pax/1000: 174.19725<br />model: XGBOOST","date: 2019-05-01<br />pax/1000: 153.74762<br />model: XGBOOST","date: 2019-06-01<br />pax/1000: 159.61055<br />model: XGBOOST","date: 2019-07-01<br />pax/1000: 185.61165<br />model: XGBOOST"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(255,97,204,1)","dash":"solid"},"hoveron":"points","name":"XGBOOST","legendgroup":"XGBOOST","showlegend":false,"xaxis":"x7","yaxis":"y7","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[160.675036943507,158.040133793455,177.482464990739,182.498883591183,189.46161874461,187.306822429662,148.783537072021,173.300809484742,177.201544323909,160.872982072001,150.454691629674,175.085970054534],"text":["date: 2018-08-01<br />pax/1000: 160.67504<br />model: XGBOOST","date: 2018-09-01<br />pax/1000: 158.04013<br />model: XGBOOST","date: 2018-10-01<br />pax/1000: 177.48246<br />model: XGBOOST","date: 2018-11-01<br />pax/1000: 182.49888<br />model: XGBOOST","date: 2018-12-01<br />pax/1000: 189.46162<br />model: XGBOOST","date: 2019-01-01<br />pax/1000: 187.30682<br />model: XGBOOST","date: 2019-02-01<br />pax/1000: 148.78354<br />model: XGBOOST","date: 2019-03-01<br />pax/1000: 173.30081<br />model: XGBOOST","date: 2019-04-01<br />pax/1000: 177.20154<br />model: XGBOOST","date: 2019-05-01<br />pax/1000: 160.87298<br />model: XGBOOST","date: 2019-06-01<br />pax/1000: 150.45469<br />model: XGBOOST","date: 2019-07-01<br />pax/1000: 175.08597<br />model: XGBOOST"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(255,97,204,1)","dash":"solid"},"hoveron":"points","name":"XGBOOST","legendgroup":"XGBOOST","showlegend":false,"xaxis":"x8","yaxis":"y8","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[778.229730486866,756.239474607844,808.869051583143,833.094910131671,774.458979373388,746.007601106225,754.975534742572,819.076035027036,782.156824663023,770.97114547857,739.248337160609,795.145597834088],"text":["date: 2018-08-01<br />pax/1000: 778.22973<br />model: XGBOOST","date: 2018-09-01<br />pax/1000: 756.23947<br />model: XGBOOST","date: 2018-10-01<br />pax/1000: 808.86905<br />model: XGBOOST","date: 2018-11-01<br />pax/1000: 833.09491<br />model: XGBOOST","date: 2018-12-01<br />pax/1000: 774.45898<br />model: XGBOOST","date: 2019-01-01<br />pax/1000: 746.00760<br />model: XGBOOST","date: 2019-02-01<br />pax/1000: 754.97553<br />model: XGBOOST","date: 2019-03-01<br />pax/1000: 819.07604<br />model: XGBOOST","date: 2019-04-01<br />pax/1000: 782.15682<br />model: XGBOOST","date: 2019-05-01<br />pax/1000: 770.97115<br />model: XGBOOST","date: 2019-06-01<br />pax/1000: 739.24834<br />model: XGBOOST","date: 2019-07-01<br />pax/1000: 795.14560<br />model: XGBOOST"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(255,97,204,1)","dash":"solid"},"hoveron":"points","name":"XGBOOST","legendgroup":"XGBOOST","showlegend":false,"xaxis":"x9","yaxis":"y9","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[131.778846230262,138.144191584393,149.302487667312,145.993333690692,157.529417874306,149.499253522594,128.225165706832,147.223862999182,148.221714961127,141.296723624521,128.578691842468,146.715075585845],"text":["date: 2018-08-01<br />pax/1000: 131.77885<br />model: XGBOOST","date: 2018-09-01<br />pax/1000: 138.14419<br />model: XGBOOST","date: 2018-10-01<br />pax/1000: 149.30249<br />model: XGBOOST","date: 2018-11-01<br />pax/1000: 145.99333<br />model: XGBOOST","date: 2018-12-01<br />pax/1000: 157.52942<br />model: XGBOOST","date: 2019-01-01<br />pax/1000: 149.49925<br />model: XGBOOST","date: 2019-02-01<br />pax/1000: 128.22517<br />model: XGBOOST","date: 2019-03-01<br />pax/1000: 147.22386<br />model: XGBOOST","date: 2019-04-01<br />pax/1000: 148.22171<br />model: XGBOOST","date: 2019-05-01<br />pax/1000: 141.29672<br />model: XGBOOST","date: 2019-06-01<br />pax/1000: 128.57869<br />model: XGBOOST","date: 2019-07-01<br />pax/1000: 146.71508<br />model: XGBOOST"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(255,97,204,1)","dash":"solid"},"hoveron":"points","name":"XGBOOST","legendgroup":"XGBOOST","showlegend":false,"xaxis":"x10","yaxis":"y10","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":32.5601217656012,"r":7.30593607305936,"b":20.2130898021309,"l":43.1050228310502},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,0.490037359900374],"automargin":true,"type":"linear","autorange":false,"range":[16353.9,18160.1],"tickmode":"array","ticktext":["2015","2016","2017","2018","2019"],"tickvals":[16436,16801,17167,17532,17897],"categoryorder":"array","categoryarray":["2015","2016","2017","2018","2019"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":"","hoverformat":".2f"},"yaxis":{"domain":[0.808163830081638,1],"automargin":true,"type":"linear","autorange":false,"range":[161.283412695224,234.679592668107],"tickmode":"array","ticktext":["180","200","220"],"tickvals":[180,200,220],"categoryorder":"array","categoryarray":["180","200","220"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"annotations":[{"text":"pax pm(000)","x":0,"y":0.5,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-90,"xanchor":"right","yanchor":"center","annotationType":"axis","xshift":-27.7625570776256},{"text":"ADELAIDE-MELBOURNE","x":0.245018679950187,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"ADELAIDE-SYDNEY","x":0.754981320049813,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"BRISBANE-CAIRNS","x":0.245018679950187,"y":0.791836169918362,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"BRISBANE-MELBOURNE","x":0.754981320049813,"y":0.791836169918362,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"BRISBANE-SYDNEY","x":0.245018679950187,"y":0.591836169918362,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"GOLD COAST-SYDNEY","x":0.754981320049813,"y":0.591836169918362,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"MELBOURNE-GOLD COAST","x":0.245018679950187,"y":0.391836169918362,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"MELBOURNE-PERTH","x":0.754981320049813,"y":0.391836169918362,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"MELBOURNE-SYDNEY","x":0.245018679950187,"y":0.191836169918362,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"PERTH-SYDNEY","x":0.754981320049813,"y":0.191836169918362,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"}],"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":0.490037359900374,"y0":0.808163830081638,"y1":1},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":0.490037359900374,"y0":0,"y1":23.37899543379,"yanchor":1,"ysizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0.509962640099626,"x1":1,"y0":0.808163830081638,"y1":1},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0.509962640099626,"x1":1,"y0":0,"y1":23.37899543379,"yanchor":1,"ysizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":0.490037359900374,"y0":0.608163830081638,"y1":0.791836169918362},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":0.490037359900374,"y0":0,"y1":23.37899543379,"yanchor":0.791836169918362,"ysizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0.509962640099626,"x1":1,"y0":0.608163830081638,"y1":0.791836169918362},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0.509962640099626,"x1":1,"y0":0,"y1":23.37899543379,"yanchor":0.791836169918362,"ysizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":0.490037359900374,"y0":0.408163830081638,"y1":0.591836169918362},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":0.490037359900374,"y0":0,"y1":23.37899543379,"yanchor":0.591836169918362,"ysizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0.509962640099626,"x1":1,"y0":0.408163830081638,"y1":0.591836169918362},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0.509962640099626,"x1":1,"y0":0,"y1":23.37899543379,"yanchor":0.591836169918362,"ysizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":0.490037359900374,"y0":0.208163830081638,"y1":0.391836169918362},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":0.490037359900374,"y0":0,"y1":23.37899543379,"yanchor":0.391836169918362,"ysizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0.509962640099626,"x1":1,"y0":0.208163830081638,"y1":0.391836169918362},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0.509962640099626,"x1":1,"y0":0,"y1":23.37899543379,"yanchor":0.391836169918362,"ysizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":0.490037359900374,"y0":0,"y1":0.191836169918362},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":0.490037359900374,"y0":0,"y1":23.37899543379,"yanchor":0.191836169918362,"ysizemode":"pixel"},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0.509962640099626,"x1":1,"y0":0,"y1":0.191836169918362},{"type":"rect","fillcolor":"rgba(217,217,217,1)","line":{"color":"transparent","width":0.66417600664176,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0.509962640099626,"x1":1,"y0":0,"y1":23.37899543379,"yanchor":0.191836169918362,"ysizemode":"pixel"}],"xaxis2":{"type":"linear","autorange":false,"range":[16353.9,18160.1],"tickmode":"array","ticktext":["2015","2016","2017","2018","2019"],"tickvals":[16436,16801,17167,17532,17897],"categoryorder":"array","categoryarray":["2015","2016","2017","2018","2019"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0.509962640099626,1],"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y2","title":"","hoverformat":".2f"},"yaxis2":{"type":"linear","autorange":false,"range":[126.04991684329,182.81174629091],"tickmode":"array","ticktext":["130","140","150","160","170","180"],"tickvals":[130,140,150,160,170,180],"categoryorder":"array","categoryarray":["130","140","150","160","170","180"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0.808163830081638,1],"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x2","title":"","hoverformat":".2f"},"xaxis3":{"type":"linear","autorange":false,"range":[16353.9,18160.1],"tickmode":"array","ticktext":["2015","2016","2017","2018","2019"],"tickvals":[16436,16801,17167,17532,17897],"categoryorder":"array","categoryarray":["2015","2016","2017","2018","2019"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0,0.490037359900374],"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y3","title":"","hoverformat":".2f"},"yaxis3":{"type":"linear","autorange":false,"range":[91.2123902973281,134.015803756111],"tickmode":"array","ticktext":["100","110","120","130"],"tickvals":[100,110,120,130],"categoryorder":"array","categoryarray":["100","110","120","130"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0.608163830081638,0.791836169918362],"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x3","title":"","hoverformat":".2f"},"xaxis4":{"type":"linear","autorange":false,"range":[16353.9,18160.1],"tickmode":"array","ticktext":["2015","2016","2017","2018","2019"],"tickvals":[16436,16801,17167,17532,17897],"categoryorder":"array","categoryarray":["2015","2016","2017","2018","2019"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0.509962640099626,1],"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y4","title":"","hoverformat":".2f"},"yaxis4":{"type":"linear","autorange":false,"range":[229.775606825148,348.562256671883],"tickmode":"array","ticktext":["250","275","300","325"],"tickvals":[250,275,300,325],"categoryorder":"array","categoryarray":["250","275","300","325"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0.608163830081638,0.791836169918362],"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x4","title":"","hoverformat":".2f"},"xaxis5":{"type":"linear","autorange":false,"range":[16353.9,18160.1],"tickmode":"array","ticktext":["2015","2016","2017","2018","2019"],"tickvals":[16436,16801,17167,17532,17897],"categoryorder":"array","categoryarray":["2015","2016","2017","2018","2019"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0,0.490037359900374],"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y5","title":"","hoverformat":".2f"},"yaxis5":{"type":"linear","autorange":false,"range":[320.423659844066,451.265143274608],"tickmode":"array","ticktext":["325","350","375","400","425","450"],"tickvals":[325,350,375,400,425,450],"categoryorder":"array","categoryarray":["325","350","375","400","425","450"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0.408163830081638,0.591836169918362],"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x5","title":"","hoverformat":".2f"},"xaxis6":{"type":"linear","autorange":false,"range":[16353.9,18160.1],"tickmode":"array","ticktext":["2015","2016","2017","2018","2019"],"tickvals":[16436,16801,17167,17532,17897],"categoryorder":"array","categoryarray":["2015","2016","2017","2018","2019"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0.509962640099626,1],"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y6","title":"","hoverformat":".2f"},"yaxis6":{"type":"linear","autorange":false,"range":[182.9691,273.1449],"tickmode":"array","ticktext":["200","225","250"],"tickvals":[200,225,250],"categoryorder":"array","categoryarray":["200","225","250"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0.408163830081638,0.591836169918362],"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x6","title":"","hoverformat":".2f"},"xaxis7":{"type":"linear","autorange":false,"range":[16353.9,18160.1],"tickmode":"array","ticktext":["2015","2016","2017","2018","2019"],"tickvals":[16436,16801,17167,17532,17897],"categoryorder":"array","categoryarray":["2015","2016","2017","2018","2019"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0,0.490037359900374],"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y7","title":"","hoverformat":".2f"},"yaxis7":{"type":"linear","autorange":false,"range":[115.589633473433,220.911697057911],"tickmode":"array","ticktext":["120","140","160","180","200","220"],"tickvals":[120,140,160,180,200,220],"categoryorder":"array","categoryarray":["120","140","160","180","200","220"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0.208163830081638,0.391836169918362],"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x7","title":"","hoverformat":".2f"},"xaxis8":{"type":"linear","autorange":false,"range":[16353.9,18160.1],"tickmode":"array","ticktext":["2015","2016","2017","2018","2019"],"tickvals":[16436,16801,17167,17532,17897],"categoryorder":"array","categoryarray":["2015","2016","2017","2018","2019"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0.509962640099626,1],"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y8","title":"","hoverformat":".2f"},"yaxis8":{"type":"linear","autorange":false,"range":[142.136042826002,206.595100653955],"tickmode":"array","ticktext":["160","180","200"],"tickvals":[160,180,200],"categoryorder":"array","categoryarray":["160","180","200"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0.208163830081638,0.391836169918362],"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x8","title":"","hoverformat":".2f"},"xaxis9":{"type":"linear","autorange":false,"range":[16353.9,18160.1],"tickmode":"array","ticktext":["2015","2016","2017","2018","2019"],"tickvals":[16436,16801,17167,17532,17897],"categoryorder":"array","categoryarray":["2015","2016","2017","2018","2019"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0,0.490037359900374],"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y9","title":"","hoverformat":".2f"},"yaxis9":{"type":"linear","autorange":false,"range":[588.501074209537,860.103882966062],"tickmode":"array","ticktext":["600","650","700","750","800","850"],"tickvals":[600,650,700,750,800,850],"categoryorder":"array","categoryarray":["600","650","700","750","800","850"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0,0.191836169918362],"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x9","title":"","hoverformat":".2f"},"xaxis10":{"type":"linear","autorange":false,"range":[16353.9,18160.1],"tickmode":"array","ticktext":["2015","2016","2017","2018","2019"],"tickvals":[16436,16801,17167,17532,17897],"categoryorder":"array","categoryarray":["2015","2016","2017","2018","2019"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0.509962640099626,1],"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y10","title":"","hoverformat":".2f"},"yaxis10":{"type":"linear","autorange":false,"range":[116.618799432685,165.81310478892],"tickmode":"array","ticktext":["120","130","140","150","160"],"tickvals":[120,130,140,150,160],"categoryorder":"array","categoryarray":["120","130","140","150","160"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"domain":[0,0.191836169918362],"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x10","title":"","hoverformat":".2f"},"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":6.6417600664176},"title":{"text":"model","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"700860c42ed":{"x":{},"y":{},"colour":{},"type":"scatter"}},"cur_data":"700860c42ed","visdat":{"700860c42ed":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="select-best-models-by-route" class="level3" data-number="7.5">
<h3 data-number="7.5" class="anchored" data-anchor-id="select-best-models-by-route"><span class="header-section-number">7.5</span> Select Best Models by Route</h3>
<section id="summary-count-by-model" class="level4">
<h4 class="anchored" data-anchor-id="summary-count-by-model">Summary Count by Model</h4>
<div class="cell" data-hash="index_cache/html/select_best_7aa7140e64db67ca67723e3fb054c71d">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>nested_best_tbl <span class="ot">&lt;-</span> nested_modeltime_tbl <span class="sc">%&gt;%</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">modeltime_nested_select_best</span>(<span class="at">metric =</span> <span class="st">"rmse"</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="co"># * Visualize Best Models ----</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>nested_best_tbl_extract <span class="ot">&lt;-</span> nested_best_tbl <span class="sc">%&gt;%</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_nested_test_forecast</span>() <span class="sc">%&gt;%</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#slice_head(n=10) %&gt;%</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(route, <span class="st">"-"</span>, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"origin"</span>, <span class="st">"dest"</span>), <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(route)</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>model_by_route <span class="ot">&lt;-</span> nested_best_tbl_extract <span class="sc">%&gt;%</span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.model_desc =</span> <span class="fu">ifelse</span>(.model_id <span class="sc">==</span><span class="dv">2</span>,<span class="st">"XGBOOST-tuned"</span>,.model_desc)) <span class="sc">%&gt;%</span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">.model_desc =</span> <span class="fu">str_replace_all</span>(.model_desc,<span class="st">"TEMPORAL HIERARCHICAL FORECASTING MODEL"</span>,<span class="st">"THIEF"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.model_desc =</span> <span class="fu">str_replace_all</span>(.model_desc,<span class="st">"PROPHET W XGBOOST ERRORS"</span>,<span class="st">"PROPHET/XGBOOST"</span>))</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>model_by_route_summ <span class="ot">&lt;-</span> model_by_route <span class="sc">%&gt;%</span> </span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>.model_desc<span class="sc">==</span><span class="st">"ACTUAL"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">model_desc =</span> <span class="fu">first</span>(.model_desc)) <span class="sc">%&gt;%</span></span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(model_desc,<span class="at">name =</span> <span class="st">"number"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(number))</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a> model_by_route_summ <span class="sc">%&gt;%</span> <span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table>
 <thead>
  <tr>
   <th style="text-align:left;"> model_desc </th>
   <th style="text-align:right;"> number </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> THIEF </td>
   <td style="text-align:right;"> 4 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> ARIMA </td>
   <td style="text-align:right;"> 2 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> PROPHET/XGBOOST </td>
   <td style="text-align:right;"> 2 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> KERNLAB </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> XGBOOST-tuned </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</section>
<section id="best-model-by-route" class="level4">
<h4 class="anchored" data-anchor-id="best-model-by-route">Best Model by Route</h4>
<div class="cell" data-hash="index_cache/html/best_by_route_5cc6a74e1fc69f3cc98b0dd607f9bd55">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>best_by_route_summ <span class="ot">&lt;-</span> model_by_route <span class="sc">%&gt;%</span> </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>.model_desc<span class="sc">==</span><span class="st">"ACTUAL"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">route =</span> <span class="fu">first</span>(route),<span class="at">model =</span> <span class="fu">first</span>(.model_desc)) </span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a> best_by_route_summ <span class="sc">%&gt;%</span> <span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table>
 <thead>
  <tr>
   <th style="text-align:left;"> route </th>
   <th style="text-align:left;"> model </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> ADELAIDE-MELBOURNE </td>
   <td style="text-align:left;"> PROPHET/XGBOOST </td>
  </tr>
  <tr>
   <td style="text-align:left;"> ADELAIDE-SYDNEY </td>
   <td style="text-align:left;"> THIEF </td>
  </tr>
  <tr>
   <td style="text-align:left;"> BRISBANE-CAIRNS </td>
   <td style="text-align:left;"> THIEF </td>
  </tr>
  <tr>
   <td style="text-align:left;"> BRISBANE-MELBOURNE </td>
   <td style="text-align:left;"> KERNLAB </td>
  </tr>
  <tr>
   <td style="text-align:left;"> BRISBANE-SYDNEY </td>
   <td style="text-align:left;"> ARIMA </td>
  </tr>
  <tr>
   <td style="text-align:left;"> GOLD COAST-SYDNEY </td>
   <td style="text-align:left;"> THIEF </td>
  </tr>
  <tr>
   <td style="text-align:left;"> MELBOURNE-GOLD COAST </td>
   <td style="text-align:left;"> XGBOOST-tuned </td>
  </tr>
  <tr>
   <td style="text-align:left;"> MELBOURNE-PERTH </td>
   <td style="text-align:left;"> ARIMA </td>
  </tr>
  <tr>
   <td style="text-align:left;"> MELBOURNE-SYDNEY </td>
   <td style="text-align:left;"> THIEF </td>
  </tr>
  <tr>
   <td style="text-align:left;"> PERTH-SYDNEY </td>
   <td style="text-align:left;"> PROPHET/XGBOOST </td>
  </tr>
</tbody>
</table>

</div>
</div>
</section>
</section>
<section id="graph---forecast-v-training-data-aggregated" class="level3" data-number="7.6">
<h3 data-number="7.6" class="anchored" data-anchor-id="graph---forecast-v-training-data-aggregated"><span class="header-section-number">7.6</span> Graph - Forecast v Training Data Aggregated</h3>
<div class="cell" data-hash="index_cache/html/graph_training_b8446ad4479f329928b7c1133006c40c">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>nested_best_tbl_extract_graph <span class="ot">&lt;-</span> nested_best_tbl_extract <span class="sc">%&gt;%</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.key =</span> <span class="fu">ifelse</span>(.key <span class="sc">==</span><span class="st">"actual"</span>,<span class="st">"actual"</span>,<span class="st">"forecast"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.value =</span> <span class="fu">expm1</span>(.value),</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">.conf_lo =</span> <span class="fu">expm1</span>(.conf_lo),</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">.conf_hi =</span> <span class="fu">expm1</span>(.conf_hi)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">%&gt;%</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(.key,.index) <span class="sc">%&gt;%</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">.value =</span> <span class="fu">sum</span>(.value),</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">conf_lo =</span> <span class="fu">sum</span>(.conf_lo,<span class="at">na.rm =</span> T),</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">conf_hi =</span> <span class="fu">sum</span>(.conf_hi,<span class="at">na.rm =</span> T))<span class="sc">%&gt;%</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(.value<span class="sc">&gt;</span><span class="dv">200</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(.index<span class="sc">&gt;</span><span class="fu">dmy</span>(<span class="st">"01-01-2015"</span>))</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> nested_best_tbl_extract_graph <span class="sc">%&gt;%</span></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">#filter((origin == city) | (dest == city) ) %&gt;%</span></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(.index,.value<span class="sc">/</span><span class="dv">1000</span>,<span class="at">color =</span> .key)) <span class="sc">+</span></span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> (conf_lo)<span class="sc">/</span><span class="dv">1000</span>, <span class="at">ymax =</span> (conf_hi)<span class="sc">/</span><span class="dv">1000</span>,</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>                  <span class="at">color =</span> .key), <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels=</span>scales<span class="sc">::</span>comma) <span class="sc">+</span></span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Forecast v Training Data"</span>,<span class="at">x=</span><span class="st">""</span>, <span class="at">y=</span> <span class="st">"pax pm (000)"</span>)</span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>plotly<span class="sc">::</span><span class="fu">ggplotly</span>(g1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-e84d0f08d7d357e75b4b" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-e84d0f08d7d357e75b4b">{"x":{"data":[{"x":[16467,16495,16526,16556,16587,16617,16648,16679,16709,16740,16770,16801,16832,16861,16892,16922,16953,16983,17014,17045,17075,17106,17136,17167,17198,17226,17257,17287,17318,17348,17379,17410,17440,17471,17501,17532,17563,17591,17622,17652,17683,17713,17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[2267.088,2564.303,2486.185,2353.978,2282.05,2685.554,2480.49,2551.754,2747.073,2631.609,2697.458,2605.825,2429.789,2664.662,2557.4,2452.181,2388.173,2715.732,2540.707,2653.284,2746.539,2688.363,2723.291,2657.094,2339.667,2682.172,2610.497,2506.694,2456.765,2770.182,2573.441,2627.842,2841.646,2783.373,2770.941,2689.365,2427.883,2763.062,2671.727,2539.041,2456.599,2799.057,2667.22,2629.623,2859.213,2761.467,2709.283,2696.507,2412.479,2702.086,2666.341,2539.733,2419.869,2781.707],"text":[".index: 2015-02-01<br />.value/1000: 2267.088<br />.key: actual",".index: 2015-03-01<br />.value/1000: 2564.303<br />.key: actual",".index: 2015-04-01<br />.value/1000: 2486.185<br />.key: actual",".index: 2015-05-01<br />.value/1000: 2353.978<br />.key: actual",".index: 2015-06-01<br />.value/1000: 2282.050<br />.key: actual",".index: 2015-07-01<br />.value/1000: 2685.554<br />.key: actual",".index: 2015-08-01<br />.value/1000: 2480.490<br />.key: actual",".index: 2015-09-01<br />.value/1000: 2551.754<br />.key: actual",".index: 2015-10-01<br />.value/1000: 2747.073<br />.key: actual",".index: 2015-11-01<br />.value/1000: 2631.609<br />.key: actual",".index: 2015-12-01<br />.value/1000: 2697.458<br />.key: actual",".index: 2016-01-01<br />.value/1000: 2605.825<br />.key: actual",".index: 2016-02-01<br />.value/1000: 2429.789<br />.key: actual",".index: 2016-03-01<br />.value/1000: 2664.662<br />.key: actual",".index: 2016-04-01<br />.value/1000: 2557.400<br />.key: actual",".index: 2016-05-01<br />.value/1000: 2452.181<br />.key: actual",".index: 2016-06-01<br />.value/1000: 2388.173<br />.key: actual",".index: 2016-07-01<br />.value/1000: 2715.732<br />.key: actual",".index: 2016-08-01<br />.value/1000: 2540.707<br />.key: actual",".index: 2016-09-01<br />.value/1000: 2653.284<br />.key: actual",".index: 2016-10-01<br />.value/1000: 2746.539<br />.key: actual",".index: 2016-11-01<br />.value/1000: 2688.363<br />.key: actual",".index: 2016-12-01<br />.value/1000: 2723.291<br />.key: actual",".index: 2017-01-01<br />.value/1000: 2657.094<br />.key: actual",".index: 2017-02-01<br />.value/1000: 2339.667<br />.key: actual",".index: 2017-03-01<br />.value/1000: 2682.172<br />.key: actual",".index: 2017-04-01<br />.value/1000: 2610.497<br />.key: actual",".index: 2017-05-01<br />.value/1000: 2506.694<br />.key: actual",".index: 2017-06-01<br />.value/1000: 2456.765<br />.key: actual",".index: 2017-07-01<br />.value/1000: 2770.182<br />.key: actual",".index: 2017-08-01<br />.value/1000: 2573.441<br />.key: actual",".index: 2017-09-01<br />.value/1000: 2627.842<br />.key: actual",".index: 2017-10-01<br />.value/1000: 2841.646<br />.key: actual",".index: 2017-11-01<br />.value/1000: 2783.373<br />.key: actual",".index: 2017-12-01<br />.value/1000: 2770.941<br />.key: actual",".index: 2018-01-01<br />.value/1000: 2689.365<br />.key: actual",".index: 2018-02-01<br />.value/1000: 2427.883<br />.key: actual",".index: 2018-03-01<br />.value/1000: 2763.062<br />.key: actual",".index: 2018-04-01<br />.value/1000: 2671.727<br />.key: actual",".index: 2018-05-01<br />.value/1000: 2539.041<br />.key: actual",".index: 2018-06-01<br />.value/1000: 2456.599<br />.key: actual",".index: 2018-07-01<br />.value/1000: 2799.057<br />.key: actual",".index: 2018-08-01<br />.value/1000: 2667.220<br />.key: actual",".index: 2018-09-01<br />.value/1000: 2629.623<br />.key: actual",".index: 2018-10-01<br />.value/1000: 2859.213<br />.key: actual",".index: 2018-11-01<br />.value/1000: 2761.467<br />.key: actual",".index: 2018-12-01<br />.value/1000: 2709.283<br />.key: actual",".index: 2019-01-01<br />.value/1000: 2696.507<br />.key: actual",".index: 2019-02-01<br />.value/1000: 2412.479<br />.key: actual",".index: 2019-03-01<br />.value/1000: 2702.086<br />.key: actual",".index: 2019-04-01<br />.value/1000: 2666.341<br />.key: actual",".index: 2019-05-01<br />.value/1000: 2539.733<br />.key: actual",".index: 2019-06-01<br />.value/1000: 2419.869<br />.key: actual",".index: 2019-07-01<br />.value/1000: 2781.707<br />.key: actual"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"actual","legendgroup":"actual","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078],"y":[2650.0851147513,2676.82354156722,2852.27014613595,2754.9471696969,2774.99282963319,2701.00892183437,2446.69708790861,2733.0555181033,2672.53754874166,2557.99107793091,2483.78519907973,2822.07671219699],"text":[".index: 2018-08-01<br />.value/1000: 2650.085<br />.key: forecast",".index: 2018-09-01<br />.value/1000: 2676.824<br />.key: forecast",".index: 2018-10-01<br />.value/1000: 2852.270<br />.key: forecast",".index: 2018-11-01<br />.value/1000: 2754.947<br />.key: forecast",".index: 2018-12-01<br />.value/1000: 2774.993<br />.key: forecast",".index: 2019-01-01<br />.value/1000: 2701.009<br />.key: forecast",".index: 2019-02-01<br />.value/1000: 2446.697<br />.key: forecast",".index: 2019-03-01<br />.value/1000: 2733.056<br />.key: forecast",".index: 2019-04-01<br />.value/1000: 2672.538<br />.key: forecast",".index: 2019-05-01<br />.value/1000: 2557.991<br />.key: forecast",".index: 2019-06-01<br />.value/1000: 2483.785<br />.key: forecast",".index: 2019-07-01<br />.value/1000: 2822.077<br />.key: forecast"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","name":"forecast","legendgroup":"forecast","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[16467,16495,16526,16556,16587,16617,16648,16679,16709,16740,16770,16801,16832,16861,16892,16922,16953,16983,17014,17045,17075,17106,17136,17167,17198,17226,17257,17287,17318,17348,17379,17410,17440,17471,17501,17532,17563,17591,17622,17652,17683,17713,17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078,18078,18048,18017,17987,17956,17928,17897,17866,17836,17805,17775,17744,17713,17683,17652,17622,17591,17563,17532,17501,17471,17440,17410,17379,17348,17318,17287,17257,17226,17198,17167,17136,17106,17075,17045,17014,16983,16953,16922,16892,16861,16832,16801,16770,16740,16709,16679,16648,16617,16587,16556,16526,16495,16467,16467],"y":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"text":[".index: 2015-02-01<br />.value/1000: 2267.088<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2015-03-01<br />.value/1000: 2564.303<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2015-04-01<br />.value/1000: 2486.185<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2015-05-01<br />.value/1000: 2353.978<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2015-06-01<br />.value/1000: 2282.050<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2015-07-01<br />.value/1000: 2685.554<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2015-08-01<br />.value/1000: 2480.490<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2015-09-01<br />.value/1000: 2551.754<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2015-10-01<br />.value/1000: 2747.073<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2015-11-01<br />.value/1000: 2631.609<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2015-12-01<br />.value/1000: 2697.458<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2016-01-01<br />.value/1000: 2605.825<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2016-02-01<br />.value/1000: 2429.789<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2016-03-01<br />.value/1000: 2664.662<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2016-04-01<br />.value/1000: 2557.400<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2016-05-01<br />.value/1000: 2452.181<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2016-06-01<br />.value/1000: 2388.173<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2016-07-01<br />.value/1000: 2715.732<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2016-08-01<br />.value/1000: 2540.707<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2016-09-01<br />.value/1000: 2653.284<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2016-10-01<br />.value/1000: 2746.539<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2016-11-01<br />.value/1000: 2688.363<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2016-12-01<br />.value/1000: 2723.291<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2017-01-01<br />.value/1000: 2657.094<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2017-02-01<br />.value/1000: 2339.667<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2017-03-01<br />.value/1000: 2682.172<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2017-04-01<br />.value/1000: 2610.497<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2017-05-01<br />.value/1000: 2506.694<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2017-06-01<br />.value/1000: 2456.765<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2017-07-01<br />.value/1000: 2770.182<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2017-08-01<br />.value/1000: 2573.441<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2017-09-01<br />.value/1000: 2627.842<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2017-10-01<br />.value/1000: 2841.646<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2017-11-01<br />.value/1000: 2783.373<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2017-12-01<br />.value/1000: 2770.941<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2018-01-01<br />.value/1000: 2689.365<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2018-02-01<br />.value/1000: 2427.883<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2018-03-01<br />.value/1000: 2763.062<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2018-04-01<br />.value/1000: 2671.727<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2018-05-01<br />.value/1000: 2539.041<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2018-06-01<br />.value/1000: 2456.599<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2018-07-01<br />.value/1000: 2799.057<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2018-08-01<br />.value/1000: 2667.220<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2018-09-01<br />.value/1000: 2629.623<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2018-10-01<br />.value/1000: 2859.213<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2018-11-01<br />.value/1000: 2761.467<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2018-12-01<br />.value/1000: 2709.283<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2019-01-01<br />.value/1000: 2696.507<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2019-02-01<br />.value/1000: 2412.479<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2019-03-01<br />.value/1000: 2702.086<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2019-04-01<br />.value/1000: 2666.341<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2019-05-01<br />.value/1000: 2539.733<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2019-06-01<br />.value/1000: 2419.869<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2019-07-01<br />.value/1000: 2781.707<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2019-07-01<br />.value/1000: 2781.707<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2019-06-01<br />.value/1000: 2419.869<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2019-05-01<br />.value/1000: 2539.733<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2019-04-01<br />.value/1000: 2666.341<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2019-03-01<br />.value/1000: 2702.086<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2019-02-01<br />.value/1000: 2412.479<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2019-01-01<br />.value/1000: 2696.507<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2018-12-01<br />.value/1000: 2709.283<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2018-11-01<br />.value/1000: 2761.467<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2018-10-01<br />.value/1000: 2859.213<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2018-09-01<br />.value/1000: 2629.623<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2018-08-01<br />.value/1000: 2667.220<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2018-07-01<br />.value/1000: 2799.057<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2018-06-01<br />.value/1000: 2456.599<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2018-05-01<br />.value/1000: 2539.041<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2018-04-01<br />.value/1000: 2671.727<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2018-03-01<br />.value/1000: 2763.062<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2018-02-01<br />.value/1000: 2427.883<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2018-01-01<br />.value/1000: 2689.365<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2017-12-01<br />.value/1000: 2770.941<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2017-11-01<br />.value/1000: 2783.373<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2017-10-01<br />.value/1000: 2841.646<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2017-09-01<br />.value/1000: 2627.842<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2017-08-01<br />.value/1000: 2573.441<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2017-07-01<br />.value/1000: 2770.182<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2017-06-01<br />.value/1000: 2456.765<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2017-05-01<br />.value/1000: 2506.694<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2017-04-01<br />.value/1000: 2610.497<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2017-03-01<br />.value/1000: 2682.172<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2017-02-01<br />.value/1000: 2339.667<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2017-01-01<br />.value/1000: 2657.094<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2016-12-01<br />.value/1000: 2723.291<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2016-11-01<br />.value/1000: 2688.363<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2016-10-01<br />.value/1000: 2746.539<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2016-09-01<br />.value/1000: 2653.284<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2016-08-01<br />.value/1000: 2540.707<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2016-07-01<br />.value/1000: 2715.732<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2016-06-01<br />.value/1000: 2388.173<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2016-05-01<br />.value/1000: 2452.181<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2016-04-01<br />.value/1000: 2557.400<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2016-03-01<br />.value/1000: 2664.662<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2016-02-01<br />.value/1000: 2429.789<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2016-01-01<br />.value/1000: 2605.825<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2015-12-01<br />.value/1000: 2697.458<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2015-11-01<br />.value/1000: 2631.609<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2015-10-01<br />.value/1000: 2747.073<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2015-09-01<br />.value/1000: 2551.754<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2015-08-01<br />.value/1000: 2480.490<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2015-07-01<br />.value/1000: 2685.554<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2015-06-01<br />.value/1000: 2282.050<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2015-05-01<br />.value/1000: 2353.978<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2015-04-01<br />.value/1000: 2486.185<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2015-03-01<br />.value/1000: 2564.303<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2015-02-01<br />.value/1000: 2267.088<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000",".index: 2015-02-01<br />.value/1000: 2267.088<br />.key: actual<br />(conf_lo)/1000:    0.000<br />(conf_hi)/1000:    0.000"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(248,118,109,0.2)","dash":"solid"},"fill":"toself","fillcolor":"rgba(51,51,51,0.2)","hoveron":"points","name":"actual","legendgroup":"actual","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078,18078,18078,18048,18017,17987,17956,17928,17897,17866,17836,17805,17775,17744,17744],"y":[2511.73088644486,2536.9719500279,2703.0996415305,2611.25630136278,2629.76621572953,2559.59344466786,2319.57058202047,2590.8890506321,2532.68681691823,2424.68552446371,2353.90203192556,2674.19988074897,2674.19988074897,2978.53404446405,2621.18403450781,2698.97166900094,2820.48458033652,2883.38595942363,2581.12279306262,2850.63776405569,2928.63454735937,2906.92819007137,3010.07863488043,2824.76464089329,2796.43160273367,2511.73088644486],"text":[".index: 2018-08-01<br />.value/1000: 2650.085<br />.key: forecast<br />(conf_lo)/1000: 2511.731<br />(conf_hi)/1000: 2796.432",".index: 2018-09-01<br />.value/1000: 2676.824<br />.key: forecast<br />(conf_lo)/1000: 2536.972<br />(conf_hi)/1000: 2824.765",".index: 2018-10-01<br />.value/1000: 2852.270<br />.key: forecast<br />(conf_lo)/1000: 2703.100<br />(conf_hi)/1000: 3010.079",".index: 2018-11-01<br />.value/1000: 2754.947<br />.key: forecast<br />(conf_lo)/1000: 2611.256<br />(conf_hi)/1000: 2906.928",".index: 2018-12-01<br />.value/1000: 2774.993<br />.key: forecast<br />(conf_lo)/1000: 2629.766<br />(conf_hi)/1000: 2928.635",".index: 2019-01-01<br />.value/1000: 2701.009<br />.key: forecast<br />(conf_lo)/1000: 2559.593<br />(conf_hi)/1000: 2850.638",".index: 2019-02-01<br />.value/1000: 2446.697<br />.key: forecast<br />(conf_lo)/1000: 2319.571<br />(conf_hi)/1000: 2581.123",".index: 2019-03-01<br />.value/1000: 2733.056<br />.key: forecast<br />(conf_lo)/1000: 2590.889<br />(conf_hi)/1000: 2883.386",".index: 2019-04-01<br />.value/1000: 2672.538<br />.key: forecast<br />(conf_lo)/1000: 2532.687<br />(conf_hi)/1000: 2820.485",".index: 2019-05-01<br />.value/1000: 2557.991<br />.key: forecast<br />(conf_lo)/1000: 2424.686<br />(conf_hi)/1000: 2698.972",".index: 2019-06-01<br />.value/1000: 2483.785<br />.key: forecast<br />(conf_lo)/1000: 2353.902<br />(conf_hi)/1000: 2621.184",".index: 2019-07-01<br />.value/1000: 2822.077<br />.key: forecast<br />(conf_lo)/1000: 2674.200<br />(conf_hi)/1000: 2978.534",".index: 2019-07-01<br />.value/1000: 2822.077<br />.key: forecast<br />(conf_lo)/1000: 2674.200<br />(conf_hi)/1000: 2978.534",".index: 2019-07-01<br />.value/1000: 2822.077<br />.key: forecast<br />(conf_lo)/1000: 2674.200<br />(conf_hi)/1000: 2978.534",".index: 2019-06-01<br />.value/1000: 2483.785<br />.key: forecast<br />(conf_lo)/1000: 2353.902<br />(conf_hi)/1000: 2621.184",".index: 2019-05-01<br />.value/1000: 2557.991<br />.key: forecast<br />(conf_lo)/1000: 2424.686<br />(conf_hi)/1000: 2698.972",".index: 2019-04-01<br />.value/1000: 2672.538<br />.key: forecast<br />(conf_lo)/1000: 2532.687<br />(conf_hi)/1000: 2820.485",".index: 2019-03-01<br />.value/1000: 2733.056<br />.key: forecast<br />(conf_lo)/1000: 2590.889<br />(conf_hi)/1000: 2883.386",".index: 2019-02-01<br />.value/1000: 2446.697<br />.key: forecast<br />(conf_lo)/1000: 2319.571<br />(conf_hi)/1000: 2581.123",".index: 2019-01-01<br />.value/1000: 2701.009<br />.key: forecast<br />(conf_lo)/1000: 2559.593<br />(conf_hi)/1000: 2850.638",".index: 2018-12-01<br />.value/1000: 2774.993<br />.key: forecast<br />(conf_lo)/1000: 2629.766<br />(conf_hi)/1000: 2928.635",".index: 2018-11-01<br />.value/1000: 2754.947<br />.key: forecast<br />(conf_lo)/1000: 2611.256<br />(conf_hi)/1000: 2906.928",".index: 2018-10-01<br />.value/1000: 2852.270<br />.key: forecast<br />(conf_lo)/1000: 2703.100<br />(conf_hi)/1000: 3010.079",".index: 2018-09-01<br />.value/1000: 2676.824<br />.key: forecast<br />(conf_lo)/1000: 2536.972<br />(conf_hi)/1000: 2824.765",".index: 2018-08-01<br />.value/1000: 2650.085<br />.key: forecast<br />(conf_lo)/1000: 2511.731<br />(conf_hi)/1000: 2796.432",".index: 2018-08-01<br />.value/1000: 2650.085<br />.key: forecast<br />(conf_lo)/1000: 2511.731<br />(conf_hi)/1000: 2796.432"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,196,0.2)","dash":"solid"},"fill":"toself","fillcolor":"rgba(51,51,51,0.2)","hoveron":"points","name":"forecast","legendgroup":"forecast","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":43.7625570776256,"r":7.30593607305936,"b":25.5707762557078,"l":54.7945205479452},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"title":{"text":"Forecast v Training Data","font":{"color":"rgba(0,0,0,1)","family":"","size":17.5342465753425},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[16386.45,18158.55],"tickmode":"array","ticktext":["2015","2016","2017","2018","2019"],"tickvals":[16436,16801,17167,17532,17897],"categoryorder":"array","categoryarray":["2015","2016","2017","2018","2019"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-150.503931744022,3160.58256662445],"tickmode":"array","ticktext":["0","1,000","2,000","3,000"],"tickvals":[0,1000,2000,3000],"categoryorder":"array","categoryarray":["0","1,000","2,000","3,000"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"pax pm (000)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"title":{"text":".key","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"70087cfb1582":{"x":{},"y":{},"colour":{},"type":"scatter"},"700864ef194":{"x":{},"y":{},"colour":{},"ymin":{},"ymax":{}}},"cur_data":"70087cfb1582","visdat":{"70087cfb1582":["function (y) ","x"],"700864ef194":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="training-forecast-accuracy-by-best-model---top-10-routes" class="level3" data-number="7.7">
<h3 data-number="7.7" class="anchored" data-anchor-id="training-forecast-accuracy-by-best-model---top-10-routes"><span class="header-section-number">7.7</span> Training Forecast Accuracy by Best Model - top 10 routes</h3>
<div class="cell" data-hash="index_cache/html/training_fcast_acc_c20edd3e82bcf61fa412c8f1d2deadc4">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 8
   route                   mae  mape maape  mase smape   rmse   rsq
   &lt;fct&gt;                 &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
 1 GOLD COAST-SYDNEY     3475.  1.57  1.57 0.162  1.56  4072. 0.949
 2 BRISBANE-SYDNEY       7510.  1.91  1.91 0.324  1.88  9369. 0.896
 3 MELBOURNE-SYDNEY     14696.  1.96  1.96 0.317  1.93 18020. 0.810
 4 BRISBANE-MELBOURNE    6482.  2.15  2.15 0.291  2.16  7680. 0.887
 5 PERTH-SYDNEY          3190.  2.23  2.23 0.316  2.20  4006. 0.881
 6 MELBOURNE-PERTH       3862.  2.20  2.20 0.249  2.21  5700. 0.833
 7 ADELAIDE-MELBOURNE    5474.  2.66  2.66 0.413  2.66  6182. 0.712
 8 ADELAIDE-SYDNEY       4372.  2.82  2.82 0.380  2.79  4550. 0.928
 9 MELBOURNE-GOLD COAST  5857.  3.30  3.29 0.257  3.34  7317. 0.892
10 BRISBANE-CAIRNS       3760.  3.56  3.56 0.536  3.48  4305. 0.907</code></pre>
</div>
</div>
</section>
<section id="refit-nested-model" class="level3" data-number="7.8">
<h3 data-number="7.8" class="anchored" data-anchor-id="refit-nested-model"><span class="header-section-number">7.8</span> Refit Nested Model</h3>
<div class="cell" data-hash="index_cache/html/refit_7ae223a2512dd21ecc99085314b93119">

</div>
<section id="graph" class="level4">
<h4 class="anchored" data-anchor-id="graph">Graph</h4>
<div class="cell" data-hash="index_cache/html/graph_fcast_7b54e6f4a1a4dccf5a06878707b93c64">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># * Visualize Future Forecast ----</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>nested_best_refit_tb_data <span class="ot">&lt;-</span> nested_best_refit_tbl <span class="sc">%&gt;%</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_nested_future_forecast</span>() <span class="sc">%&gt;%</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(route_prep_validation <span class="sc">%&gt;%</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">.key =</span> <span class="st">"actual_validn"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>              <span class="fu">select</span>(route,<span class="at">.index =</span> date,.key,<span class="at">.value =</span> passenger_trips)) <span class="sc">%&gt;%</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(.value<span class="sc">:</span>.conf_hi, expm1)) <span class="sc">%&gt;%</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(route, <span class="st">"-"</span>, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"origin"</span>, <span class="st">"dest"</span>),<span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.model_desc =</span> <span class="fu">ifelse</span>(.model_id <span class="sc">==</span><span class="dv">2</span>,<span class="st">"XGBOOST-tuned"</span>,.model_desc),</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">.model_desc =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(.model_id),.key,.model_desc)) <span class="sc">%&gt;%</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.model_desc =</span> <span class="fu">str_replace_all</span>(.model_desc,<span class="st">"TEMPORAL HIERARCHICAL FORECASTING MODEL"</span>,<span class="st">"THIEF"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.model_desc =</span> <span class="fu">str_replace_all</span>(.model_desc,<span class="st">"PROPHET W XGBOOST ERRORS"</span>,<span class="st">"PROPHET/XGBOOST"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(origin == city) %&gt;%</span></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(dest %in% c("MELBOURNE","SYDNEY","CAIRNS","HOBART")) %&gt;%</span></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">year</span>(.index)<span class="sc">&gt;</span><span class="dv">2015</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(route)</span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a><span class="co"># nested_best_refit_tb_data %&gt;%</span></span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(.index &gt; end,.key =="actual_validn")</span></span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>nested_best_refit_tb_data <span class="sc">%&gt;%</span></span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span> .index, <span class="at">y=</span>.value, <span class="at">colour =</span> .model_desc))<span class="sc">+</span></span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> comma) <span class="sc">+</span></span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"pax pm(000)"</span>) <span class="sc">+</span></span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> route,  <span class="at">ncol=</span><span class="dv">2</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/graph_fcast-1.png" class="img-fluid" width="960"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>  <span class="co">#filter((origin == city) | (dest == city) ) %&gt;%</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot_modeltime_forecast(</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   .trelliscope = FALSE,</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   .facet_ncol  = 1</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   </span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   #.trelliscope_params = list(width ="100%")</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   )</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Not a great performance against actuals, post covid in Feb 2020, but that is as expected! Pre-covid prediction looks good.</p>
</section>
<section id="accuracy-of-refit---prepost-covid" class="level4">
<h4 class="anchored" data-anchor-id="accuracy-of-refit---prepost-covid">Accuracy of refit - Pre/post covid</h4>
<div class="cell" data-hash="index_cache/html/unnamed-chunk-3_904423a570cbd5bbd747cff9cb056ef8">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co">#unique(refit_model_by_route_acc_data$.key)</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>               </span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>refit_model_by_route_acc_data <span class="ot">&lt;-</span> nested_best_refit_tb_data <span class="sc">%&gt;%</span> </span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># filter(.index &gt;max(route_prep_nested_test$date),</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">#        .index &lt;= d2</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ) %&gt;% </span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">#mutate(.key = ifelse(.key =="actual","actual","forecast")) %&gt;%</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">pax_nos =</span> .value,</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">date =</span> .index) <span class="sc">%&gt;%</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>(route_prep_validation <span class="sc">%&gt;%</span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">.key =</span> <span class="st">"actual"</span>,</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>                     <span class="at">passenger_trips =</span> <span class="fu">expm1</span>(passenger_trips)</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>                     ) <span class="sc">%&gt;%</span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>              <span class="fu">select</span>(route,date,.key, <span class="at">pax_nos =</span> passenger_trips)) <span class="sc">%&gt;%</span> </span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(route, .key, date) <span class="sc">%&gt;%</span></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">pax_nos =</span> <span class="fu">sum</span>(pax_nos,<span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> .key,</span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from  =</span> pax_nos</span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a>accuracy_predn_precovid <span class="ot">&lt;-</span> refit_model_by_route_acc_data <span class="sc">%&gt;%</span> </span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a>   <span class="fu">filter</span>(date <span class="sc">&gt;</span>  max_test,</span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a>          date <span class="sc">&lt;=</span> end_precovid</span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a>   ) <span class="sc">%&gt;%</span></span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize_accuracy_metrics</span>(</span>
<span id="cb41-29"><a href="#cb41-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">truth =</span> actual_validn,</span>
<span id="cb41-30"><a href="#cb41-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">estimate =</span> prediction,</span>
<span id="cb41-31"><a href="#cb41-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">metric_set =</span> <span class="fu">extended_forecast_accuracy_metric_set</span>()</span>
<span id="cb41-32"><a href="#cb41-32" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(smape)</span>
<span id="cb41-33"><a href="#cb41-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-34"><a href="#cb41-34" aria-hidden="true" tabindex="-1"></a>accuracy_predn_postcovid <span class="ot">&lt;-</span> refit_model_by_route_acc_data <span class="sc">%&gt;%</span> </span>
<span id="cb41-35"><a href="#cb41-35" aria-hidden="true" tabindex="-1"></a>   <span class="fu">filter</span>(date <span class="sc">&gt;</span>  end_precovid,</span>
<span id="cb41-36"><a href="#cb41-36" aria-hidden="true" tabindex="-1"></a>          date <span class="sc">&lt;=</span> max_act</span>
<span id="cb41-37"><a href="#cb41-37" aria-hidden="true" tabindex="-1"></a>   ) <span class="sc">%&gt;%</span></span>
<span id="cb41-38"><a href="#cb41-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize_accuracy_metrics</span>(</span>
<span id="cb41-39"><a href="#cb41-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">truth =</span> actual_validn,</span>
<span id="cb41-40"><a href="#cb41-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">estimate =</span> prediction,</span>
<span id="cb41-41"><a href="#cb41-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">metric_set =</span> <span class="fu">extended_forecast_accuracy_metric_set</span>()</span>
<span id="cb41-42"><a href="#cb41-42" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(smape)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>For obvious reasons the accuracy of predictions against actuals is not great after the covid started (say Feb 2020), after all we did not even give the models the benefit of ‘seeing’ the covid crash. That was not the point of this analysis..although we may revisit as more post covid data is available.</p>
<p>We can also check accuracy at an aggregated (across all routes) level.</p>
<div class="cell" data-hash="index_cache/html/accuracy_aggr_f82c8006c18ccf1edc79d4d889dda4dc">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>refit_model_aggr_acc_data <span class="ot">&lt;-</span> refit_model_by_route_acc_data <span class="sc">%&gt;%</span> </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(date) <span class="sc">%&gt;%</span> </span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">actual   =</span> <span class="fu">sum</span>(actual,<span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">prediction =</span> <span class="fu">sum</span>(prediction,<span class="at">na.rm =</span> <span class="cn">TRUE</span>)) </span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>accuracy_predn_agg_precovid <span class="ot">&lt;-</span> refit_model_aggr_acc_data <span class="sc">%&gt;%</span> </span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">filter</span>(date <span class="sc">&gt;</span>  max_test,</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>          date <span class="sc">&lt;=</span> end_precovid</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>   ) <span class="sc">%&gt;%</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize_accuracy_metrics</span>(</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">truth      =</span> actual,</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">estimate   =</span> prediction,</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">metric_set =</span> <span class="fu">extended_forecast_accuracy_metric_set</span>()</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(smape)</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>  accuracy_predn_agg_postcovid <span class="ot">&lt;-</span> refit_model_aggr_acc_data <span class="sc">%&gt;%</span> </span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>   <span class="fu">filter</span>(date <span class="sc">&gt;</span>  end_precovid,</span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>          date <span class="sc">&lt;=</span> max_act</span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>   ) <span class="sc">%&gt;%</span></span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize_accuracy_metrics</span>(</span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">truth      =</span> actual,</span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">estimate   =</span> prediction,</span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">metric_set =</span> <span class="fu">extended_forecast_accuracy_metric_set</span>()</span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(smape)</span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a>agg_pred_accuracy <span class="ot">&lt;-</span> accuracy_predn_agg_precovid <span class="sc">%&gt;%</span> </span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">period =</span> <span class="st">"pre_covid"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(accuracy_predn_agg_postcovid <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">period =</span> <span class="st">"post_covid"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(period,<span class="fu">everything</span>())</span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true" tabindex="-1"></a>agg_pred_accuracy <span class="sc">%&gt;%</span> </span>
<span id="cb42-33"><a href="#cb42-33" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">gt</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb42-34"><a href="#cb42-34" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">fmt_number</span>(</span>
<span id="cb42-35"><a href="#cb42-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="sc">!</span>period,</span>
<span id="cb42-36"><a href="#cb42-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">3</span></span>
<span id="cb42-37"><a href="#cb42-37" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div id="ifwucklyfa" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

:where(#ifwucklyfa) .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

:where(#ifwucklyfa) .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

:where(#ifwucklyfa) .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

:where(#ifwucklyfa) .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

:where(#ifwucklyfa) .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

:where(#ifwucklyfa) .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#ifwucklyfa) .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

:where(#ifwucklyfa) .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

:where(#ifwucklyfa) .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

:where(#ifwucklyfa) .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

:where(#ifwucklyfa) .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

:where(#ifwucklyfa) .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

:where(#ifwucklyfa) .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

:where(#ifwucklyfa) .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

:where(#ifwucklyfa) .gt_from_md > :first-child {
  margin-top: 0;
}

:where(#ifwucklyfa) .gt_from_md > :last-child {
  margin-bottom: 0;
}

:where(#ifwucklyfa) .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

:where(#ifwucklyfa) .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#ifwucklyfa) .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

:where(#ifwucklyfa) .gt_row_group_first td {
  border-top-width: 2px;
}

:where(#ifwucklyfa) .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#ifwucklyfa) .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

:where(#ifwucklyfa) .gt_first_summary_row.thick {
  border-top-width: 2px;
}

:where(#ifwucklyfa) .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#ifwucklyfa) .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#ifwucklyfa) .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

:where(#ifwucklyfa) .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

:where(#ifwucklyfa) .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#ifwucklyfa) .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

:where(#ifwucklyfa) .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#ifwucklyfa) .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

:where(#ifwucklyfa) .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#ifwucklyfa) .gt_left {
  text-align: left;
}

:where(#ifwucklyfa) .gt_center {
  text-align: center;
}

:where(#ifwucklyfa) .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

:where(#ifwucklyfa) .gt_font_normal {
  font-weight: normal;
}

:where(#ifwucklyfa) .gt_font_bold {
  font-weight: bold;
}

:where(#ifwucklyfa) .gt_font_italic {
  font-style: italic;
}

:where(#ifwucklyfa) .gt_super {
  font-size: 65%;
}

:where(#ifwucklyfa) .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

:where(#ifwucklyfa) .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

:where(#ifwucklyfa) .gt_indent_1 {
  text-indent: 5px;
}

:where(#ifwucklyfa) .gt_indent_2 {
  text-indent: 10px;
}

:where(#ifwucklyfa) .gt_indent_3 {
  text-indent: 15px;
}

:where(#ifwucklyfa) .gt_indent_4 {
  text-indent: 20px;
}

:where(#ifwucklyfa) .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="period">period</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="mae">mae</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="mape">mape</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="maape">maape</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="mase">mase</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="smape">smape</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="rmse">rmse</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="rsq">rsq</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="period" class="gt_row gt_left">pre_covid</td>
<td headers="mae" class="gt_row gt_right">40,507.912</td>
<td headers="mape" class="gt_row gt_right">1.589</td>
<td headers="maape" class="gt_row gt_right">1.588</td>
<td headers="mase" class="gt_row gt_right">0.262</td>
<td headers="smape" class="gt_row gt_right">1.572</td>
<td headers="rmse" class="gt_row gt_right">63,948.883</td>
<td headers="rsq" class="gt_row gt_right">0.989</td></tr>
    <tr><td headers="period" class="gt_row gt_left">post_covid</td>
<td headers="mae" class="gt_row gt_right">1,168,496.081</td>
<td headers="mape" class="gt_row gt_right">410.556</td>
<td headers="maape" class="gt_row gt_right">88.088</td>
<td headers="mase" class="gt_row gt_right">3.947</td>
<td headers="smape" class="gt_row gt_right">192.184</td>
<td headers="rmse" class="gt_row gt_right">1,459,628.829</td>
<td headers="rsq" class="gt_row gt_right">0.065</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>Obviously the pre and post covid volumes are much different so a lot of measures are not appropriate, but all look reasonable pre-covid and horrible thereafter, as expected.</p>
<p>The following graph breaks the actuals into the various periods - training, testing, pre-covid prediction, post covid (Feb2020) prediction, and more recently when no prediction was attempted, so data is just for information.</p>
<p>So the pre-covid prediction looks good, which is really all we were asking of the models.</p>
<p>Now lets graph the aggregated (all routes) prediction against actuals. Actuals are colour coded to show all modelling stages. For our purposes the key is the comparison of the “prediction” to the “actual_precovid_prediction”, ie the actuals after the test period but before covid kicks in (ie pink v green line), which looks pretty good.</p>
<p>The rest just highlights why forecast/predictions can only go so far…</p>
<div class="cell" data-hash="index_cache/html/graph_agg_pred_cfabbe65df0e2254b650f94e5073b0ad">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>refit_model_aggr_acc_data <span class="sc">%&gt;%</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols      =</span> <span class="sc">!</span>date,</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to  =</span> <span class="st">"actual_prediction"</span>,</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"pax_nos"</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span>  </span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">actual_prediction =</span> </span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">case_when</span>(</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>      actual_prediction <span class="sc">==</span> <span class="st">"prediction"</span> <span class="sc">~</span> <span class="st">"prediction"</span>,</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>      date              <span class="sc">&lt;=</span> max_train    <span class="sc">~</span> <span class="st">"actual_train"</span>,</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>      date              <span class="sc">&lt;=</span> max_test     <span class="sc">~</span> <span class="st">"actual_test"</span>,</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>      date              <span class="sc">&lt;=</span> end_precovid <span class="sc">~</span> <span class="st">"actual_precovid"</span>,</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>      date              <span class="sc">&lt;=</span> max_pred     <span class="sc">~</span> <span class="st">"actual_postcovid"</span>,</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span>                              <span class="sc">~</span> <span class="st">"actual_post_prediction"</span></span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pax_nos =</span> <span class="fu">ifelse</span>(pax_nos <span class="sc">==</span> <span class="dv">0</span>, <span class="cn">NA</span>,pax_nos)) <span class="sc">%&gt;%</span> </span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>date, <span class="at">y=</span>pax_nos<span class="sc">/</span><span class="dv">1000</span>,<span class="at">colour =</span> actual_prediction ))<span class="sc">+</span></span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">"Passenger No's pm (000)"</span>,</span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">breaks_extended</span>(<span class="dv">8</span>),</span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_comma</span>()  </span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/graph_agg_pred-1.png" class="img-fluid" width="672"></p>
</div>
</div>


<!-- -->

</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb44" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Flight Forecast with ML Nested models"</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Stephen J Parton"</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "2022-12-12"</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span><span class="co"> [code, analytics, flights, forecasting]</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="an">website:</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a><span class="co">  sidebar:</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a><span class="co">    style: "docked"</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a><span class="co">    search: true</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a><span class="co">  html: </span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a><span class="co">    theme: litera</span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a><span class="an">toc:</span><span class="co"> true</span></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a><span class="an">toc-title:</span><span class="co"> Contents</span></span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a><span class="an">number-sections:</span><span class="co"> true</span></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a><span class="an">number-depth:</span><span class="co"> 3</span></span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a><span class="an">code-fold:</span><span class="co"> true</span></span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a><span class="an">code-summary:</span><span class="co"> "Code"</span></span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a><span class="an">code-tools:</span><span class="co"> true</span></span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span><span class="co"> </span></span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a><span class="co">  echo: true</span></span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a><span class="co">  error: false</span></span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a><span class="an">freeze:</span><span class="co"> true</span></span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a><span class="an">cache:</span><span class="co"> true</span></span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a><span class="al">![](thumbnail.png)</span></span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-30"><a href="#cb44-30" aria-hidden="true" tabindex="-1"></a><span class="fu">## Introduction</span></span>
<span id="cb44-31"><a href="#cb44-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-32"><a href="#cb44-32" aria-hidden="true" tabindex="-1"></a>This file runs a nested forecasting approach on top Australian domestic routes (70 or so) prior to covid. This is just an exploratory exercise and remains a work in progress.</span>
<span id="cb44-33"><a href="#cb44-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-34"><a href="#cb44-34" aria-hidden="true" tabindex="-1"></a>This analysis uses ML Models as follows</span>
<span id="cb44-35"><a href="#cb44-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-36"><a href="#cb44-36" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Auto ARIMA</span>
<span id="cb44-37"><a href="#cb44-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-38"><a href="#cb44-38" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>XGBoost</span>
<span id="cb44-39"><a href="#cb44-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-40"><a href="#cb44-40" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Prophet Boost</span>
<span id="cb44-41"><a href="#cb44-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-42"><a href="#cb44-42" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Random Forest</span>
<span id="cb44-43"><a href="#cb44-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-44"><a href="#cb44-44" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>SVM</span>
<span id="cb44-45"><a href="#cb44-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-46"><a href="#cb44-46" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Neural Net</span>
<span id="cb44-47"><a href="#cb44-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-48"><a href="#cb44-48" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>MARS</span>
<span id="cb44-49"><a href="#cb44-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-50"><a href="#cb44-50" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>THIEF</span>
<span id="cb44-51"><a href="#cb44-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-52"><a href="#cb44-52" aria-hidden="true" tabindex="-1"></a>Only XGBoost/ Prophet Boost have been tuned (based on Syd-Melb route only and using the same hyper-parameters as appropriate).</span>
<span id="cb44-53"><a href="#cb44-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-54"><a href="#cb44-54" aria-hidden="true" tabindex="-1"></a>The forecast period is 12 months from end of testing, which is July 2019, so missing the Covid dive, which is still shown.</span>
<span id="cb44-55"><a href="#cb44-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-56"><a href="#cb44-56" aria-hidden="true" tabindex="-1"></a>This will all look better in a Shiny app, coming soon...</span>
<span id="cb44-57"><a href="#cb44-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-58"><a href="#cb44-58" aria-hidden="true" tabindex="-1"></a><span class="fu">## Load Packages</span></span>
<span id="cb44-59"><a href="#cb44-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-60"><a href="#cb44-60" aria-hidden="true" tabindex="-1"></a>Tidyverse, Tidymodels, Modeltime, parallel processing etc.</span>
<span id="cb44-61"><a href="#cb44-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-62"><a href="#cb44-62" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, packages}</span></span>
<span id="cb44-63"><a href="#cb44-63" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb44-64"><a href="#cb44-64" aria-hidden="true" tabindex="-1"></a><span class="co">#| warninng: false</span></span>
<span id="cb44-65"><a href="#cb44-65" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb44-66"><a href="#cb44-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-67"><a href="#cb44-67" aria-hidden="true" tabindex="-1"></a><span class="co"># Time Series ML</span></span>
<span id="cb44-68"><a href="#cb44-68" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidymodels)</span>
<span id="cb44-69"><a href="#cb44-69" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(modeltime)</span>
<span id="cb44-70"><a href="#cb44-70" aria-hidden="true" tabindex="-1"></a><span class="co">#library(modeltime.gluonts)</span></span>
<span id="cb44-71"><a href="#cb44-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-72"><a href="#cb44-72" aria-hidden="true" tabindex="-1"></a><span class="co"># Core</span></span>
<span id="cb44-73"><a href="#cb44-73" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb44-74"><a href="#cb44-74" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb44-75"><a href="#cb44-75" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(timetk)</span>
<span id="cb44-76"><a href="#cb44-76" aria-hidden="true" tabindex="-1"></a><span class="co">#library(knitr)</span></span>
<span id="cb44-77"><a href="#cb44-77" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb44-78"><a href="#cb44-78" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb44-79"><a href="#cb44-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-80"><a href="#cb44-80" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb44-81"><a href="#cb44-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-82"><a href="#cb44-82" aria-hidden="true" tabindex="-1"></a><span class="co"># Viz</span></span>
<span id="cb44-83"><a href="#cb44-83" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(trelliscopejs)</span>
<span id="cb44-84"><a href="#cb44-84" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb44-85"><a href="#cb44-85" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb44-86"><a href="#cb44-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-87"><a href="#cb44-87" aria-hidden="true" tabindex="-1"></a><span class="co"># Timing &amp; Parallel Processing</span></span>
<span id="cb44-88"><a href="#cb44-88" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tictoc)</span>
<span id="cb44-89"><a href="#cb44-89" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(future)</span>
<span id="cb44-90"><a href="#cb44-90" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(doFuture)</span>
<span id="cb44-91"><a href="#cb44-91" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(doRNG)</span>
<span id="cb44-92"><a href="#cb44-92" aria-hidden="true" tabindex="-1"></a>doFuture.rng.onMisuse <span class="ot">=</span> <span class="st">"ignore"</span></span>
<span id="cb44-93"><a href="#cb44-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-94"><a href="#cb44-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-95"><a href="#cb44-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-96"><a href="#cb44-96" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-97"><a href="#cb44-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-98"><a href="#cb44-98" aria-hidden="true" tabindex="-1"></a><span class="fu">## Load Data</span></span>
<span id="cb44-99"><a href="#cb44-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-100"><a href="#cb44-100" aria-hidden="true" tabindex="-1"></a>Data has largely been pre-processed, and is loaded from rds files.</span>
<span id="cb44-101"><a href="#cb44-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-102"><a href="#cb44-102" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, data}</span></span>
<span id="cb44-103"><a href="#cb44-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-104"><a href="#cb44-104" aria-hidden="true" tabindex="-1"></a><span class="co">#here()</span></span>
<span id="cb44-105"><a href="#cb44-105" aria-hidden="true" tabindex="-1"></a>top_routes_prep_df <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="fu">here</span>(<span class="st">"./posts/aust_domestic_flights/artifacts/top_routes_prep_df.rds"</span>))</span>
<span id="cb44-106"><a href="#cb44-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-107"><a href="#cb44-107" aria-hidden="true" tabindex="-1"></a>start          <span class="ot">&lt;-</span> <span class="st">"2001-01-01"</span></span>
<span id="cb44-108"><a href="#cb44-108" aria-hidden="true" tabindex="-1"></a>end            <span class="ot">&lt;-</span> <span class="st">"2019-07-01"</span></span>
<span id="cb44-109"><a href="#cb44-109" aria-hidden="true" tabindex="-1"></a>horizon_nested <span class="ot">&lt;-</span> <span class="dv">12</span></span>
<span id="cb44-110"><a href="#cb44-110" aria-hidden="true" tabindex="-1"></a>end_precovid <span class="ot">&lt;-</span> <span class="fu">dmy</span>(<span class="st">"01-02-2020"</span>)</span>
<span id="cb44-111"><a href="#cb44-111" aria-hidden="true" tabindex="-1"></a><span class="co">#d2 &lt;- dmy("01-07-2022")</span></span>
<span id="cb44-112"><a href="#cb44-112" aria-hidden="true" tabindex="-1"></a>max_act   <span class="ot">&lt;-</span> <span class="fu">max</span>(top_routes_prep_df<span class="sc">$</span>date)</span>
<span id="cb44-113"><a href="#cb44-113" aria-hidden="true" tabindex="-1"></a>max_test  <span class="ot">&lt;-</span> <span class="fu">ymd</span>(end)</span>
<span id="cb44-114"><a href="#cb44-114" aria-hidden="true" tabindex="-1"></a>max_pred  <span class="ot">&lt;-</span> max_test <span class="sc">%m+%</span> <span class="fu">months</span>(horizon_nested)</span>
<span id="cb44-115"><a href="#cb44-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-116"><a href="#cb44-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-117"><a href="#cb44-117" aria-hidden="true" tabindex="-1"></a>filter_r       <span class="ot">&lt;-</span> <span class="st">"N"</span></span>
<span id="cb44-118"><a href="#cb44-118" aria-hidden="true" tabindex="-1"></a>city           <span class="ot">&lt;-</span> <span class="st">"BRISBANE"</span></span>
<span id="cb44-119"><a href="#cb44-119" aria-hidden="true" tabindex="-1"></a>top_x          <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb44-120"><a href="#cb44-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-121"><a href="#cb44-121" aria-hidden="true" tabindex="-1"></a><span class="co"># * Parallel Processing ----</span></span>
<span id="cb44-122"><a href="#cb44-122" aria-hidden="true" tabindex="-1"></a><span class="fu">registerDoFuture</span>()</span>
<span id="cb44-123"><a href="#cb44-123" aria-hidden="true" tabindex="-1"></a>n_cores <span class="ot">&lt;-</span> parallel<span class="sc">::</span><span class="fu">detectCores</span>()</span>
<span id="cb44-124"><a href="#cb44-124" aria-hidden="true" tabindex="-1"></a><span class="fu">plan</span>(</span>
<span id="cb44-125"><a href="#cb44-125" aria-hidden="true" tabindex="-1"></a>  <span class="at">strategy =</span> cluster,</span>
<span id="cb44-126"><a href="#cb44-126" aria-hidden="true" tabindex="-1"></a>  <span class="at">workers  =</span> parallel<span class="sc">::</span><span class="fu">makeCluster</span>(n_cores)</span>
<span id="cb44-127"><a href="#cb44-127" aria-hidden="true" tabindex="-1"></a>) </span>
<span id="cb44-128"><a href="#cb44-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-129"><a href="#cb44-129" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-130"><a href="#cb44-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-131"><a href="#cb44-131" aria-hidden="true" tabindex="-1"></a><span class="fu">## Wrangling</span></span>
<span id="cb44-132"><a href="#cb44-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-133"><a href="#cb44-133" aria-hidden="true" tabindex="-1"></a>Some initial wrangling</span>
<span id="cb44-134"><a href="#cb44-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-135"><a href="#cb44-135" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, wrangling}</span></span>
<span id="cb44-136"><a href="#cb44-136" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb44-137"><a href="#cb44-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-138"><a href="#cb44-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-139"><a href="#cb44-139" aria-hidden="true" tabindex="-1"></a>route_prep <span class="ot">&lt;-</span> top_routes_prep_df <span class="sc">%&gt;%</span></span>
<span id="cb44-140"><a href="#cb44-140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(route,date,passenger_trips) <span class="sc">%&gt;%</span></span>
<span id="cb44-141"><a href="#cb44-141" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(route) <span class="sc">%&gt;%</span></span>
<span id="cb44-142"><a href="#cb44-142" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_by_time</span>(date, <span class="at">.by =</span> <span class="st">"month"</span>, <span class="at">passenger_trips =</span> <span class="fu">sum</span>(passenger_trips)) <span class="sc">%&gt;%</span></span>
<span id="cb44-143"><a href="#cb44-143" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pad_by_time</span>(date, <span class="at">.by       =</span> <span class="st">"month"</span>,<span class="at">.pad_value =</span> <span class="dv">0</span>)</span>
<span id="cb44-144"><a href="#cb44-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-145"><a href="#cb44-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-146"><a href="#cb44-146" aria-hidden="true" tabindex="-1"></a>topx <span class="ot">&lt;-</span> top_routes_prep_df <span class="sc">%&gt;%</span> </span>
<span id="cb44-147"><a href="#cb44-147" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(route) <span class="sc">%&gt;%</span> </span>
<span id="cb44-148"><a href="#cb44-148" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">passenger_trips =</span> <span class="fu">sum</span>(passenger_trips)) <span class="sc">%&gt;%</span> </span>
<span id="cb44-149"><a href="#cb44-149" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb44-150"><a href="#cb44-150" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(passenger_trips, <span class="at">n=</span>top_x) <span class="sc">%&gt;%</span> </span>
<span id="cb44-151"><a href="#cb44-151" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(passenger_trips)) <span class="sc">%&gt;%</span> </span>
<span id="cb44-152"><a href="#cb44-152" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(route) <span class="sc">%&gt;%</span> </span>
<span id="cb44-153"><a href="#cb44-153" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb44-154"><a href="#cb44-154" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.character</span>()</span>
<span id="cb44-155"><a href="#cb44-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-156"><a href="#cb44-156" aria-hidden="true" tabindex="-1"></a>route_prep_raw <span class="ot">&lt;-</span> route_prep <span class="sc">%&gt;%</span></span>
<span id="cb44-157"><a href="#cb44-157" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(route <span class="sc">%in%</span> topx ) <span class="sc">%&gt;%</span> </span>
<span id="cb44-158"><a href="#cb44-158" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter_by_time</span>(<span class="at">.date_var    =</span> date,<span class="at">.start_date =</span> start, <span class="at">.end_date =</span> end ) <span class="sc">%&gt;%</span></span>
<span id="cb44-159"><a href="#cb44-159" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb44-160"><a href="#cb44-160" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">passenger_trips      =</span> <span class="fu">log1p</span>(passenger_trips)) <span class="sc">%&gt;%</span></span>
<span id="cb44-161"><a href="#cb44-161" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(route)</span>
<span id="cb44-162"><a href="#cb44-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-163"><a href="#cb44-163" aria-hidden="true" tabindex="-1"></a>route_prep_validation <span class="ot">&lt;-</span> route_prep <span class="sc">%&gt;%</span></span>
<span id="cb44-164"><a href="#cb44-164" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(route <span class="sc">%in%</span> topx ) <span class="sc">%&gt;%</span> </span>
<span id="cb44-165"><a href="#cb44-165" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(date <span class="sc">&gt;</span> max_test ) <span class="sc">%&gt;%</span></span>
<span id="cb44-166"><a href="#cb44-166" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb44-167"><a href="#cb44-167" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">passenger_trips      =</span> <span class="fu">log1p</span>(passenger_trips)) <span class="sc">%&gt;%</span></span>
<span id="cb44-168"><a href="#cb44-168" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(route)</span>
<span id="cb44-169"><a href="#cb44-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-170"><a href="#cb44-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-171"><a href="#cb44-171" aria-hidden="true" tabindex="-1"></a><span class="co"># * Nested Time Series ----</span></span>
<span id="cb44-172"><a href="#cb44-172" aria-hidden="true" tabindex="-1"></a>route_prep_nested <span class="ot">&lt;-</span> route_prep_raw <span class="sc">%&gt;%</span></span>
<span id="cb44-173"><a href="#cb44-173" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extend_timeseries</span>(</span>
<span id="cb44-174"><a href="#cb44-174" aria-hidden="true" tabindex="-1"></a>    <span class="at">.id_var        =</span> route,</span>
<span id="cb44-175"><a href="#cb44-175" aria-hidden="true" tabindex="-1"></a>    <span class="at">.date_var      =</span> date,</span>
<span id="cb44-176"><a href="#cb44-176" aria-hidden="true" tabindex="-1"></a>    <span class="at">.length_future =</span> horizon_nested</span>
<span id="cb44-177"><a href="#cb44-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-178"><a href="#cb44-178" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb44-179"><a href="#cb44-179" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tk_augment_fourier</span>(date,<span class="at">.periods =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">6</span>,<span class="dv">12</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb44-180"><a href="#cb44-180" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tk_augment_lags</span>(passenger_trips, <span class="at">.lags =</span> <span class="dv">12</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-181"><a href="#cb44-181" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tk_augment_slidify</span>(</span>
<span id="cb44-182"><a href="#cb44-182" aria-hidden="true" tabindex="-1"></a>    passenger_trips_lag12,</span>
<span id="cb44-183"><a href="#cb44-183" aria-hidden="true" tabindex="-1"></a>     <span class="at">.f       =</span> <span class="sc">~</span><span class="fu">mean</span>(.x,<span class="at">na.rm =</span> T),</span>
<span id="cb44-184"><a href="#cb44-184" aria-hidden="true" tabindex="-1"></a>     <span class="at">.period  =</span> <span class="fu">c</span>(.<span class="dv">25</span> <span class="sc">*</span> <span class="dv">12</span>,.<span class="dv">5</span> <span class="sc">*</span> <span class="dv">12</span>, <span class="dv">12</span>),</span>
<span id="cb44-185"><a href="#cb44-185" aria-hidden="true" tabindex="-1"></a>     <span class="at">.partial =</span> T,</span>
<span id="cb44-186"><a href="#cb44-186" aria-hidden="true" tabindex="-1"></a>     <span class="at">.align   =</span> <span class="st">"center"</span></span>
<span id="cb44-187"><a href="#cb44-187" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb44-188"><a href="#cb44-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-189"><a href="#cb44-189" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest_timeseries</span>(</span>
<span id="cb44-190"><a href="#cb44-190" aria-hidden="true" tabindex="-1"></a>    <span class="at">.id_var        =</span> route,</span>
<span id="cb44-191"><a href="#cb44-191" aria-hidden="true" tabindex="-1"></a>    <span class="at">.length_future =</span> horizon_nested</span>
<span id="cb44-192"><a href="#cb44-192" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb44-193"><a href="#cb44-193" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split_nested_timeseries</span>(</span>
<span id="cb44-194"><a href="#cb44-194" aria-hidden="true" tabindex="-1"></a>    <span class="at">.length_test   =</span> horizon_nested</span>
<span id="cb44-195"><a href="#cb44-195" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb44-196"><a href="#cb44-196" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb44-197"><a href="#cb44-197" aria-hidden="true" tabindex="-1"></a>  <span class="co">#rowid_to_column(var = "rowid")</span></span>
<span id="cb44-198"><a href="#cb44-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-199"><a href="#cb44-199" aria-hidden="true" tabindex="-1"></a>route_prep_nested_train <span class="ot">&lt;-</span> <span class="fu">extract_nested_train_split</span>(route_prep_nested)</span>
<span id="cb44-200"><a href="#cb44-200" aria-hidden="true" tabindex="-1"></a>route_prep_nested_test  <span class="ot">&lt;-</span> <span class="fu">extract_nested_test_split</span>(route_prep_nested)</span>
<span id="cb44-201"><a href="#cb44-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-202"><a href="#cb44-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-203"><a href="#cb44-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-204"><a href="#cb44-204" aria-hidden="true" tabindex="-1"></a>max_train <span class="ot">&lt;-</span> <span class="fu">max</span>(route_prep_nested_train<span class="sc">$</span>date)</span>
<span id="cb44-205"><a href="#cb44-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-206"><a href="#cb44-206" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-207"><a href="#cb44-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-208"><a href="#cb44-208" aria-hidden="true" tabindex="-1"></a>Top Routes, ordered in descending order (of passengers numbers over total review period) :</span>
<span id="cb44-209"><a href="#cb44-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-212"><a href="#cb44-212" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-213"><a href="#cb44-213" aria-hidden="true" tabindex="-1"></a>topx <span class="sc">%&gt;%</span> <span class="fu">kable</span>()</span>
<span id="cb44-214"><a href="#cb44-214" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-215"><a href="#cb44-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-216"><a href="#cb44-216" aria-hidden="true" tabindex="-1"></a><span class="fu">## Recipes</span></span>
<span id="cb44-217"><a href="#cb44-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-218"><a href="#cb44-218" aria-hidden="true" tabindex="-1"></a>3 Recipes have been established:</span>
<span id="cb44-219"><a href="#cb44-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-220"><a href="#cb44-220" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Base Recipe</span>
<span id="cb44-221"><a href="#cb44-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-222"><a href="#cb44-222" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Auto Arima Recipe</span>
<span id="cb44-223"><a href="#cb44-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-224"><a href="#cb44-224" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Tunable XG Boost Recipe - which is not run here as hyperparameter tuning results were hard-coded into recipe to save processing time here.</span>
<span id="cb44-225"><a href="#cb44-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-226"><a href="#cb44-226" aria-hidden="true" tabindex="-1"></a><span class="fu">### Recipe - Base</span></span>
<span id="cb44-227"><a href="#cb44-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-228"><a href="#cb44-228" aria-hidden="true" tabindex="-1"></a>Used in all</span>
<span id="cb44-229"><a href="#cb44-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-230"><a href="#cb44-230" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, recipe_base}</span></span>
<span id="cb44-231"><a href="#cb44-231" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb44-232"><a href="#cb44-232" aria-hidden="true" tabindex="-1"></a><span class="co">#| #message:false</span></span>
<span id="cb44-233"><a href="#cb44-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-234"><a href="#cb44-234" aria-hidden="true" tabindex="-1"></a><span class="co"># * Base Recipe ----</span></span>
<span id="cb44-235"><a href="#cb44-235" aria-hidden="true" tabindex="-1"></a>recipe_spec <span class="ot">&lt;-</span> <span class="fu">recipe</span>(</span>
<span id="cb44-236"><a href="#cb44-236" aria-hidden="true" tabindex="-1"></a>  passenger_trips <span class="sc">~</span> .,</span>
<span id="cb44-237"><a href="#cb44-237" aria-hidden="true" tabindex="-1"></a>  route_prep_nested_train) <span class="sc">%&gt;%</span></span>
<span id="cb44-238"><a href="#cb44-238" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_timeseries_signature</span>(date) <span class="sc">%&gt;%</span></span>
<span id="cb44-239"><a href="#cb44-239" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_rm</span>(<span class="fu">matches</span>(<span class="st">"(.xts$)|(.iso$)|(hour)|(minute)|(second)|(am.pm)|(day)|(week)"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb44-240"><a href="#cb44-240" aria-hidden="true" tabindex="-1"></a>  <span class="co">#step_rm(date) %&gt;%</span></span>
<span id="cb44-241"><a href="#cb44-241" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_normalize</span>(date_index.num,date_year) <span class="sc">%&gt;%</span></span>
<span id="cb44-242"><a href="#cb44-242" aria-hidden="true" tabindex="-1"></a>  <span class="co">#step_log(passenger_trips,offset = 1) %&gt;%</span></span>
<span id="cb44-243"><a href="#cb44-243" aria-hidden="true" tabindex="-1"></a>  <span class="co">#step_rm(date) %&gt;%</span></span>
<span id="cb44-244"><a href="#cb44-244" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_zv</span>(<span class="fu">all_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb44-245"><a href="#cb44-245" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_impute_knn</span>(<span class="fu">all_predictors</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb44-246"><a href="#cb44-246" aria-hidden="true" tabindex="-1"></a>  <span class="co">#step_other(route) %&gt;%</span></span>
<span id="cb44-247"><a href="#cb44-247" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_dummy</span>(<span class="fu">all_nominal_predictors</span>(), <span class="at">one_hot =</span> <span class="cn">TRUE</span>)</span>
<span id="cb44-248"><a href="#cb44-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-249"><a href="#cb44-249" aria-hidden="true" tabindex="-1"></a><span class="co">#recipe_spec %&gt;% prep() %&gt;% summary() %&gt;% kable()</span></span>
<span id="cb44-250"><a href="#cb44-250" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-251"><a href="#cb44-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-252"><a href="#cb44-252" aria-hidden="true" tabindex="-1"></a><span class="fu">### Auto ARIMA</span></span>
<span id="cb44-253"><a href="#cb44-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-254"><a href="#cb44-254" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, recipe_auto_arima}</span></span>
<span id="cb44-255"><a href="#cb44-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-256"><a href="#cb44-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-257"><a href="#cb44-257" aria-hidden="true" tabindex="-1"></a><span class="co"># * Auto Arima Recipe ----</span></span>
<span id="cb44-258"><a href="#cb44-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-259"><a href="#cb44-259" aria-hidden="true" tabindex="-1"></a>recipe_spec_auto_arima <span class="ot">&lt;-</span> <span class="fu">recipe</span>(</span>
<span id="cb44-260"><a href="#cb44-260" aria-hidden="true" tabindex="-1"></a>  passenger_trips <span class="sc">~</span> date, <span class="at">data =</span> route_prep_nested_train)</span>
<span id="cb44-261"><a href="#cb44-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-262"><a href="#cb44-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-263"><a href="#cb44-263" aria-hidden="true" tabindex="-1"></a>recipe_spec_auto_arima <span class="sc">%&gt;%</span> <span class="fu">prep</span>() <span class="sc">%&gt;%</span> <span class="fu">summary</span>() <span class="sc">%&gt;%</span> <span class="fu">kable</span>()</span>
<span id="cb44-264"><a href="#cb44-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-265"><a href="#cb44-265" aria-hidden="true" tabindex="-1"></a>  <span class="co"># + fourier_vec(date,period = 3)</span></span>
<span id="cb44-266"><a href="#cb44-266" aria-hidden="true" tabindex="-1"></a>  <span class="co"># + fourier_vec(date,period = 6)</span></span>
<span id="cb44-267"><a href="#cb44-267" aria-hidden="true" tabindex="-1"></a>  <span class="co"># + fourier_vec(date,period = 12)</span></span>
<span id="cb44-268"><a href="#cb44-268" aria-hidden="true" tabindex="-1"></a>  <span class="co"># + month(date,label = T) ,</span></span>
<span id="cb44-269"><a href="#cb44-269" aria-hidden="true" tabindex="-1"></a>  <span class="co"># data = route_prep_nested_train)</span></span>
<span id="cb44-270"><a href="#cb44-270" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-271"><a href="#cb44-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-272"><a href="#cb44-272" aria-hidden="true" tabindex="-1"></a><span class="fu">## Models and Workflows</span></span>
<span id="cb44-273"><a href="#cb44-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-274"><a href="#cb44-274" aria-hidden="true" tabindex="-1"></a><span class="fu">### Auto ARIMA</span></span>
<span id="cb44-275"><a href="#cb44-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-276"><a href="#cb44-276" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Model</span></span>
<span id="cb44-277"><a href="#cb44-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-278"><a href="#cb44-278" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, model_auto_arima}</span></span>
<span id="cb44-279"><a href="#cb44-279" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb44-280"><a href="#cb44-280" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb44-281"><a href="#cb44-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-282"><a href="#cb44-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-283"><a href="#cb44-283" aria-hidden="true" tabindex="-1"></a><span class="co"># ** Model----</span></span>
<span id="cb44-284"><a href="#cb44-284" aria-hidden="true" tabindex="-1"></a>model_spec_auto_arima <span class="ot">&lt;-</span> <span class="fu">arima_reg</span>() <span class="sc">%&gt;%</span></span>
<span id="cb44-285"><a href="#cb44-285" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"auto_arima"</span>)</span>
<span id="cb44-286"><a href="#cb44-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-287"><a href="#cb44-287" aria-hidden="true" tabindex="-1"></a>model_spec_auto_arima</span>
<span id="cb44-288"><a href="#cb44-288" aria-hidden="true" tabindex="-1"></a>recipe_spec_auto_arima <span class="sc">%&gt;%</span> <span class="fu">prep</span>() <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span>
<span id="cb44-289"><a href="#cb44-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-290"><a href="#cb44-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-291"><a href="#cb44-291" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-292"><a href="#cb44-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-293"><a href="#cb44-293" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Workflow</span></span>
<span id="cb44-294"><a href="#cb44-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-295"><a href="#cb44-295" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, wflw_auto_arima}</span></span>
<span id="cb44-296"><a href="#cb44-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-297"><a href="#cb44-297" aria-hidden="true" tabindex="-1"></a><span class="co"># ** Workflow ----</span></span>
<span id="cb44-298"><a href="#cb44-298" aria-hidden="true" tabindex="-1"></a>wflw_fit_auto_arima <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb44-299"><a href="#cb44-299" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(model_spec_auto_arima) <span class="sc">%&gt;%</span></span>
<span id="cb44-300"><a href="#cb44-300" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(recipe_spec_auto_arima)</span>
<span id="cb44-301"><a href="#cb44-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-302"><a href="#cb44-302" aria-hidden="true" tabindex="-1"></a>wflw_fit_auto_arima</span>
<span id="cb44-303"><a href="#cb44-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-304"><a href="#cb44-304" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-305"><a href="#cb44-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-306"><a href="#cb44-306" aria-hidden="true" tabindex="-1"></a><span class="fu">### XGBoost</span></span>
<span id="cb44-307"><a href="#cb44-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-308"><a href="#cb44-308" aria-hidden="true" tabindex="-1"></a>Parameters for this model were selected from a hyper-parameter tuning grid search, not shown here for brevity reasons. This, and related Prophet Boost models (using same parameters) are only models yet tuned.</span>
<span id="cb44-309"><a href="#cb44-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-310"><a href="#cb44-310" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Model</span></span>
<span id="cb44-311"><a href="#cb44-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-312"><a href="#cb44-312" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, model_xgboost}</span></span>
<span id="cb44-313"><a href="#cb44-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-314"><a href="#cb44-314" aria-hidden="true" tabindex="-1"></a><span class="co"># ** Model/Recipe ----</span></span>
<span id="cb44-315"><a href="#cb44-315" aria-hidden="true" tabindex="-1"></a>model_spec_xgboost <span class="ot">&lt;-</span> <span class="fu">boost_tree</span>(</span>
<span id="cb44-316"><a href="#cb44-316" aria-hidden="true" tabindex="-1"></a>  <span class="at">mode           =</span> <span class="st">"regression"</span>,</span>
<span id="cb44-317"><a href="#cb44-317" aria-hidden="true" tabindex="-1"></a>  <span class="co">#copied from tuned xgboost:</span></span>
<span id="cb44-318"><a href="#cb44-318" aria-hidden="true" tabindex="-1"></a>  <span class="at">mtry               =</span> <span class="dv">20</span>, </span>
<span id="cb44-319"><a href="#cb44-319" aria-hidden="true" tabindex="-1"></a>  <span class="at">min_n              =</span> <span class="dv">3</span>,</span>
<span id="cb44-320"><a href="#cb44-320" aria-hidden="true" tabindex="-1"></a>  <span class="at">tree_depth         =</span> <span class="dv">4</span>,</span>
<span id="cb44-321"><a href="#cb44-321" aria-hidden="true" tabindex="-1"></a>  <span class="at">learn_rate         =</span> <span class="fl">0.075</span>,</span>
<span id="cb44-322"><a href="#cb44-322" aria-hidden="true" tabindex="-1"></a>  <span class="at">loss_reduction     =</span> <span class="fl">0.000001</span>,</span>
<span id="cb44-323"><a href="#cb44-323" aria-hidden="true" tabindex="-1"></a>  <span class="at">trees              =</span> <span class="dv">300</span></span>
<span id="cb44-324"><a href="#cb44-324" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb44-325"><a href="#cb44-325" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"xgboost"</span>)</span>
<span id="cb44-326"><a href="#cb44-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-327"><a href="#cb44-327" aria-hidden="true" tabindex="-1"></a>model_spec_xgboost </span>
<span id="cb44-328"><a href="#cb44-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-329"><a href="#cb44-329" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-330"><a href="#cb44-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-331"><a href="#cb44-331" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Workflow</span></span>
<span id="cb44-332"><a href="#cb44-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-333"><a href="#cb44-333" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, wflw_xgboost}</span></span>
<span id="cb44-334"><a href="#cb44-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-335"><a href="#cb44-335" aria-hidden="true" tabindex="-1"></a><span class="co"># ** workflow  ----</span></span>
<span id="cb44-336"><a href="#cb44-336" aria-hidden="true" tabindex="-1"></a>wflw_fit_xgboost <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb44-337"><a href="#cb44-337" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(model_spec_xgboost) <span class="sc">%&gt;%</span></span>
<span id="cb44-338"><a href="#cb44-338" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(recipe_spec <span class="sc">%&gt;%</span> <span class="fu">update_role</span>(date,<span class="at">new_role=</span><span class="st">"indicator"</span>))</span>
<span id="cb44-339"><a href="#cb44-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-340"><a href="#cb44-340" aria-hidden="true" tabindex="-1"></a>wflw_fit_xgboost</span>
<span id="cb44-341"><a href="#cb44-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-342"><a href="#cb44-342" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-343"><a href="#cb44-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-344"><a href="#cb44-344" aria-hidden="true" tabindex="-1"></a><span class="fu">### Prophet Boost</span></span>
<span id="cb44-345"><a href="#cb44-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-346"><a href="#cb44-346" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Model</span></span>
<span id="cb44-347"><a href="#cb44-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-348"><a href="#cb44-348" aria-hidden="true" tabindex="-1"></a>As mentioned, hyper parameters have been hard coded from the results a grid-search, which is not repeated in this doc, just to save time. The code is included, although all commented out:</span>
<span id="cb44-349"><a href="#cb44-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-350"><a href="#cb44-350" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, tuning_not used}</span></span>
<span id="cb44-351"><a href="#cb44-351" aria-hidden="true" tabindex="-1"></a><span class="co"># * XGBoost-tuned (maybe) ----</span></span>
<span id="cb44-352"><a href="#cb44-352" aria-hidden="true" tabindex="-1"></a><span class="co"># ** Model/Recipe</span></span>
<span id="cb44-353"><a href="#cb44-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-354"><a href="#cb44-354" aria-hidden="true" tabindex="-1"></a><span class="co">#     model_spec_xgboost_tune &lt;- boost_tree(</span></span>
<span id="cb44-355"><a href="#cb44-355" aria-hidden="true" tabindex="-1"></a><span class="co">#       mode           = "regression",</span></span>
<span id="cb44-356"><a href="#cb44-356" aria-hidden="true" tabindex="-1"></a><span class="co">#       mtry           = tune(),</span></span>
<span id="cb44-357"><a href="#cb44-357" aria-hidden="true" tabindex="-1"></a><span class="co">#       trees          = 300,</span></span>
<span id="cb44-358"><a href="#cb44-358" aria-hidden="true" tabindex="-1"></a><span class="co">#       min_n          = tune(),</span></span>
<span id="cb44-359"><a href="#cb44-359" aria-hidden="true" tabindex="-1"></a><span class="co">#       tree_depth     = tune(),</span></span>
<span id="cb44-360"><a href="#cb44-360" aria-hidden="true" tabindex="-1"></a><span class="co">#       learn_rate     = tune(),</span></span>
<span id="cb44-361"><a href="#cb44-361" aria-hidden="true" tabindex="-1"></a><span class="co">#       loss_reduction = tune()</span></span>
<span id="cb44-362"><a href="#cb44-362" aria-hidden="true" tabindex="-1"></a><span class="co">#       ) %&gt;%</span></span>
<span id="cb44-363"><a href="#cb44-363" aria-hidden="true" tabindex="-1"></a><span class="co">#       set_engine("xgboost")</span></span>
<span id="cb44-364"><a href="#cb44-364" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb44-365"><a href="#cb44-365" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb44-366"><a href="#cb44-366" aria-hidden="true" tabindex="-1"></a><span class="co"># # ** ML Recipe - date as indicator ----</span></span>
<span id="cb44-367"><a href="#cb44-367" aria-hidden="true" tabindex="-1"></a><span class="co"># recipe_spec %&gt;% prep() %&gt;% summary()</span></span>
<span id="cb44-368"><a href="#cb44-368" aria-hidden="true" tabindex="-1"></a><span class="co"># recipe_spec_ml &lt;- recipe_spec %&gt;%</span></span>
<span id="cb44-369"><a href="#cb44-369" aria-hidden="true" tabindex="-1"></a><span class="co">#   update_role(date,new_role = "indicator")</span></span>
<span id="cb44-370"><a href="#cb44-370" aria-hidden="true" tabindex="-1"></a><span class="co"># recipe_spec_ml %&gt;% prep() %&gt;% summary()</span></span>
<span id="cb44-371"><a href="#cb44-371" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb44-372"><a href="#cb44-372" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb44-373"><a href="#cb44-373" aria-hidden="true" tabindex="-1"></a><span class="co"># # ** workflow for tuning ----</span></span>
<span id="cb44-374"><a href="#cb44-374" aria-hidden="true" tabindex="-1"></a><span class="co"># wflw_xgboost_tune &lt;- workflow() %&gt;%</span></span>
<span id="cb44-375"><a href="#cb44-375" aria-hidden="true" tabindex="-1"></a><span class="co">#   add_model(model_spec_xgboost_tune) %&gt;%</span></span>
<span id="cb44-376"><a href="#cb44-376" aria-hidden="true" tabindex="-1"></a><span class="co">#   add_recipe(recipe_spec_ml)</span></span>
<span id="cb44-377"><a href="#cb44-377" aria-hidden="true" tabindex="-1"></a>  <span class="co">#fit(route_prep_nested_train)</span></span>
<span id="cb44-378"><a href="#cb44-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-379"><a href="#cb44-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-380"><a href="#cb44-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-381"><a href="#cb44-381" aria-hidden="true" tabindex="-1"></a><span class="co"># ** resamples - K-Fold -----</span></span>
<span id="cb44-382"><a href="#cb44-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-383"><a href="#cb44-383" aria-hidden="true" tabindex="-1"></a><span class="co"># set.seed(123)</span></span>
<span id="cb44-384"><a href="#cb44-384" aria-hidden="true" tabindex="-1"></a><span class="co"># resamples_kfold &lt;- route_prep_nested_train %&gt;%</span></span>
<span id="cb44-385"><a href="#cb44-385" aria-hidden="true" tabindex="-1"></a><span class="co">#   vfold_cv()</span></span>
<span id="cb44-386"><a href="#cb44-386" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb44-387"><a href="#cb44-387" aria-hidden="true" tabindex="-1"></a><span class="co"># # unnests and graphs</span></span>
<span id="cb44-388"><a href="#cb44-388" aria-hidden="true" tabindex="-1"></a><span class="co"># resamples_data &lt;- resamples_kfold %&gt;%</span></span>
<span id="cb44-389"><a href="#cb44-389" aria-hidden="true" tabindex="-1"></a><span class="co">#   tk_time_series_cv_plan()</span></span>
<span id="cb44-390"><a href="#cb44-390" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb44-391"><a href="#cb44-391" aria-hidden="true" tabindex="-1"></a><span class="co"># resamples_data%&gt;%</span></span>
<span id="cb44-392"><a href="#cb44-392" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(.id) %&gt;%</span></span>
<span id="cb44-393"><a href="#cb44-393" aria-hidden="true" tabindex="-1"></a><span class="co">#   plot_time_series_cv_plan(</span></span>
<span id="cb44-394"><a href="#cb44-394" aria-hidden="true" tabindex="-1"></a><span class="co">#     date,</span></span>
<span id="cb44-395"><a href="#cb44-395" aria-hidden="true" tabindex="-1"></a><span class="co">#     passenger_trips,</span></span>
<span id="cb44-396"><a href="#cb44-396" aria-hidden="true" tabindex="-1"></a><span class="co">#     .facet_ncol  = 2,</span></span>
<span id="cb44-397"><a href="#cb44-397" aria-hidden="true" tabindex="-1"></a><span class="co">#     .facet_nrow  = 2)</span></span>
<span id="cb44-398"><a href="#cb44-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-399"><a href="#cb44-399" aria-hidden="true" tabindex="-1"></a><span class="co"># wflw_spec_xgboost_tune &lt;- workflow() %&gt;%</span></span>
<span id="cb44-400"><a href="#cb44-400" aria-hidden="true" tabindex="-1"></a><span class="co">#   add_model(model_spec_xgboost_tune) %&gt;%</span></span>
<span id="cb44-401"><a href="#cb44-401" aria-hidden="true" tabindex="-1"></a><span class="co">#   add_recipe(recipe_spec_ml)</span></span>
<span id="cb44-402"><a href="#cb44-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-403"><a href="#cb44-403" aria-hidden="true" tabindex="-1"></a><span class="co"># route_prep_nested_train %&gt;%</span></span>
<span id="cb44-404"><a href="#cb44-404" aria-hidden="true" tabindex="-1"></a><span class="co">#   plot_time_series(.date_var = date,.value = passenger_trips)</span></span>
<span id="cb44-405"><a href="#cb44-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-406"><a href="#cb44-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-407"><a href="#cb44-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-408"><a href="#cb44-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-409"><a href="#cb44-409" aria-hidden="true" tabindex="-1"></a><span class="co"># ** tune XGBoost----</span></span>
<span id="cb44-410"><a href="#cb44-410" aria-hidden="true" tabindex="-1"></a><span class="co"># tic()</span></span>
<span id="cb44-411"><a href="#cb44-411" aria-hidden="true" tabindex="-1"></a><span class="co"># set.seed(123)</span></span>
<span id="cb44-412"><a href="#cb44-412" aria-hidden="true" tabindex="-1"></a><span class="co"># tune_results_xgboost &lt;- wflw_xgboost_tune %&gt;%</span></span>
<span id="cb44-413"><a href="#cb44-413" aria-hidden="true" tabindex="-1"></a><span class="co">#   tune_grid(</span></span>
<span id="cb44-414"><a href="#cb44-414" aria-hidden="true" tabindex="-1"></a><span class="co">#     resamples  = resamples_kfold,</span></span>
<span id="cb44-415"><a href="#cb44-415" aria-hidden="true" tabindex="-1"></a><span class="co">#     param_info = hardhat::extract_parameter_set_dials(wflw_xgboost_tune) %&gt;%</span></span>
<span id="cb44-416"><a href="#cb44-416" aria-hidden="true" tabindex="-1"></a><span class="co">#       update(</span></span>
<span id="cb44-417"><a href="#cb44-417" aria-hidden="true" tabindex="-1"></a><span class="co">#         learn_rate = learn_rate(range = c(0.001,0.400), trans = NULL)</span></span>
<span id="cb44-418"><a href="#cb44-418" aria-hidden="true" tabindex="-1"></a><span class="co">#       ),</span></span>
<span id="cb44-419"><a href="#cb44-419" aria-hidden="true" tabindex="-1"></a><span class="co">#     grid = 10,</span></span>
<span id="cb44-420"><a href="#cb44-420" aria-hidden="true" tabindex="-1"></a><span class="co">#     control = control_grid(verbose = T, allow_par = T)</span></span>
<span id="cb44-421"><a href="#cb44-421" aria-hidden="true" tabindex="-1"></a><span class="co">#   )</span></span>
<span id="cb44-422"><a href="#cb44-422" aria-hidden="true" tabindex="-1"></a><span class="co"># toc()</span></span>
<span id="cb44-423"><a href="#cb44-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-424"><a href="#cb44-424" aria-hidden="true" tabindex="-1"></a><span class="co"># ** Results</span></span>
<span id="cb44-425"><a href="#cb44-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-426"><a href="#cb44-426" aria-hidden="true" tabindex="-1"></a><span class="co"># xgb_best_params &lt;- tune_results_xgboost %&gt;% show_best("rmse", n = Inf)</span></span>
<span id="cb44-427"><a href="#cb44-427" aria-hidden="true" tabindex="-1"></a><span class="co"># xgb_best_params</span></span>
<span id="cb44-428"><a href="#cb44-428" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb44-429"><a href="#cb44-429" aria-hidden="true" tabindex="-1"></a><span class="co"># wflw_fit_xgboost_tune &lt;-wflw_xgboost_tune %&gt;%</span></span>
<span id="cb44-430"><a href="#cb44-430" aria-hidden="true" tabindex="-1"></a><span class="co">#   finalize_workflow(parameters = xgb_best_params %&gt;% slice(1))</span></span>
<span id="cb44-431"><a href="#cb44-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-432"><a href="#cb44-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-433"><a href="#cb44-433" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-434"><a href="#cb44-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-435"><a href="#cb44-435" aria-hidden="true" tabindex="-1"></a>Model with hard coded hyper-parameters:</span>
<span id="cb44-436"><a href="#cb44-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-437"><a href="#cb44-437" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, model_prophet_boost}</span></span>
<span id="cb44-438"><a href="#cb44-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-439"><a href="#cb44-439" aria-hidden="true" tabindex="-1"></a>model_spec_prophet_boost <span class="ot">&lt;-</span> <span class="fu">prophet_boost</span>(</span>
<span id="cb44-440"><a href="#cb44-440" aria-hidden="true" tabindex="-1"></a>  <span class="at">seasonality_daily  =</span>  F,</span>
<span id="cb44-441"><a href="#cb44-441" aria-hidden="true" tabindex="-1"></a>  <span class="at">seasonality_weekly =</span> F,</span>
<span id="cb44-442"><a href="#cb44-442" aria-hidden="true" tabindex="-1"></a>  <span class="at">seasonality_yearly =</span> F,</span>
<span id="cb44-443"><a href="#cb44-443" aria-hidden="true" tabindex="-1"></a>  <span class="co">#copied from tuned xgboost:</span></span>
<span id="cb44-444"><a href="#cb44-444" aria-hidden="true" tabindex="-1"></a>  <span class="at">mtry               =</span> <span class="dv">20</span>, </span>
<span id="cb44-445"><a href="#cb44-445" aria-hidden="true" tabindex="-1"></a>  <span class="at">min_n              =</span> <span class="dv">3</span>,</span>
<span id="cb44-446"><a href="#cb44-446" aria-hidden="true" tabindex="-1"></a>  <span class="at">tree_depth         =</span> <span class="dv">4</span>,</span>
<span id="cb44-447"><a href="#cb44-447" aria-hidden="true" tabindex="-1"></a>  <span class="at">learn_rate         =</span> <span class="fl">0.075</span>,</span>
<span id="cb44-448"><a href="#cb44-448" aria-hidden="true" tabindex="-1"></a>  <span class="at">loss_reduction     =</span> <span class="fl">0.000001</span>,</span>
<span id="cb44-449"><a href="#cb44-449" aria-hidden="true" tabindex="-1"></a>  <span class="at">trees              =</span> <span class="dv">300</span></span>
<span id="cb44-450"><a href="#cb44-450" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb44-451"><a href="#cb44-451" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"prophet_xgboost"</span>)</span>
<span id="cb44-452"><a href="#cb44-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-453"><a href="#cb44-453" aria-hidden="true" tabindex="-1"></a>model_spec_prophet_boost</span>
<span id="cb44-454"><a href="#cb44-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-455"><a href="#cb44-455" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-456"><a href="#cb44-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-457"><a href="#cb44-457" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Workflow</span></span>
<span id="cb44-458"><a href="#cb44-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-459"><a href="#cb44-459" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, wflw_prophet_boost}</span></span>
<span id="cb44-460"><a href="#cb44-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-461"><a href="#cb44-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-462"><a href="#cb44-462" aria-hidden="true" tabindex="-1"></a>wflw_fit_prophet_boost <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb44-463"><a href="#cb44-463" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(model_spec_prophet_boost) <span class="sc">%&gt;%</span></span>
<span id="cb44-464"><a href="#cb44-464" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(recipe_spec)</span>
<span id="cb44-465"><a href="#cb44-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-466"><a href="#cb44-466" aria-hidden="true" tabindex="-1"></a>wflw_fit_prophet_boost</span>
<span id="cb44-467"><a href="#cb44-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-468"><a href="#cb44-468" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-469"><a href="#cb44-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-470"><a href="#cb44-470" aria-hidden="true" tabindex="-1"></a><span class="fu">### SVM</span></span>
<span id="cb44-471"><a href="#cb44-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-472"><a href="#cb44-472" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Workflow</span></span>
<span id="cb44-473"><a href="#cb44-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-474"><a href="#cb44-474" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, wflw_svm}</span></span>
<span id="cb44-475"><a href="#cb44-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-476"><a href="#cb44-476" aria-hidden="true" tabindex="-1"></a><span class="co"># * SVM ----</span></span>
<span id="cb44-477"><a href="#cb44-477" aria-hidden="true" tabindex="-1"></a>wflw_fit_svm <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb44-478"><a href="#cb44-478" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(</span>
<span id="cb44-479"><a href="#cb44-479" aria-hidden="true" tabindex="-1"></a>    <span class="at">spec =</span> <span class="fu">svm_rbf</span>(<span class="at">mode=</span><span class="st">"regression"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-480"><a href="#cb44-480" aria-hidden="true" tabindex="-1"></a>      <span class="fu">set_engine</span>(<span class="st">"kernlab"</span>)</span>
<span id="cb44-481"><a href="#cb44-481" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb44-482"><a href="#cb44-482" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(recipe_spec<span class="sc">%&gt;%</span> <span class="fu">update_role</span>(date,<span class="at">new_role=</span><span class="st">"indicator"</span>))</span>
<span id="cb44-483"><a href="#cb44-483" aria-hidden="true" tabindex="-1"></a>  <span class="co"># fit(route_prep_nested_train)</span></span>
<span id="cb44-484"><a href="#cb44-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-485"><a href="#cb44-485" aria-hidden="true" tabindex="-1"></a>wflw_fit_svm</span>
<span id="cb44-486"><a href="#cb44-486" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-487"><a href="#cb44-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-488"><a href="#cb44-488" aria-hidden="true" tabindex="-1"></a><span class="fu">### Random Forest</span></span>
<span id="cb44-489"><a href="#cb44-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-490"><a href="#cb44-490" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Workflow/Model</span></span>
<span id="cb44-491"><a href="#cb44-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-492"><a href="#cb44-492" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, wflw_rf}</span></span>
<span id="cb44-493"><a href="#cb44-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-494"><a href="#cb44-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-495"><a href="#cb44-495" aria-hidden="true" tabindex="-1"></a><span class="co"># * RANDOM FOREST ----</span></span>
<span id="cb44-496"><a href="#cb44-496" aria-hidden="true" tabindex="-1"></a>wflw_fit_rf <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb44-497"><a href="#cb44-497" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(</span>
<span id="cb44-498"><a href="#cb44-498" aria-hidden="true" tabindex="-1"></a>    <span class="at">spec =</span> <span class="fu">rand_forest</span>(<span class="at">mode=</span><span class="st">"regression"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-499"><a href="#cb44-499" aria-hidden="true" tabindex="-1"></a>      <span class="fu">set_engine</span>(<span class="st">"ranger"</span>)</span>
<span id="cb44-500"><a href="#cb44-500" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb44-501"><a href="#cb44-501" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(recipe_spec<span class="sc">%&gt;%</span> <span class="fu">update_role</span>(date, <span class="at">new_role=</span><span class="st">"indicator"</span>))</span>
<span id="cb44-502"><a href="#cb44-502" aria-hidden="true" tabindex="-1"></a>  <span class="co"># fit(route_prep_nested_train)</span></span>
<span id="cb44-503"><a href="#cb44-503" aria-hidden="true" tabindex="-1"></a>wflw_fit_rf</span>
<span id="cb44-504"><a href="#cb44-504" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-505"><a href="#cb44-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-506"><a href="#cb44-506" aria-hidden="true" tabindex="-1"></a><span class="fu">### Neural Net</span></span>
<span id="cb44-507"><a href="#cb44-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-508"><a href="#cb44-508" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Workflow/Model</span></span>
<span id="cb44-509"><a href="#cb44-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-510"><a href="#cb44-510" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, wflw_nnet}</span></span>
<span id="cb44-511"><a href="#cb44-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-512"><a href="#cb44-512" aria-hidden="true" tabindex="-1"></a><span class="co"># * NNET ----</span></span>
<span id="cb44-513"><a href="#cb44-513" aria-hidden="true" tabindex="-1"></a>wflw_fit_nnet <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb44-514"><a href="#cb44-514" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(</span>
<span id="cb44-515"><a href="#cb44-515" aria-hidden="true" tabindex="-1"></a>    <span class="at">spec =</span> <span class="fu">mlp</span>(<span class="at">mode=</span><span class="st">"regression"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-516"><a href="#cb44-516" aria-hidden="true" tabindex="-1"></a>      <span class="fu">set_engine</span>(<span class="st">"nnet"</span>)</span>
<span id="cb44-517"><a href="#cb44-517" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb44-518"><a href="#cb44-518" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(recipe_spec<span class="sc">%&gt;%</span> <span class="fu">update_role</span>(date, <span class="at">new_role=</span><span class="st">"indicator"</span>))</span>
<span id="cb44-519"><a href="#cb44-519" aria-hidden="true" tabindex="-1"></a>  <span class="co"># fit(route_prep_nested_train)</span></span>
<span id="cb44-520"><a href="#cb44-520" aria-hidden="true" tabindex="-1"></a>wflw_fit_nnet</span>
<span id="cb44-521"><a href="#cb44-521" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-522"><a href="#cb44-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-523"><a href="#cb44-523" aria-hidden="true" tabindex="-1"></a><span class="fu">### THIEF - Temporal Hierarchical Forecasting</span></span>
<span id="cb44-524"><a href="#cb44-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-525"><a href="#cb44-525" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Workflow/Model</span></span>
<span id="cb44-526"><a href="#cb44-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-529"><a href="#cb44-529" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-530"><a href="#cb44-530" aria-hidden="true" tabindex="-1"></a><span class="co"># * THIEF - Temporal Hierachical Forecasting ----</span></span>
<span id="cb44-531"><a href="#cb44-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-532"><a href="#cb44-532" aria-hidden="true" tabindex="-1"></a> wflw_thief <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb44-533"><a href="#cb44-533" aria-hidden="true" tabindex="-1"></a>   <span class="fu">add_model</span>(<span class="fu">temporal_hierarchy</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb44-534"><a href="#cb44-534" aria-hidden="true" tabindex="-1"></a>               <span class="fu">set_engine</span>(<span class="st">"thief"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb44-535"><a href="#cb44-535" aria-hidden="true" tabindex="-1"></a>   <span class="fu">add_recipe</span>(<span class="fu">recipe</span>(passenger_trips <span class="sc">~</span> .,route_prep_nested_train <span class="sc">%&gt;%</span> </span>
<span id="cb44-536"><a href="#cb44-536" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">select</span>(passenger_trips,date)</span>
<span id="cb44-537"><a href="#cb44-537" aria-hidden="true" tabindex="-1"></a>                     )</span>
<span id="cb44-538"><a href="#cb44-538" aria-hidden="true" tabindex="-1"></a>              )</span>
<span id="cb44-539"><a href="#cb44-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-540"><a href="#cb44-540" aria-hidden="true" tabindex="-1"></a> wflw_thief</span>
<span id="cb44-541"><a href="#cb44-541" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-542"><a href="#cb44-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-543"><a href="#cb44-543" aria-hidden="true" tabindex="-1"></a><span class="fu">## Nested Analysis</span></span>
<span id="cb44-544"><a href="#cb44-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-545"><a href="#cb44-545" aria-hidden="true" tabindex="-1"></a><span class="fu">### Combine Workflows in Modeltime Table</span></span>
<span id="cb44-546"><a href="#cb44-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-547"><a href="#cb44-547" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, nested_wflws}</span></span>
<span id="cb44-548"><a href="#cb44-548" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb44-549"><a href="#cb44-549" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb44-550"><a href="#cb44-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-551"><a href="#cb44-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-552"><a href="#cb44-552" aria-hidden="true" tabindex="-1"></a>nested_modeltime_tbl <span class="ot">&lt;-</span> route_prep_nested <span class="sc">%&gt;%</span></span>
<span id="cb44-553"><a href="#cb44-553" aria-hidden="true" tabindex="-1"></a>  <span class="fu">modeltime_nested_fit</span>(</span>
<span id="cb44-554"><a href="#cb44-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-555"><a href="#cb44-555" aria-hidden="true" tabindex="-1"></a>    <span class="at">model_list =</span> <span class="fu">list</span>(</span>
<span id="cb44-556"><a href="#cb44-556" aria-hidden="true" tabindex="-1"></a>      wflw_fit_auto_arima,</span>
<span id="cb44-557"><a href="#cb44-557" aria-hidden="true" tabindex="-1"></a>      wflw_fit_xgboost,</span>
<span id="cb44-558"><a href="#cb44-558" aria-hidden="true" tabindex="-1"></a>      wflw_fit_prophet_boost,</span>
<span id="cb44-559"><a href="#cb44-559" aria-hidden="true" tabindex="-1"></a>      wflw_fit_svm,</span>
<span id="cb44-560"><a href="#cb44-560" aria-hidden="true" tabindex="-1"></a>      wflw_fit_rf,</span>
<span id="cb44-561"><a href="#cb44-561" aria-hidden="true" tabindex="-1"></a>      wflw_fit_nnet,</span>
<span id="cb44-562"><a href="#cb44-562" aria-hidden="true" tabindex="-1"></a>      wflw_thief</span>
<span id="cb44-563"><a href="#cb44-563" aria-hidden="true" tabindex="-1"></a>      <span class="co"># #wflw_fit_gluonts_deepar - not working because of id cols</span></span>
<span id="cb44-564"><a href="#cb44-564" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb44-565"><a href="#cb44-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-566"><a href="#cb44-566" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">control_nested_fit</span>(</span>
<span id="cb44-567"><a href="#cb44-567" aria-hidden="true" tabindex="-1"></a>      <span class="at">verbose   =</span> <span class="cn">TRUE</span>,</span>
<span id="cb44-568"><a href="#cb44-568" aria-hidden="true" tabindex="-1"></a>      <span class="at">allow_par =</span> <span class="cn">TRUE</span></span>
<span id="cb44-569"><a href="#cb44-569" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb44-570"><a href="#cb44-570" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb44-571"><a href="#cb44-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-572"><a href="#cb44-572" aria-hidden="true" tabindex="-1"></a><span class="co">#nested_modeltime_tbl %&gt;% glimpse() %&gt;% kable()</span></span>
<span id="cb44-573"><a href="#cb44-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-574"><a href="#cb44-574" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-575"><a href="#cb44-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-576"><a href="#cb44-576" aria-hidden="true" tabindex="-1"></a><span class="fu">### Check Errors</span></span>
<span id="cb44-577"><a href="#cb44-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-578"><a href="#cb44-578" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, nested_errors}</span></span>
<span id="cb44-579"><a href="#cb44-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-580"><a href="#cb44-580" aria-hidden="true" tabindex="-1"></a><span class="co"># * Review Any Errors ----</span></span>
<span id="cb44-581"><a href="#cb44-581" aria-hidden="true" tabindex="-1"></a>nested_modeltime_tbl <span class="sc">%&gt;%</span> </span>
<span id="cb44-582"><a href="#cb44-582" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_nested_error_report</span>()</span>
<span id="cb44-583"><a href="#cb44-583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-584"><a href="#cb44-584" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-585"><a href="#cb44-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-586"><a href="#cb44-586" aria-hidden="true" tabindex="-1"></a><span class="fu">### Review Model Accuracy</span></span>
<span id="cb44-587"><a href="#cb44-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-588"><a href="#cb44-588" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, accuracy}</span></span>
<span id="cb44-589"><a href="#cb44-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-590"><a href="#cb44-590" aria-hidden="true" tabindex="-1"></a><span class="co"># * Review Test Accuracy ----</span></span>
<span id="cb44-591"><a href="#cb44-591" aria-hidden="true" tabindex="-1"></a>nested_modeltime_best <span class="ot">&lt;-</span> nested_modeltime_tbl <span class="sc">%&gt;%</span></span>
<span id="cb44-592"><a href="#cb44-592" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_nested_test_accuracy</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb44-593"><a href="#cb44-593" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.model_desc =</span> <span class="fu">str_replace_all</span>(.model_desc,<span class="st">"TEMPORAL HIERARCHICAL FORECASTING MODEL"</span>,<span class="st">"THIEF"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb44-594"><a href="#cb44-594" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.model_desc =</span> <span class="fu">str_replace_all</span>(.model_desc,<span class="st">"PROPHET W XGBOOST ERRORS"</span>,<span class="st">"PROPHET W XGBOOST"</span>)) </span>
<span id="cb44-595"><a href="#cb44-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-596"><a href="#cb44-596" aria-hidden="true" tabindex="-1"></a>nested_modeltime_best<span class="sc">%&gt;%</span></span>
<span id="cb44-597"><a href="#cb44-597" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-598"><a href="#cb44-598" aria-hidden="true" tabindex="-1"></a>  <span class="fu">table_modeltime_accuracy</span>(<span class="at">.round_digits =</span> <span class="dv">3</span>)</span>
<span id="cb44-599"><a href="#cb44-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-600"><a href="#cb44-600" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-601"><a href="#cb44-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-602"><a href="#cb44-602" aria-hidden="true" tabindex="-1"></a><span class="fu">### Graph - Models Test Data</span></span>
<span id="cb44-603"><a href="#cb44-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-604"><a href="#cb44-604" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, graph,fig.width=10,fig.height=15}</span></span>
<span id="cb44-605"><a href="#cb44-605" aria-hidden="true" tabindex="-1"></a><span class="co"># |fig: 500</span></span>
<span id="cb44-606"><a href="#cb44-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-607"><a href="#cb44-607" aria-hidden="true" tabindex="-1"></a><span class="co"># graph data</span></span>
<span id="cb44-608"><a href="#cb44-608" aria-hidden="true" tabindex="-1"></a>nested_modeltime_tbl_grph_data <span class="ot">&lt;-</span> nested_modeltime_tbl <span class="sc">%&gt;%</span></span>
<span id="cb44-609"><a href="#cb44-609" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_nested_test_forecast</span>() <span class="sc">%&gt;%</span></span>
<span id="cb44-610"><a href="#cb44-610" aria-hidden="true" tabindex="-1"></a>  <span class="co">#slice_head(n=10) %&gt;%</span></span>
<span id="cb44-611"><a href="#cb44-611" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(route, <span class="st">"-"</span>, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"origin"</span>, <span class="st">"dest"</span>), <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-612"><a href="#cb44-612" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.value =</span> <span class="fu">expm1</span>(.value)) <span class="sc">%&gt;%</span></span>
<span id="cb44-613"><a href="#cb44-613" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.model_desc =</span> <span class="fu">str_replace_all</span>(.model_desc,<span class="st">"TEMPORAL HIERARCHICAL FORECASTING MODEL"</span>,<span class="st">"THIEF"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb44-614"><a href="#cb44-614" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.model_desc =</span> <span class="fu">str_replace_all</span>(.model_desc,<span class="st">"PROPHET W XGBOOST ERRORS"</span>,<span class="st">"PROPHET W XGBOOST"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb44-615"><a href="#cb44-615" aria-hidden="true" tabindex="-1"></a>  <span class="co">#filter(origin == city) %&gt;%</span></span>
<span id="cb44-616"><a href="#cb44-616" aria-hidden="true" tabindex="-1"></a>  <span class="co">#filter(dest %in% c("MELBOURNE","SYDNEY","CAIRNS","HOBART")) %&gt;% </span></span>
<span id="cb44-617"><a href="#cb44-617" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(route,.model_desc)</span>
<span id="cb44-618"><a href="#cb44-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-619"><a href="#cb44-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-620"><a href="#cb44-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-621"><a href="#cb44-621" aria-hidden="true" tabindex="-1"></a><span class="co"># graph</span></span>
<span id="cb44-622"><a href="#cb44-622" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> nested_modeltime_tbl_grph_data <span class="sc">%&gt;%</span></span>
<span id="cb44-623"><a href="#cb44-623" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(route, <span class="at">model =</span> .model_desc, <span class="at">date =</span> .index,<span class="at">pax=</span>.value) <span class="sc">%&gt;%</span></span>
<span id="cb44-624"><a href="#cb44-624" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">year</span>(date)<span class="sc">&gt;</span><span class="dv">2014</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-625"><a href="#cb44-625" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>date,<span class="at">y =</span> pax<span class="sc">/</span><span class="dv">1000</span>, <span class="at">color =</span> model)) <span class="sc">+</span></span>
<span id="cb44-626"><a href="#cb44-626" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb44-627"><a href="#cb44-627" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> comma) <span class="sc">+</span></span>
<span id="cb44-628"><a href="#cb44-628" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"pax pm(000)"</span>) <span class="sc">+</span></span>
<span id="cb44-629"><a href="#cb44-629" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> route,  <span class="at">ncol=</span><span class="dv">2</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb44-630"><a href="#cb44-630" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb44-631"><a href="#cb44-631" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">5</span>))</span>
<span id="cb44-632"><a href="#cb44-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-633"><a href="#cb44-633" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(g)</span>
<span id="cb44-634"><a href="#cb44-634" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-635"><a href="#cb44-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-636"><a href="#cb44-636" aria-hidden="true" tabindex="-1"></a><span class="fu">### Select Best Models by Route</span></span>
<span id="cb44-637"><a href="#cb44-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-638"><a href="#cb44-638" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Summary Count by Model</span></span>
<span id="cb44-639"><a href="#cb44-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-640"><a href="#cb44-640" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, select_best}</span></span>
<span id="cb44-641"><a href="#cb44-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-642"><a href="#cb44-642" aria-hidden="true" tabindex="-1"></a>nested_best_tbl <span class="ot">&lt;-</span> nested_modeltime_tbl <span class="sc">%&gt;%</span></span>
<span id="cb44-643"><a href="#cb44-643" aria-hidden="true" tabindex="-1"></a>  <span class="fu">modeltime_nested_select_best</span>(<span class="at">metric =</span> <span class="st">"rmse"</span>)</span>
<span id="cb44-644"><a href="#cb44-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-645"><a href="#cb44-645" aria-hidden="true" tabindex="-1"></a><span class="co"># * Visualize Best Models ----</span></span>
<span id="cb44-646"><a href="#cb44-646" aria-hidden="true" tabindex="-1"></a>nested_best_tbl_extract <span class="ot">&lt;-</span> nested_best_tbl <span class="sc">%&gt;%</span></span>
<span id="cb44-647"><a href="#cb44-647" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_nested_test_forecast</span>() <span class="sc">%&gt;%</span></span>
<span id="cb44-648"><a href="#cb44-648" aria-hidden="true" tabindex="-1"></a>  <span class="co">#slice_head(n=10) %&gt;%</span></span>
<span id="cb44-649"><a href="#cb44-649" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(route, <span class="st">"-"</span>, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"origin"</span>, <span class="st">"dest"</span>), <span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-650"><a href="#cb44-650" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(route)</span>
<span id="cb44-651"><a href="#cb44-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-652"><a href="#cb44-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-653"><a href="#cb44-653" aria-hidden="true" tabindex="-1"></a>model_by_route <span class="ot">&lt;-</span> nested_best_tbl_extract <span class="sc">%&gt;%</span></span>
<span id="cb44-654"><a href="#cb44-654" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.model_desc =</span> <span class="fu">ifelse</span>(.model_id <span class="sc">==</span><span class="dv">2</span>,<span class="st">"XGBOOST-tuned"</span>,.model_desc)) <span class="sc">%&gt;%</span></span>
<span id="cb44-655"><a href="#cb44-655" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">.model_desc =</span> <span class="fu">str_replace_all</span>(.model_desc,<span class="st">"TEMPORAL HIERARCHICAL FORECASTING MODEL"</span>,<span class="st">"THIEF"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb44-656"><a href="#cb44-656" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.model_desc =</span> <span class="fu">str_replace_all</span>(.model_desc,<span class="st">"PROPHET W XGBOOST ERRORS"</span>,<span class="st">"PROPHET/XGBOOST"</span>))</span>
<span id="cb44-657"><a href="#cb44-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-658"><a href="#cb44-658" aria-hidden="true" tabindex="-1"></a>model_by_route_summ <span class="ot">&lt;-</span> model_by_route <span class="sc">%&gt;%</span> </span>
<span id="cb44-659"><a href="#cb44-659" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>.model_desc<span class="sc">==</span><span class="st">"ACTUAL"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-660"><a href="#cb44-660" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">model_desc =</span> <span class="fu">first</span>(.model_desc)) <span class="sc">%&gt;%</span></span>
<span id="cb44-661"><a href="#cb44-661" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb44-662"><a href="#cb44-662" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(model_desc,<span class="at">name =</span> <span class="st">"number"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb44-663"><a href="#cb44-663" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(number))</span>
<span id="cb44-664"><a href="#cb44-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-665"><a href="#cb44-665" aria-hidden="true" tabindex="-1"></a> model_by_route_summ <span class="sc">%&gt;%</span> <span class="fu">kable</span>()</span>
<span id="cb44-666"><a href="#cb44-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-667"><a href="#cb44-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-668"><a href="#cb44-668" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-669"><a href="#cb44-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-670"><a href="#cb44-670" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Best Model by Route</span></span>
<span id="cb44-671"><a href="#cb44-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-672"><a href="#cb44-672" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, best_by_route}</span></span>
<span id="cb44-673"><a href="#cb44-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-674"><a href="#cb44-674" aria-hidden="true" tabindex="-1"></a>best_by_route_summ <span class="ot">&lt;-</span> model_by_route <span class="sc">%&gt;%</span> </span>
<span id="cb44-675"><a href="#cb44-675" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>.model_desc<span class="sc">==</span><span class="st">"ACTUAL"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-676"><a href="#cb44-676" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">route =</span> <span class="fu">first</span>(route),<span class="at">model =</span> <span class="fu">first</span>(.model_desc)) </span>
<span id="cb44-677"><a href="#cb44-677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-678"><a href="#cb44-678" aria-hidden="true" tabindex="-1"></a> best_by_route_summ <span class="sc">%&gt;%</span> <span class="fu">kable</span>()</span>
<span id="cb44-679"><a href="#cb44-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-680"><a href="#cb44-680" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-681"><a href="#cb44-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-682"><a href="#cb44-682" aria-hidden="true" tabindex="-1"></a><span class="fu">### Graph - Forecast v Training Data Aggregated</span></span>
<span id="cb44-683"><a href="#cb44-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-684"><a href="#cb44-684" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, graph_training}</span></span>
<span id="cb44-685"><a href="#cb44-685" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb44-686"><a href="#cb44-686" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb44-687"><a href="#cb44-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-688"><a href="#cb44-688" aria-hidden="true" tabindex="-1"></a>nested_best_tbl_extract_graph <span class="ot">&lt;-</span> nested_best_tbl_extract <span class="sc">%&gt;%</span></span>
<span id="cb44-689"><a href="#cb44-689" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.key =</span> <span class="fu">ifelse</span>(.key <span class="sc">==</span><span class="st">"actual"</span>,<span class="st">"actual"</span>,<span class="st">"forecast"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb44-690"><a href="#cb44-690" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.value =</span> <span class="fu">expm1</span>(.value),</span>
<span id="cb44-691"><a href="#cb44-691" aria-hidden="true" tabindex="-1"></a>         <span class="at">.conf_lo =</span> <span class="fu">expm1</span>(.conf_lo),</span>
<span id="cb44-692"><a href="#cb44-692" aria-hidden="true" tabindex="-1"></a>         <span class="at">.conf_hi =</span> <span class="fu">expm1</span>(.conf_hi)</span>
<span id="cb44-693"><a href="#cb44-693" aria-hidden="true" tabindex="-1"></a>         ) <span class="sc">%&gt;%</span></span>
<span id="cb44-694"><a href="#cb44-694" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(.key,.index) <span class="sc">%&gt;%</span></span>
<span id="cb44-695"><a href="#cb44-695" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">.value =</span> <span class="fu">sum</span>(.value),</span>
<span id="cb44-696"><a href="#cb44-696" aria-hidden="true" tabindex="-1"></a>            <span class="at">conf_lo =</span> <span class="fu">sum</span>(.conf_lo,<span class="at">na.rm =</span> T),</span>
<span id="cb44-697"><a href="#cb44-697" aria-hidden="true" tabindex="-1"></a>            <span class="at">conf_hi =</span> <span class="fu">sum</span>(.conf_hi,<span class="at">na.rm =</span> T))<span class="sc">%&gt;%</span></span>
<span id="cb44-698"><a href="#cb44-698" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(.value<span class="sc">&gt;</span><span class="dv">200</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb44-699"><a href="#cb44-699" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(.index<span class="sc">&gt;</span><span class="fu">dmy</span>(<span class="st">"01-01-2015"</span>))</span>
<span id="cb44-700"><a href="#cb44-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-701"><a href="#cb44-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-702"><a href="#cb44-702" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> nested_best_tbl_extract_graph <span class="sc">%&gt;%</span></span>
<span id="cb44-703"><a href="#cb44-703" aria-hidden="true" tabindex="-1"></a>  <span class="co">#filter((origin == city) | (dest == city) ) %&gt;%</span></span>
<span id="cb44-704"><a href="#cb44-704" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(.index,.value<span class="sc">/</span><span class="dv">1000</span>,<span class="at">color =</span> .key)) <span class="sc">+</span></span>
<span id="cb44-705"><a href="#cb44-705" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb44-706"><a href="#cb44-706" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> (conf_lo)<span class="sc">/</span><span class="dv">1000</span>, <span class="at">ymax =</span> (conf_hi)<span class="sc">/</span><span class="dv">1000</span>,</span>
<span id="cb44-707"><a href="#cb44-707" aria-hidden="true" tabindex="-1"></a>                  <span class="at">color =</span> .key), <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb44-708"><a href="#cb44-708" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels=</span>scales<span class="sc">::</span>comma) <span class="sc">+</span></span>
<span id="cb44-709"><a href="#cb44-709" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Forecast v Training Data"</span>,<span class="at">x=</span><span class="st">""</span>, <span class="at">y=</span> <span class="st">"pax pm (000)"</span>)</span>
<span id="cb44-710"><a href="#cb44-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-711"><a href="#cb44-711" aria-hidden="true" tabindex="-1"></a>plotly<span class="sc">::</span><span class="fu">ggplotly</span>(g1)</span>
<span id="cb44-712"><a href="#cb44-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-713"><a href="#cb44-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-714"><a href="#cb44-714" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-715"><a href="#cb44-715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-716"><a href="#cb44-716" aria-hidden="true" tabindex="-1"></a><span class="fu">### Training Forecast Accuracy by Best Model - top 10 routes</span></span>
<span id="cb44-717"><a href="#cb44-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-718"><a href="#cb44-718" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, training_fcast_acc}</span></span>
<span id="cb44-719"><a href="#cb44-719" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb44-720"><a href="#cb44-720" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb44-721"><a href="#cb44-721" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb44-722"><a href="#cb44-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-723"><a href="#cb44-723" aria-hidden="true" tabindex="-1"></a>model_by_route_acc <span class="ot">&lt;-</span> model_by_route <span class="sc">%&gt;%</span> </span>
<span id="cb44-724"><a href="#cb44-724" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(.index <span class="sc">&gt;=</span><span class="fu">min</span>(route_prep_nested_test<span class="sc">$</span>date)) <span class="sc">%&gt;%</span> </span>
<span id="cb44-725"><a href="#cb44-725" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">.key =</span> <span class="fu">ifelse</span>(.key <span class="sc">==</span><span class="st">"actual"</span>,<span class="st">"actual"</span>,<span class="st">"forecast"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb44-726"><a href="#cb44-726" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">.value =</span> <span class="fu">expm1</span>(.value),</span>
<span id="cb44-727"><a href="#cb44-727" aria-hidden="true" tabindex="-1"></a>           <span class="at">date =</span> .index) <span class="sc">%&gt;%</span></span>
<span id="cb44-728"><a href="#cb44-728" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(route,.key,date) <span class="sc">%&gt;%</span></span>
<span id="cb44-729"><a href="#cb44-729" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">pax_nos =</span> <span class="fu">sum</span>(.value,<span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb44-730"><a href="#cb44-730" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> .key,</span>
<span id="cb44-731"><a href="#cb44-731" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from  =</span> pax_nos</span>
<span id="cb44-732"><a href="#cb44-732" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb44-733"><a href="#cb44-733" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb44-734"><a href="#cb44-734" aria-hidden="true" tabindex="-1"></a>model_by_route_acc <span class="sc">%&gt;%</span> </span>
<span id="cb44-735"><a href="#cb44-735" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize_accuracy_metrics</span>(</span>
<span id="cb44-736"><a href="#cb44-736" aria-hidden="true" tabindex="-1"></a>        <span class="at">truth =</span> actual,</span>
<span id="cb44-737"><a href="#cb44-737" aria-hidden="true" tabindex="-1"></a>        <span class="at">estimate =</span> forecast,</span>
<span id="cb44-738"><a href="#cb44-738" aria-hidden="true" tabindex="-1"></a>        <span class="at">metric_set =</span> <span class="fu">extended_forecast_accuracy_metric_set</span>()</span>
<span id="cb44-739"><a href="#cb44-739" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(smape)</span>
<span id="cb44-740"><a href="#cb44-740" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-741"><a href="#cb44-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-742"><a href="#cb44-742" aria-hidden="true" tabindex="-1"></a><span class="fu">### Refit Nested Model</span></span>
<span id="cb44-743"><a href="#cb44-743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-744"><a href="#cb44-744" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, refit}</span></span>
<span id="cb44-745"><a href="#cb44-745" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb44-746"><a href="#cb44-746" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb44-747"><a href="#cb44-747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-748"><a href="#cb44-748" aria-hidden="true" tabindex="-1"></a>nested_best_refit_tbl <span class="ot">&lt;-</span> nested_best_tbl <span class="sc">%&gt;%</span></span>
<span id="cb44-749"><a href="#cb44-749" aria-hidden="true" tabindex="-1"></a>  <span class="fu">modeltime_nested_refit</span>(</span>
<span id="cb44-750"><a href="#cb44-750" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">control_refit</span>(</span>
<span id="cb44-751"><a href="#cb44-751" aria-hidden="true" tabindex="-1"></a>      <span class="at">verbose   =</span> <span class="cn">TRUE</span>,</span>
<span id="cb44-752"><a href="#cb44-752" aria-hidden="true" tabindex="-1"></a>      <span class="at">allow_par =</span> <span class="cn">TRUE</span></span>
<span id="cb44-753"><a href="#cb44-753" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb44-754"><a href="#cb44-754" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb44-755"><a href="#cb44-755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-756"><a href="#cb44-756" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-757"><a href="#cb44-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-758"><a href="#cb44-758" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Graph</span></span>
<span id="cb44-759"><a href="#cb44-759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-760"><a href="#cb44-760" aria-hidden="true" tabindex="-1"></a><span class="in">```{r,graph_fcast,fig.width=10,fig.height=15}</span></span>
<span id="cb44-761"><a href="#cb44-761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-762"><a href="#cb44-762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-763"><a href="#cb44-763" aria-hidden="true" tabindex="-1"></a><span class="co"># * Visualize Future Forecast ----</span></span>
<span id="cb44-764"><a href="#cb44-764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-765"><a href="#cb44-765" aria-hidden="true" tabindex="-1"></a>nested_best_refit_tb_data <span class="ot">&lt;-</span> nested_best_refit_tbl <span class="sc">%&gt;%</span></span>
<span id="cb44-766"><a href="#cb44-766" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_nested_future_forecast</span>() <span class="sc">%&gt;%</span></span>
<span id="cb44-767"><a href="#cb44-767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-768"><a href="#cb44-768" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(route_prep_validation <span class="sc">%&gt;%</span></span>
<span id="cb44-769"><a href="#cb44-769" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">.key =</span> <span class="st">"actual_validn"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-770"><a href="#cb44-770" aria-hidden="true" tabindex="-1"></a>              <span class="fu">select</span>(route,<span class="at">.index =</span> date,.key,<span class="at">.value =</span> passenger_trips)) <span class="sc">%&gt;%</span></span>
<span id="cb44-771"><a href="#cb44-771" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(.value<span class="sc">:</span>.conf_hi, expm1)) <span class="sc">%&gt;%</span></span>
<span id="cb44-772"><a href="#cb44-772" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(route, <span class="st">"-"</span>, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"origin"</span>, <span class="st">"dest"</span>),<span class="at">remove =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-773"><a href="#cb44-773" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.model_desc =</span> <span class="fu">ifelse</span>(.model_id <span class="sc">==</span><span class="dv">2</span>,<span class="st">"XGBOOST-tuned"</span>,.model_desc),</span>
<span id="cb44-774"><a href="#cb44-774" aria-hidden="true" tabindex="-1"></a>         <span class="at">.model_desc =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(.model_id),.key,.model_desc)) <span class="sc">%&gt;%</span></span>
<span id="cb44-775"><a href="#cb44-775" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.model_desc =</span> <span class="fu">str_replace_all</span>(.model_desc,<span class="st">"TEMPORAL HIERARCHICAL FORECASTING MODEL"</span>,<span class="st">"THIEF"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb44-776"><a href="#cb44-776" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">.model_desc =</span> <span class="fu">str_replace_all</span>(.model_desc,<span class="st">"PROPHET W XGBOOST ERRORS"</span>,<span class="st">"PROPHET/XGBOOST"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb44-777"><a href="#cb44-777" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(origin == city) %&gt;%</span></span>
<span id="cb44-778"><a href="#cb44-778" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(dest %in% c("MELBOURNE","SYDNEY","CAIRNS","HOBART")) %&gt;%</span></span>
<span id="cb44-779"><a href="#cb44-779" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">year</span>(.index)<span class="sc">&gt;</span><span class="dv">2015</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-780"><a href="#cb44-780" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(route)</span>
<span id="cb44-781"><a href="#cb44-781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-782"><a href="#cb44-782" aria-hidden="true" tabindex="-1"></a><span class="co"># nested_best_refit_tb_data %&gt;%</span></span>
<span id="cb44-783"><a href="#cb44-783" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(.index &gt; end,.key =="actual_validn")</span></span>
<span id="cb44-784"><a href="#cb44-784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-785"><a href="#cb44-785" aria-hidden="true" tabindex="-1"></a>nested_best_refit_tb_data <span class="sc">%&gt;%</span></span>
<span id="cb44-786"><a href="#cb44-786" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span> .index, <span class="at">y=</span>.value, <span class="at">colour =</span> .model_desc))<span class="sc">+</span></span>
<span id="cb44-787"><a href="#cb44-787" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb44-788"><a href="#cb44-788" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> comma) <span class="sc">+</span></span>
<span id="cb44-789"><a href="#cb44-789" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"pax pm(000)"</span>) <span class="sc">+</span></span>
<span id="cb44-790"><a href="#cb44-790" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> route,  <span class="at">ncol=</span><span class="dv">2</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb44-791"><a href="#cb44-791" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb44-792"><a href="#cb44-792" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">5</span>))</span>
<span id="cb44-793"><a href="#cb44-793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-794"><a href="#cb44-794" aria-hidden="true" tabindex="-1"></a>  <span class="co">#filter((origin == city) | (dest == city) ) %&gt;%</span></span>
<span id="cb44-795"><a href="#cb44-795" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot_modeltime_forecast(</span></span>
<span id="cb44-796"><a href="#cb44-796" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   .trelliscope = FALSE,</span></span>
<span id="cb44-797"><a href="#cb44-797" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   .facet_ncol  = 1</span></span>
<span id="cb44-798"><a href="#cb44-798" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   </span></span>
<span id="cb44-799"><a href="#cb44-799" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   #.trelliscope_params = list(width ="100%")</span></span>
<span id="cb44-800"><a href="#cb44-800" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   )</span></span>
<span id="cb44-801"><a href="#cb44-801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-802"><a href="#cb44-802" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-803"><a href="#cb44-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-804"><a href="#cb44-804" aria-hidden="true" tabindex="-1"></a>Not a great performance against actuals, post covid in Feb 2020, but that is as expected! Pre-covid prediction looks good.</span>
<span id="cb44-805"><a href="#cb44-805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-806"><a href="#cb44-806" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Accuracy of refit - Pre/post covid</span></span>
<span id="cb44-807"><a href="#cb44-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-808"><a href="#cb44-808" aria-hidden="true" tabindex="-1"></a><span class="in">```{r,fig.width=10,fig.height=15}</span></span>
<span id="cb44-809"><a href="#cb44-809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-810"><a href="#cb44-810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-811"><a href="#cb44-811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-812"><a href="#cb44-812" aria-hidden="true" tabindex="-1"></a><span class="co">#unique(refit_model_by_route_acc_data$.key)</span></span>
<span id="cb44-813"><a href="#cb44-813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-814"><a href="#cb44-814" aria-hidden="true" tabindex="-1"></a>               </span>
<span id="cb44-815"><a href="#cb44-815" aria-hidden="true" tabindex="-1"></a>refit_model_by_route_acc_data <span class="ot">&lt;-</span> nested_best_refit_tb_data <span class="sc">%&gt;%</span> </span>
<span id="cb44-816"><a href="#cb44-816" aria-hidden="true" tabindex="-1"></a>    <span class="co"># filter(.index &gt;max(route_prep_nested_test$date),</span></span>
<span id="cb44-817"><a href="#cb44-817" aria-hidden="true" tabindex="-1"></a>    <span class="co">#        .index &lt;= d2</span></span>
<span id="cb44-818"><a href="#cb44-818" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ) %&gt;% </span></span>
<span id="cb44-819"><a href="#cb44-819" aria-hidden="true" tabindex="-1"></a>    <span class="co">#mutate(.key = ifelse(.key =="actual","actual","forecast")) %&gt;%</span></span>
<span id="cb44-820"><a href="#cb44-820" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">pax_nos =</span> .value,</span>
<span id="cb44-821"><a href="#cb44-821" aria-hidden="true" tabindex="-1"></a>           <span class="at">date =</span> .index) <span class="sc">%&gt;%</span></span>
<span id="cb44-822"><a href="#cb44-822" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>(route_prep_validation <span class="sc">%&gt;%</span></span>
<span id="cb44-823"><a href="#cb44-823" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">.key =</span> <span class="st">"actual"</span>,</span>
<span id="cb44-824"><a href="#cb44-824" aria-hidden="true" tabindex="-1"></a>                     <span class="at">passenger_trips =</span> <span class="fu">expm1</span>(passenger_trips)</span>
<span id="cb44-825"><a href="#cb44-825" aria-hidden="true" tabindex="-1"></a>                     ) <span class="sc">%&gt;%</span></span>
<span id="cb44-826"><a href="#cb44-826" aria-hidden="true" tabindex="-1"></a>              <span class="fu">select</span>(route,date,.key, <span class="at">pax_nos =</span> passenger_trips)) <span class="sc">%&gt;%</span> </span>
<span id="cb44-827"><a href="#cb44-827" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(route, .key, date) <span class="sc">%&gt;%</span></span>
<span id="cb44-828"><a href="#cb44-828" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">pax_nos =</span> <span class="fu">sum</span>(pax_nos,<span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb44-829"><a href="#cb44-829" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> .key,</span>
<span id="cb44-830"><a href="#cb44-830" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from  =</span> pax_nos</span>
<span id="cb44-831"><a href="#cb44-831" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb44-832"><a href="#cb44-832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-833"><a href="#cb44-833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-834"><a href="#cb44-834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-835"><a href="#cb44-835" aria-hidden="true" tabindex="-1"></a>accuracy_predn_precovid <span class="ot">&lt;-</span> refit_model_by_route_acc_data <span class="sc">%&gt;%</span> </span>
<span id="cb44-836"><a href="#cb44-836" aria-hidden="true" tabindex="-1"></a>   <span class="fu">filter</span>(date <span class="sc">&gt;</span>  max_test,</span>
<span id="cb44-837"><a href="#cb44-837" aria-hidden="true" tabindex="-1"></a>          date <span class="sc">&lt;=</span> end_precovid</span>
<span id="cb44-838"><a href="#cb44-838" aria-hidden="true" tabindex="-1"></a>   ) <span class="sc">%&gt;%</span></span>
<span id="cb44-839"><a href="#cb44-839" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize_accuracy_metrics</span>(</span>
<span id="cb44-840"><a href="#cb44-840" aria-hidden="true" tabindex="-1"></a>        <span class="at">truth =</span> actual_validn,</span>
<span id="cb44-841"><a href="#cb44-841" aria-hidden="true" tabindex="-1"></a>        <span class="at">estimate =</span> prediction,</span>
<span id="cb44-842"><a href="#cb44-842" aria-hidden="true" tabindex="-1"></a>        <span class="at">metric_set =</span> <span class="fu">extended_forecast_accuracy_metric_set</span>()</span>
<span id="cb44-843"><a href="#cb44-843" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(smape)</span>
<span id="cb44-844"><a href="#cb44-844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-845"><a href="#cb44-845" aria-hidden="true" tabindex="-1"></a>accuracy_predn_postcovid <span class="ot">&lt;-</span> refit_model_by_route_acc_data <span class="sc">%&gt;%</span> </span>
<span id="cb44-846"><a href="#cb44-846" aria-hidden="true" tabindex="-1"></a>   <span class="fu">filter</span>(date <span class="sc">&gt;</span>  end_precovid,</span>
<span id="cb44-847"><a href="#cb44-847" aria-hidden="true" tabindex="-1"></a>          date <span class="sc">&lt;=</span> max_act</span>
<span id="cb44-848"><a href="#cb44-848" aria-hidden="true" tabindex="-1"></a>   ) <span class="sc">%&gt;%</span></span>
<span id="cb44-849"><a href="#cb44-849" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize_accuracy_metrics</span>(</span>
<span id="cb44-850"><a href="#cb44-850" aria-hidden="true" tabindex="-1"></a>        <span class="at">truth =</span> actual_validn,</span>
<span id="cb44-851"><a href="#cb44-851" aria-hidden="true" tabindex="-1"></a>        <span class="at">estimate =</span> prediction,</span>
<span id="cb44-852"><a href="#cb44-852" aria-hidden="true" tabindex="-1"></a>        <span class="at">metric_set =</span> <span class="fu">extended_forecast_accuracy_metric_set</span>()</span>
<span id="cb44-853"><a href="#cb44-853" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(smape)</span>
<span id="cb44-854"><a href="#cb44-854" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-855"><a href="#cb44-855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-856"><a href="#cb44-856" aria-hidden="true" tabindex="-1"></a>For obvious reasons the accuracy of predictions against actuals is not great after the covid started (say Feb 2020), after all we did not even give the models the benefit of 'seeing' the covid crash. That was not the point of this analysis..although we may revisit as more post covid data is available.</span>
<span id="cb44-857"><a href="#cb44-857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-858"><a href="#cb44-858" aria-hidden="true" tabindex="-1"></a>We can also check accuracy at an aggregated (across all routes) level.</span>
<span id="cb44-859"><a href="#cb44-859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-860"><a href="#cb44-860" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, accuracy_aggr}</span></span>
<span id="cb44-861"><a href="#cb44-861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-862"><a href="#cb44-862" aria-hidden="true" tabindex="-1"></a>refit_model_aggr_acc_data <span class="ot">&lt;-</span> refit_model_by_route_acc_data <span class="sc">%&gt;%</span> </span>
<span id="cb44-863"><a href="#cb44-863" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(date) <span class="sc">%&gt;%</span> </span>
<span id="cb44-864"><a href="#cb44-864" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">actual   =</span> <span class="fu">sum</span>(actual,<span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb44-865"><a href="#cb44-865" aria-hidden="true" tabindex="-1"></a>            <span class="at">prediction =</span> <span class="fu">sum</span>(prediction,<span class="at">na.rm =</span> <span class="cn">TRUE</span>)) </span>
<span id="cb44-866"><a href="#cb44-866" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-867"><a href="#cb44-867" aria-hidden="true" tabindex="-1"></a>accuracy_predn_agg_precovid <span class="ot">&lt;-</span> refit_model_aggr_acc_data <span class="sc">%&gt;%</span> </span>
<span id="cb44-868"><a href="#cb44-868" aria-hidden="true" tabindex="-1"></a>   <span class="fu">filter</span>(date <span class="sc">&gt;</span>  max_test,</span>
<span id="cb44-869"><a href="#cb44-869" aria-hidden="true" tabindex="-1"></a>          date <span class="sc">&lt;=</span> end_precovid</span>
<span id="cb44-870"><a href="#cb44-870" aria-hidden="true" tabindex="-1"></a>   ) <span class="sc">%&gt;%</span></span>
<span id="cb44-871"><a href="#cb44-871" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize_accuracy_metrics</span>(</span>
<span id="cb44-872"><a href="#cb44-872" aria-hidden="true" tabindex="-1"></a>        <span class="at">truth      =</span> actual,</span>
<span id="cb44-873"><a href="#cb44-873" aria-hidden="true" tabindex="-1"></a>        <span class="at">estimate   =</span> prediction,</span>
<span id="cb44-874"><a href="#cb44-874" aria-hidden="true" tabindex="-1"></a>        <span class="at">metric_set =</span> <span class="fu">extended_forecast_accuracy_metric_set</span>()</span>
<span id="cb44-875"><a href="#cb44-875" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(smape)</span>
<span id="cb44-876"><a href="#cb44-876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-877"><a href="#cb44-877" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-878"><a href="#cb44-878" aria-hidden="true" tabindex="-1"></a>  accuracy_predn_agg_postcovid <span class="ot">&lt;-</span> refit_model_aggr_acc_data <span class="sc">%&gt;%</span> </span>
<span id="cb44-879"><a href="#cb44-879" aria-hidden="true" tabindex="-1"></a>   <span class="fu">filter</span>(date <span class="sc">&gt;</span>  end_precovid,</span>
<span id="cb44-880"><a href="#cb44-880" aria-hidden="true" tabindex="-1"></a>          date <span class="sc">&lt;=</span> max_act</span>
<span id="cb44-881"><a href="#cb44-881" aria-hidden="true" tabindex="-1"></a>   ) <span class="sc">%&gt;%</span></span>
<span id="cb44-882"><a href="#cb44-882" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize_accuracy_metrics</span>(</span>
<span id="cb44-883"><a href="#cb44-883" aria-hidden="true" tabindex="-1"></a>        <span class="at">truth      =</span> actual,</span>
<span id="cb44-884"><a href="#cb44-884" aria-hidden="true" tabindex="-1"></a>        <span class="at">estimate   =</span> prediction,</span>
<span id="cb44-885"><a href="#cb44-885" aria-hidden="true" tabindex="-1"></a>        <span class="at">metric_set =</span> <span class="fu">extended_forecast_accuracy_metric_set</span>()</span>
<span id="cb44-886"><a href="#cb44-886" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(smape)</span>
<span id="cb44-887"><a href="#cb44-887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-888"><a href="#cb44-888" aria-hidden="true" tabindex="-1"></a>agg_pred_accuracy <span class="ot">&lt;-</span> accuracy_predn_agg_precovid <span class="sc">%&gt;%</span> </span>
<span id="cb44-889"><a href="#cb44-889" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">period =</span> <span class="st">"pre_covid"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb44-890"><a href="#cb44-890" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(accuracy_predn_agg_postcovid <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">period =</span> <span class="st">"post_covid"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb44-891"><a href="#cb44-891" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(period,<span class="fu">everything</span>())</span>
<span id="cb44-892"><a href="#cb44-892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-893"><a href="#cb44-893" aria-hidden="true" tabindex="-1"></a>agg_pred_accuracy <span class="sc">%&gt;%</span> </span>
<span id="cb44-894"><a href="#cb44-894" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">gt</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb44-895"><a href="#cb44-895" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">fmt_number</span>(</span>
<span id="cb44-896"><a href="#cb44-896" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="sc">!</span>period,</span>
<span id="cb44-897"><a href="#cb44-897" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">3</span></span>
<span id="cb44-898"><a href="#cb44-898" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb44-899"><a href="#cb44-899" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-900"><a href="#cb44-900" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-901"><a href="#cb44-901" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-902"><a href="#cb44-902" aria-hidden="true" tabindex="-1"></a>Obviously the pre and post covid volumes are much different so a lot of measures are not appropriate, but all look reasonable pre-covid and horrible thereafter, as expected.</span>
<span id="cb44-903"><a href="#cb44-903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-904"><a href="#cb44-904" aria-hidden="true" tabindex="-1"></a>The following graph breaks the actuals into the various periods - training, testing, pre-covid prediction, post covid (Feb2020) prediction, and more recently when no prediction was attempted, so data is just for information.</span>
<span id="cb44-905"><a href="#cb44-905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-906"><a href="#cb44-906" aria-hidden="true" tabindex="-1"></a>So the pre-covid prediction looks good, which is really all we were asking of the models.</span>
<span id="cb44-907"><a href="#cb44-907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-908"><a href="#cb44-908" aria-hidden="true" tabindex="-1"></a>Now lets graph the aggregated (all routes) prediction against actuals. Actuals are colour coded to show all modelling stages. For our purposes the key is the comparison of the "prediction" to the "actual_precovid_prediction", ie the actuals after the test period but before covid kicks in (ie pink v green line), which looks pretty good. </span>
<span id="cb44-909"><a href="#cb44-909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-910"><a href="#cb44-910" aria-hidden="true" tabindex="-1"></a>The rest just highlights why forecast/predictions can only go so far...</span>
<span id="cb44-911"><a href="#cb44-911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-912"><a href="#cb44-912" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, graph_agg_pred}</span></span>
<span id="cb44-913"><a href="#cb44-913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-914"><a href="#cb44-914" aria-hidden="true" tabindex="-1"></a>refit_model_aggr_acc_data <span class="sc">%&gt;%</span></span>
<span id="cb44-915"><a href="#cb44-915" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb44-916"><a href="#cb44-916" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols      =</span> <span class="sc">!</span>date,</span>
<span id="cb44-917"><a href="#cb44-917" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to  =</span> <span class="st">"actual_prediction"</span>,</span>
<span id="cb44-918"><a href="#cb44-918" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"pax_nos"</span></span>
<span id="cb44-919"><a href="#cb44-919" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span>  </span>
<span id="cb44-920"><a href="#cb44-920" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">actual_prediction =</span> </span>
<span id="cb44-921"><a href="#cb44-921" aria-hidden="true" tabindex="-1"></a>    <span class="fu">case_when</span>(</span>
<span id="cb44-922"><a href="#cb44-922" aria-hidden="true" tabindex="-1"></a>      actual_prediction <span class="sc">==</span> <span class="st">"prediction"</span> <span class="sc">~</span> <span class="st">"prediction"</span>,</span>
<span id="cb44-923"><a href="#cb44-923" aria-hidden="true" tabindex="-1"></a>      date              <span class="sc">&lt;=</span> max_train    <span class="sc">~</span> <span class="st">"actual_train"</span>,</span>
<span id="cb44-924"><a href="#cb44-924" aria-hidden="true" tabindex="-1"></a>      date              <span class="sc">&lt;=</span> max_test     <span class="sc">~</span> <span class="st">"actual_test"</span>,</span>
<span id="cb44-925"><a href="#cb44-925" aria-hidden="true" tabindex="-1"></a>      date              <span class="sc">&lt;=</span> end_precovid <span class="sc">~</span> <span class="st">"actual_precovid"</span>,</span>
<span id="cb44-926"><a href="#cb44-926" aria-hidden="true" tabindex="-1"></a>      date              <span class="sc">&lt;=</span> max_pred     <span class="sc">~</span> <span class="st">"actual_postcovid"</span>,</span>
<span id="cb44-927"><a href="#cb44-927" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span>                              <span class="sc">~</span> <span class="st">"actual_post_prediction"</span></span>
<span id="cb44-928"><a href="#cb44-928" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb44-929"><a href="#cb44-929" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb44-930"><a href="#cb44-930" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pax_nos =</span> <span class="fu">ifelse</span>(pax_nos <span class="sc">==</span> <span class="dv">0</span>, <span class="cn">NA</span>,pax_nos)) <span class="sc">%&gt;%</span> </span>
<span id="cb44-931"><a href="#cb44-931" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>date, <span class="at">y=</span>pax_nos<span class="sc">/</span><span class="dv">1000</span>,<span class="at">colour =</span> actual_prediction ))<span class="sc">+</span></span>
<span id="cb44-932"><a href="#cb44-932" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb44-933"><a href="#cb44-933" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">"Passenger No's pm (000)"</span>,</span>
<span id="cb44-934"><a href="#cb44-934" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> scales<span class="sc">::</span><span class="fu">breaks_extended</span>(<span class="dv">8</span>),</span>
<span id="cb44-935"><a href="#cb44-935" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_comma</span>()  </span>
<span id="cb44-936"><a href="#cb44-936" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb44-937"><a href="#cb44-937" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-938"><a href="#cb44-938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-939"><a href="#cb44-939" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-940"><a href="#cb44-940" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>